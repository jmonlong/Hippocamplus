<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Converting scientific reviews to EPUB &middot; Hippocamplus
    
  </title>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-113785126-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    
    gtag('config', "UA-113785126-1");
  </script>
  
  
  <link rel="stylesheet" href="../../../../css/poole.css">
  <link rel="stylesheet" href="../../../../css/syntax.css">
  <link rel="stylesheet" href="../../../../css/lanyon.css">
  <link rel="stylesheet" href="../../../../css/idea.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="../../../../fa/css/font-awesome.min.css">
  
  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../assets/hippoPlus-icon.png">
  <link rel="shortcut icon" href="../../../../assets/hippoPlus-icon.png">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../atom.xml">
</head>

  
  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place to gather useful information I keep on forgetting.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="../../../../">Home</a>
    <a class="sidebar-nav-item " href="../../../../post">Posts</a>

    
    
      
        <a class="sidebar-nav-item " href="../../../../cpp/">CPP</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../emacs/">Emacs</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../expression/">Expression</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../latex/">LaTeX</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../markdown/">Markdown</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../math/stats/">Math/Stats</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../org-mode/">Org mode</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../python/">Python</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../r/">R</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../shell/">Shell</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../tools/">Tools</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../os/internet/">OS/Internet</a>
      
    
      
        <a class="sidebar-nav-item " href="../../../../about/">About</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
    
  </nav>

  <div class="sidebar-item">
  </div>
  
  <div class="sidebar-item">
    <div><a href="../../../../index.xml"><i class="fa fa-rss-square" aria-hidden="true"></i> RSS</a></div>
    <div><a href="https://twitter.com/JMonlong"><i class="fa fa-twitter" aria-hidden="true"></i> @JMonlong</a></div>
    <p>&copy; 2020 Jean Monlong. All rights reserved.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="../../../../" title="Home">Hippocamplus</a>
            <small>My Second Memory</small>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Converting scientific reviews to EPUB</h1>
  <span class="post-date">May 7 2018
  
  
  
  
  
  <a href='../../../../tags/pub/' class='label'>pub</a>
  
  <a href='../../../../tags/thesis/' class='label'>thesis</a>
  
  
  
  </span>
  

<div id="TOC">
<ul>
<li><a href="#first-check-on-pubmed-central">First, check on PubMed Central</a></li>
<li><a href="#convert-the-html-page-to-epub">Convert the HTML page to EPUB</a></li>
<li><a href="#clean-up-the-html-before-conversion">Clean up the HTML before conversion</a><ul>
<li><a href="#compiling-several-reviews-into-one-epub-document">Compiling several reviews into one EPUB document</a></li>
<li><a href="#vpn-paywall-and-pandoc">VPN, paywall and Pandoc</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#methods">Methods</a></li>
</ul></li>
<li><a href="#other-epub-resources">Other EPUB resources</a></li>
<li><a href="#loose-ends-by-sidney-brenner">Loose Ends by Sidney Brenner</a></li>
</ul>
</div>

<p><em>Edit Apr 6 2019: Added the compilation of Loose Ends columns by Sidney Brenner.</em></p>
<p>Third post on the series of <em>“Things I did instead of writing my thesis to help me write my thesis”</em>: how to find/convert reviews in the EPUB format to read in an ebook reader.</p>
<p>To motivate myself to write the thesis introduction and get some “style” inspiration, I read a few reviews. Reviews are longer and often more wordy than original research articles so I’d sometimes prefer to use my e-reader. It’s more compact and the e-ink is more comfortable to read, especially outside. But I find PDFs a bit awkward to use on an e-reader so it would be better to have the reviews in a e-reader format like EPUB.</p>
<p>In my experience, this is the best strategy to get a review in EPUB format:</p>
<ol style="list-style-type: decimal">
<li>Check if available on PubMed Central.</li>
<li>If not, download HTML page and convert with Pandoc.
<ul>
<li>If <em>Nature Reviews</em> or <em>Annual Reviews</em>, clean up the HTML file before conversion.</li>
</ul></li>
</ol>
<p>For <em>Nature Reviews</em> and <em>Annual Reviews</em>, the script I wrote can also merge several reviews into one EPUB ebook.</p>
<div id="first-check-on-pubmed-central" class="section level2">
<h2>First, check on PubMed Central</h2>
<p>In the top-right corner of the article page there is a <em>ePub</em> option (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3612533/">example</a>). This feature has been in <em>beta</em> version for years but the EPUB files are really good.</p>
<p>Unfortunately, many articles/reviews are not available through PMC, including the majority of reviews from dedicated journals like <a href="https://www.nature.com/nrg/">Nature Reviews Genetics</a> and <a href="https://www.annualreviews.org/journal/genet">Annual Review of Genetics</a>. For example, there are more than a thousand reviews from Nature Reviews Genetics on PubMed, but only <a href="https://www.ncbi.nlm.nih.gov/pmc/?term=%22nat+rev+genet%22%5BJournal%5D">200-300 available on PubMed Central</a>. Same for Annual Review of Genetics which has <a href="https://www.ncbi.nlm.nih.gov/pmc/?term=%22annual+review+of+genetics%22%5BJournal%5D">~70 reviews available on PMC</a> but almost 1K indexed on PubMed.</p>
<p>If it’s not available in PMC (and the journal doesn’t provide an EPUB file), no choice but to manually convert to EPUB.</p>
</div>
<div id="convert-the-html-page-to-epub" class="section level2">
<h2>Convert the HTML page to EPUB</h2>
<p>Rather than trying to convert the PDF, I found it easier to convert the HTML page. EPUB is a XML-based format which is quite close to the HTML anyway so it should be the way to go.</p>
<p>After saving the webpage locally, the HTML file can be converted with <a href="http://pandoc.org/index.html">Pandoc</a>:</p>
<pre class="sh"><code>pandoc webpage-i-manually-downloaded.html -o webpage-i-manually-downloaded.epub</code></pre>
<p>Usually, the result is <strong>readable but not very practical</strong> because the interface of the website is polluting the ebook, many links are external (pointing at webpages), and content is sometimes missing. It’s annoying not being able to click on the reference/figure links (or clicking inadvertently and opening a web browser), having to skip dozens of pages to get to the content, or missing information because they needed to be “expanded” on the website.</p>
<p>There are exceptions. For example the <strong>“<em>Opportunities and obstacles for deep learning in biology and medicine</em>”</strong>, a cool (and long) review which was published in <a href="http://rsif.royalsocietypublishing.org/content/15/141/20170387">the Journal of the Royal Society Interface</a>, is also formatted in <a href="https://greenelab.github.io/deep-review/">a GitHub HTML page</a>. The manuscript is actually written and build using Markdown/GitHub (I want to learn how to do that at some point). Anyway, the GitHub webpage was straightforward to convert with Pandoc and produced a perfect EPUB version of the review.</p>
<pre class="sh"><code>wget -p https://greenelab.github.io/deep-review/
cd greenelab.github.io/deep-review
pandoc index.html -o DeepLearningBioMed.epub</code></pre>
</div>
<div id="clean-up-the-html-before-conversion" class="section level2">
<h2>Clean up the HTML before conversion</h2>
<p><strong>For Nature Reviews and Annual Reviews</strong>, I wrote a small R script that downloads a HTML page and:</p>
<ol style="list-style-type: decimal">
<li>Keeps only the article content (remove the rest of the webpage).</li>
<li>Fixes the table of content.</li>
<li>Fixes links to reference/figure/glossary in the text.</li>
<li>Makes the figures not clickable.</li>
<li>Removes external links around references and images.</li>
<li>Simplify complex tables to allow for EPUB display.</li>
<li>Shows the content of a <em>box</em> even if hidden in the webpage.</li>
<li>Replaces low-resolution figure with high-resolution (for Annual Reviews).</li>
</ol>
<p>I put the <a href="https://github.com/jmonlong/Hippocamplus/tree/config/R/epubifyReviews">two R scripts on GitHub</a>. Using the URL of the review, run this to clean up the HTML and call Pandoc:</p>
<pre class="sh"><code>Rscript epubify-annualreviews.R -i https://www.annualreviews.org/doi/full/10.1146/annurev-genet-120215-034854
## or
Rscript epubify-naturereviews.R -i https://www.nature.com/articles/nrg.2015.16</code></pre>
<p><em>The scripts rely on the <a href="https://github.com/hadley/rvest">rvest package</a> (<code>install.packages('rvest')</code> to install in <code>R</code>) and the <a href="https://yihui.name/knitr/">knitr package</a> (<code>install.packages('knitr')</code> to install in <code>R</code>).</em> <em>It also assumes that <code>pandoc</code> is installed.</em></p>
<div id="compiling-several-reviews-into-one-epub-document" class="section level3">
<h3>Compiling several reviews into one EPUB document</h3>
<p>Some reviews or articles are part of collections, like the “Points of significance” serie in Nature Methods. It would be nice to convert these articles into one EPUB.</p>
<p>To do this both scripts can loop over URLs in a list and produce one EPUB. The <code>-i</code> argument should be a text file with one URL per line, and the <code>-list</code> argument should be added to switch on the “list” mode. Optional, you can specify a title using the <code>-title</code> argument.</p>
<p>I don’t think I’m allowed to share publicly the <strong>“Points of Significance” EPUB</strong> but I can share the commands I used (see <a href="https://github.com/jmonlong/Hippocamplus/tree/config/R/epubifyReviews">instructions on GitHub</a>). There are also commands to download <strong>collections</strong> of Nature Reviews (e.g. Genome Editing or Computational Tools) or search results for Annual Reviews (e.g. Microbiome &amp; Sequencing).</p>
</div>
<div id="vpn-paywall-and-pandoc" class="section level3">
<h3>VPN, paywall and Pandoc</h3>
<p>The script and Pandoc will try to download the text/images so <strong>they should be used behind the university’s VPN (or at the university).</strong> For Nature Reviews, the page can also be downloaded locally and used instead of the URL argument. That might be useful if the articles are accessed by logging in through the web browser (e.g. McGill’s <a href="http://www.mcgill.ca/library/services/connect">EZproxy system</a>). For Annual Reviews however, the Pandoc command will try to download high-res figures so it’s better to run with a VPN.</p>
</div>
<div id="limitations" class="section level3">
<h3>Limitations</h3>
<ul>
<li>Tables are “simplified” which makes them uglier but compatible with EPUB. For example, a multi-rows label is repeated in each row.</li>
<li>If/when the websites change, the scripts will need to be adapted.</li>
<li>This is <a href="https://togelius.blogspot.ca/2016/04/the-differences-between-tinkering-and.html">tinkering</a> so it’s possible that some pages won’t work properly. The ones I tried worked but I didn’t test that many.</li>
</ul>
</div>
<div id="methods" class="section level3">
<h3>Methods</h3>
<p>The scripts use functions from the <a href="https://github.com/hadley/rvest"><em>rvest</em></a> package to download the HTML code of a webpage. Then they use three different strategies to clean up the HTML code. Sometimes <em>rvest</em>’s functions can directly select the relevant parts. Many times, the HTML code is modified using <code>gsub</code> and regular expressions. A few times the script writes new HTML code based on information retrieved using <em>rvest</em>.</p>
<p>Tables are converted into <em>data.frames</em> with <code>html_table</code>, then converted back to HTML usint <a href="https://yihui.name/knitr/"><em>knitr</em></a>’s <code>kable</code> function. In <em>list</em> mode, the script loops through URLs from the input file and concatenate the cleaned HTML code. At the end, the final HTML code is written in a file which is converted to EPUB by <a href="http://pandoc.org/index.html">Pandoc</a>.</p>
</div>
</div>
<div id="other-epub-resources" class="section level2">
<h2>Other EPUB resources</h2>
<ul>
<li><strong>Books</strong> from the <a href="https://link.springer.com/bookseries/7651">Methods in Molecular Biology</a> series can be downloaded in the EPUB format.</li>
<li>The <a href="http://collections.plos.org/translational-bioinformatics">Translational Bioinformatics collection</a> in PLoS Computational Biology has <a href="http://www.ploscollections.org/downloads/TranslationalBioinformatics.epub">an ePub option</a>.</li>
</ul>
</div>
<div id="loose-ends-by-sidney-brenner" class="section level2">
<h2>Loose Ends by Sidney Brenner</h2>
<p><em>Added Apr 6 2019.</em></p>
<p><a href="https://en.wikipedia.org/wiki/Sydney_Brenner">Sidney Brenner</a> passed away yesterday. I knew his name and that he is a legend in the field but never had the chance to really read about him. I saw this tweet from Yaniv Erlich:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">His loose ends book was instrumental for me to get through grad school. You can read it online here:<a href="https://t.co/d4Ni1vosYN">https://t.co/d4Ni1vosYN</a></p>&mdash; Yaniv Erlich (@erlichya) <a href="https://twitter.com/erlichya/status/1114107353090146304?ref_src=twsrc%5Etfw">April 5, 2019</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>So I decided to compile <a href="https://www.cell.com/current-biology/libraries/loose-ends">these monthly columns from 1994-2000</a> that Sidney Brenner wrote into EPUB/MOBI files to read on my ebook reader. I put the <a href="https://github.com/jmonlong/Hippocamplus/blob/config/R/epubifyReviews/README.md#loose-ends-by-sidney-brenner">files on GitHub</a> if anyone else is interested.</p>
</div>

</div>

      </div>
    </div>

    
    

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src="../../../../assets/highlight.pack.js"></script>
    <script src="../../../../assets/r.min.js"></script>
    
    <script>
      hljs.configure({languages: ['r']});
      hljs.initHighlightingOnLoad();
    </script>

    <script src="//yihui.name/js/math-code.js"></script>
    <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
  </body>
</html>

