<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title> </title>
    <link>/</link>
    <language>en-us</language>
    <author>Jean Monlong</author>
    <rights>(C) 2020 Jean Monlong</rights>
    <updated>2019-11-19 00:00:00 &#43;0000 UTC</updated>

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <item>
          <title>Stereograms of the 1KGP PCA/tSNE</title>
          <link>/2019/11/19/stereograms-1kgp-pca-tsne/</link>
          <pubDate>Tue, 19 Nov 2019 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2019/11/19/stereograms-1kgp-pca-tsne/</guid>
          <description>


&lt;div id=&#34;what-is-stereoscopy-how-to-look-at-a-stereogram&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;What is stereoscopy? How to look at a stereogram?&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Technique for creating or enhancing the illusion of depth in an image by means of stereopsis for binocular vision.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;–&lt;a href=&#34;https://en.wikipedia.org/wiki/Stereoscopy&#34;&gt;Stereoscopy (Wikipedia)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Although some binocular-like devices can be used to merge two images and create the illusion of depth, there are also “freeviewing” techniques that don’t require any particular material.
The two main techniques are to either look straight through the image or to cross your eyes.
&lt;a href=&#34;https://www.wikihow.com/View-Stereograms&#34;&gt;Wikihow&lt;/a&gt; has some tips for the “parallel” method.&lt;/p&gt;
&lt;p&gt;I knew about the &lt;a href=&#34;https://en.wikipedia.org/wiki/Autostereogram&#34;&gt;autostereogram&lt;/a&gt; (I had a book of “magic images” as a kid), like this example from Wikipedia:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://upload.wikimedia.org/wikipedia/commons/8/8f/Stereogram_Tut_Random_Dot_Shark.png&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;&lt;em&gt;Let your eyes see through the image and you’ll see a shark appear.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Side-by-side images were new to me.
It’s the same principle though: either let your eyes look through or cross your eyes until both images overlap.
An example from Wikipedia:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Passiflora_caerulea_STEREO_%28R-L%29_2019-06-27.jpg/1280px-Passiflora_caerulea_STEREO_%28R-L%29_2019-06-27.jpg&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;&lt;em&gt;Cross your eyes to align both images and create a new one in between.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;For the side-by-side images I find it easier to use the cross-eye technique because it’s easy to adjust how much to cross my eyes to overlap both images.&lt;/p&gt;
&lt;p&gt;I also noticed that it’s important to have my head straight (both eyes are on the same plane).
When using the cross-eyed method, it helps tilting slightly the head on one side or the other to align the two images vertically.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;making-a-pca-stereogram-using-the-1000-genomes-project-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Making a PCA stereogram using the 1000 Genomes Project data&lt;/h2&gt;
&lt;p&gt;Now let’s see how to make a stereogram of the typical PCA plot using the 1000 Genomes Project data.
We’ll use &lt;em&gt;PC1&lt;/em&gt;/&lt;em&gt;PC2&lt;/em&gt; for the x/y axis, as usual, and &lt;em&gt;PC3&lt;/em&gt; for the “depth” dimension.&lt;/p&gt;
&lt;p&gt;I downloaded a subset of variants in the 1000 Genomes Project Phase 3 that had at least 10 alternate alleles in called genotypes in autosomes (0.1% of variants with &lt;em&gt;AC&amp;gt;=10&lt;/em&gt;).
I used the autosomes’ VCFs at &lt;code&gt;ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/ALL.&amp;lt;CHR&amp;gt;.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz&lt;/code&gt;.
Homozygous refs were then converted to &lt;em&gt;0&lt;/em&gt;, heterozygous variants to &lt;em&gt;1&lt;/em&gt; and homozygous alts to &lt;em&gt;2&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The typical PCA looks like this:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(pca.df, aes(x=PC1, y=PC2, color=super.population)) +
  geom_point(alpha=.4) + theme_bw() +
  scale_color_brewer(palette=&amp;#39;Dark2&amp;#39;) + 
  guides(colour=guide_legend(override.aes=list(alpha=1)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-21-StereographicGGraphs_files/figure-html/normalpcas-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(pca.df, aes(x=PC1, y=PC3, color=super.population)) +
  geom_point(alpha=.4) + theme_bw() +
  scale_color_brewer(palette=&amp;#39;Dark2&amp;#39;) + 
  guides(colour=guide_legend(override.aes=list(alpha=1)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-21-StereographicGGraphs_files/figure-html/normalpcas-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Now the same data with a stereogram using the &lt;a href=&#34;https://ggforce.data-imaginist.com/&#34;&gt;ggforce R package&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## add some white space around the points
extra.margin = .2
pc1.r = range(pca.df$PC1)
pc1.r = pc1.r + c(-1,1)*extra.margin*diff(pc1.r)
pc2.r = range(pca.df$PC2)
pc2.r = pc2.r + c(-1,1)*extra.margin*diff(pc2.r)
##
ggplot(pca.df, aes(x=PC1, y=PC2, depth=-PC3, color=super.population)) +
  geom_point(alpha=.4) + theme_bw() +
  scale_color_brewer(palette=&amp;#39;Dark2&amp;#39;) +
  guides(colour=guide_legend(override.aes=list(alpha=1))) + 
  facet_stereo(IPD=-63.5) + theme(legend.position=&amp;#39;bottom&amp;#39;) +
  xlim(pc1.r) + ylim(pc2.r)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-21-StereographicGGraphs_files/figure-html/stereopca-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;A few notes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I specified the limits of the graph to add a bit of white space around the points. It helps a bit IMO.&lt;/li&gt;
&lt;li&gt;I specified &lt;code&gt;IPD=-63.5&lt;/code&gt; to switch to “cross-eyed’ mode. The default is &lt;code&gt;IPD=63.5&lt;/code&gt; for the”parallel&#34; technique. I could only manage the “parallel” viewing by making the plot very small.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The result is pretty cool, we can tell that the &lt;em&gt;SAS&lt;/em&gt; are in front of all other points, and that the branch of &lt;em&gt;AMR&lt;/em&gt; is stretching to the back.&lt;/p&gt;
&lt;p&gt;It’s fun to imagine showing these graphs during a presentation and watching a crossed-eyed audience like:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../../../imgs/crosseyeddenis.gif&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;making-a-tsne-stereogram-using-the-1000-genomes-project-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Making a tSNE stereogram using the 1000 Genomes Project data&lt;/h2&gt;
&lt;p&gt;A tSNE with 3 components using the top 30 PCs looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-21-StereographicGGraphs_files/figure-html/tsne-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The blobs are nicely separated in 3D.
We can clearly see some blobs corresponding to single populations.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Tweet network from Genome Informatics 2019</title>
          <link>/2019/11/10/gi2019-tweetnetwork/</link>
          <pubDate>Sun, 10 Nov 2019 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2019/11/10/gi2019-tweetnetwork/</guid>
          <description>
&lt;script src=&#34;./assets/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;./assets/rmarkdown-libs/vis/vis.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;./assets/rmarkdown-libs/vis/vis.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;./assets/rmarkdown-libs/visNetwork-binding/visNetwork.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;I want to have a quick look at the tweets from the Genome Informatics meeting:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to learn how to use the &lt;a href=&#34;https://rtweet.info/&#34;&gt;rtweet&lt;/a&gt; and &lt;a href=&#34;https://ggraph.data-imaginist.com/index.html&#34;&gt;ggraph&lt;/a&gt; R packages.&lt;/li&gt;
&lt;li&gt;to create a visual representation (as nice as possible) of our open community, with attendants sharing with each other.&lt;/li&gt;
&lt;li&gt;to highlight the high-volume accounts and their value even for someone attending the conference.&lt;/li&gt;
&lt;li&gt;to see if there are sub-groups of researchers among the attendants.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There is already a comprehensive post about the tweets at this conference (see &lt;a href=&#34;https://lazappi.github.io/twitter-stats/gi2019.html&#34;&gt;lazappi’s Twitter stats&lt;/a&gt;).
Here, I’m trying to visualize the &lt;strong&gt;network of researchers at the conference&lt;/strong&gt; (or interested enough to tweet about it) and &lt;strong&gt;how they retweeted/favorited each other’s tweets&lt;/strong&gt;.
Some sort of measure of who values whose tweets among the attendants.
With this network, I hope to highlight that the high-volume accounts at the conference are also valuable for people attending the conference.
I’m also curious to see if some sub-groups appear.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;All the analysis/numbers are derived only from accounts that tweeted at least once the conference hashtag &lt;code&gt;#gi2019&lt;/code&gt;&lt;/strong&gt;.
This was a way to mostly look at twitter-active people attending the conference.
Of course anyone can use the hashtag so it also includes people that didn’t attend but were interested enough to use the hashtag at least once.
In the rest, I might say “people attending the conference” but I also mean those who twitted the hashtag at least once.&lt;/p&gt;
&lt;div id=&#34;retweets-and-favorites&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Retweets and favorites&lt;/h3&gt;
&lt;p&gt;A lot of retweets/favorites between people attending the conference!
The high-volume accounts are in the center, super valuable for people at the conference too!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-11-10-GItweets_files/figure-html/rt-favs-nw-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nodes are different users colored by how many other users retweeted/favorited their tweets.&lt;/li&gt;
&lt;li&gt;The size of the node corresponds to the total number of original tweet by this user.&lt;/li&gt;
&lt;li&gt;The edge represents retweets/favorites. &lt;code&gt;A -&amp;gt; B&lt;/code&gt;: &lt;em&gt;A&lt;/em&gt; retweeted/favorited tweets from &lt;em&gt;B&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;The transparency of the edge represents the proportion of the total retweets/favs from one user (&lt;em&gt;A&lt;/em&gt;) that went to the other user (&lt;em&gt;B&lt;/em&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;mvp-per-user&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;MVP per user&lt;/h3&gt;
&lt;p&gt;For each user, I &lt;strong&gt;keep only one outgoing connection, the one corresponding to the most retweeted/favorited&lt;/strong&gt;.
Kind of who was the most valuable for this user, the MVP per user.
I’m not good with names…
If tied, retweets are used to break the ties.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Interactive network. May take a few seconds to render. Scroll to zoom in (names appear when zooming in). Hover on nodes to see more information about a user, on edges to see the proportion of the retweets/favorites from user A that went to user B.&lt;/em&gt;&lt;/p&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:1000px;height:800px;&#34; class=&#34;visNetwork html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;nodes&#34;:{&#34;label&#34;:[&#34;__yoson__&#34;,&#34;_bakshay&#34;,&#34;_lazappi_&#34;,&#34;aaronquinlan&#34;,&#34;ACSCevents&#34;,&#34;AdamJOrr&#34;,&#34;Ahmed_Microbes&#34;,&#34;ahmedElkoussy&#34;,&#34;alaina_shumate&#34;,&#34;alexwoolley&#34;,&#34;AliciaOshlack&#34;,&#34;anaconesa&#34;,&#34;AndrewBCaldwell&#34;,&#34;AP_Boyle&#34;,&#34;aphillippy&#34;,&#34;ArangRhie&#34;,&#34;BenLangmead&#34;,&#34;BillHanage&#34;,&#34;BioinfoTools&#34;,&#34;bnlasse&#34;,&#34;byuhobbes&#34;,&#34;camerongenomics&#34;,&#34;CChujia&#34;,&#34;chrisamiller&#34;,&#34;cshlmeetings&#34;,&#34;CuriousMaia&#34;,&#34;David_McGaughey&#34;,&#34;DCGenomics&#34;,&#34;deannachurch&#34;,&#34;dgmacarthur&#34;,&#34;DNAwyman&#34;,&#34;dsurujon&#34;,&#34;DUNQU1&#34;,&#34;envisagenics&#34;,&#34;FadelBerkadar&#34;,&#34;FairlieReese&#34;,&#34;Gavin_Oliver&#34;,&#34;GeneviaLtd&#34;,&#34;GenomeAssembler&#34;,&#34;GenomeBiology&#34;,&#34;GenomeInABottle&#34;,&#34;genomicscloud&#34;,&#34;giuliaguidi&#34;,&#34;gkay92&#34;,&#34;gnarzisi&#34;,&#34;GrameneDatabase&#34;,&#34;groza_cristian&#34;,&#34;guilbourque&#34;,&#34;hdashnow&#34;,&#34;HeiniMNatri&#34;,&#34;hjpimentel&#34;,&#34;HKhiabanian&#34;,&#34;hpcprogrammer&#34;,&#34;IanFiddes&#34;,&#34;iddux&#34;,&#34;infoecho&#34;,&#34;jake_vancampen&#34;,&#34;JaneAnnPulman&#34;,&#34;JasonWilliamsNY&#34;,&#34;JMonlong&#34;,&#34;JonathanGoeke&#34;,&#34;jordanberg0&#34;,&#34;k3yavi&#34;,&#34;KadashKate&#34;,&#34;KarineLeRoch1&#34;,&#34;kasukawa&#34;,&#34;Kiss_RNA_Lab&#34;,&#34;KitRidout&#34;,&#34;KMS_Meltzy&#34;,&#34;kuthedk&#34;,&#34;KVittingSeerup&#34;,&#34;LaurenCowley4&#34;,&#34;lh3lh3&#34;,&#34;lizworthey&#34;,&#34;lpachter&#34;,&#34;Magdoll&#34;,&#34;mahtabm81&#34;,&#34;marianattestad&#34;,&#34;MarkGerstein&#34;,&#34;megbowman&#34;,&#34;michaelhoffman&#34;,&#34;michelebusby&#34;,&#34;milot_mirdita&#34;,&#34;MinionLab&#34;,&#34;natalicik&#34;,&#34;NeBanovich&#34;,&#34;nephantes&#34;,&#34;nimra236&#34;,&#34;noush_joglekar&#34;,&#34;ObsGynaeCam&#34;,&#34;OnixHealth&#34;,&#34;pathogenomenick&#34;,&#34;pmelsted&#34;,&#34;pouryany&#34;,&#34;RareSeas&#34;,&#34;Repealist_&#34;,&#34;s_ramach&#34;,&#34;sailakss&#34;,&#34;samstudio8&#34;,&#34;sedlazeck&#34;,&#34;SeriousHorncat&#34;,&#34;SevenBridges&#34;,&#34;sexchrlab&#34;,&#34;si_hardwick&#34;,&#34;sienkieee&#34;,&#34;sinabooeshaghi&#34;,&#34;starfishlu&#34;,&#34;StevenSalzberg1&#34;,&#34;sunggong&#34;,&#34;sz_genomics&#34;,&#34;thesteinegger&#34;,&#34;timp0&#34;,&#34;TTTrinh16&#34;,&#34;TwilightForce1&#34;,&#34;vladimir_tomic&#34;,&#34;wait_sasha&#34;,&#34;winhide&#34;,&#34;YiXing77&#34;,&#34;zevkronenberg&#34;],&#34;rt.favs.by&#34;:[37,3,20,22,20,5,3,2,4,4,229,28,2,4,60,28,53,17,0,64,220,5,7,106,51,9,34,19,10,10,3,5,4,6,0,21,2,6,5,181,10,1,5,3,10,2,3,3,215,15,27,6,3,2,65,88,2,3,37,4,1,4,14,2,10,16,2,1,7,2,2,2,37,214,181,185,1,2,6,5,17,7,9,6,7,1,12,27,30,1,2,96,110,0,4,17,2,3,70,36,18,5,94,17,7,11,8,65,1,17,16,0,9,1,10,2,2,28,1],&#34;n.rt.favs&#34;:[31,10,11,42,1,60,50,13,6,2,203,40,3,3,23,8,48,5,3,73,132,14,7,21,25,20,2,64,3,6,10,11,15,3,19,10,4,5,5,50,3,7,130,17,13,9,14,2,103,18,87,7,49,7,17,52,6,13,289,14,7,58,56,14,60,14,3,2,3,4,14,45,3,68,40,13,3,5,83,17,26,8,15,11,8,11,5,23,24,2,1,58,5,1,132,15,23,34,52,67,45,1,77,11,5,30,7,19,3,40,12,16,3,1,6,31,5,42,6],&#34;id&#34;:[&#34;__yoson__&#34;,&#34;_bakshay&#34;,&#34;_lazappi_&#34;,&#34;aaronquinlan&#34;,&#34;ACSCevents&#34;,&#34;AdamJOrr&#34;,&#34;Ahmed_Microbes&#34;,&#34;ahmedElkoussy&#34;,&#34;alaina_shumate&#34;,&#34;alexwoolley&#34;,&#34;AliciaOshlack&#34;,&#34;anaconesa&#34;,&#34;AndrewBCaldwell&#34;,&#34;AP_Boyle&#34;,&#34;aphillippy&#34;,&#34;ArangRhie&#34;,&#34;BenLangmead&#34;,&#34;BillHanage&#34;,&#34;BioinfoTools&#34;,&#34;bnlasse&#34;,&#34;byuhobbes&#34;,&#34;camerongenomics&#34;,&#34;CChujia&#34;,&#34;chrisamiller&#34;,&#34;cshlmeetings&#34;,&#34;CuriousMaia&#34;,&#34;David_McGaughey&#34;,&#34;DCGenomics&#34;,&#34;deannachurch&#34;,&#34;dgmacarthur&#34;,&#34;DNAwyman&#34;,&#34;dsurujon&#34;,&#34;DUNQU1&#34;,&#34;envisagenics&#34;,&#34;FadelBerkadar&#34;,&#34;FairlieReese&#34;,&#34;Gavin_Oliver&#34;,&#34;GeneviaLtd&#34;,&#34;GenomeAssembler&#34;,&#34;GenomeBiology&#34;,&#34;GenomeInABottle&#34;,&#34;genomicscloud&#34;,&#34;giuliaguidi&#34;,&#34;gkay92&#34;,&#34;gnarzisi&#34;,&#34;GrameneDatabase&#34;,&#34;groza_cristian&#34;,&#34;guilbourque&#34;,&#34;hdashnow&#34;,&#34;HeiniMNatri&#34;,&#34;hjpimentel&#34;,&#34;HKhiabanian&#34;,&#34;hpcprogrammer&#34;,&#34;IanFiddes&#34;,&#34;iddux&#34;,&#34;infoecho&#34;,&#34;jake_vancampen&#34;,&#34;JaneAnnPulman&#34;,&#34;JasonWilliamsNY&#34;,&#34;JMonlong&#34;,&#34;JonathanGoeke&#34;,&#34;jordanberg0&#34;,&#34;k3yavi&#34;,&#34;KadashKate&#34;,&#34;KarineLeRoch1&#34;,&#34;kasukawa&#34;,&#34;Kiss_RNA_Lab&#34;,&#34;KitRidout&#34;,&#34;KMS_Meltzy&#34;,&#34;kuthedk&#34;,&#34;KVittingSeerup&#34;,&#34;LaurenCowley4&#34;,&#34;lh3lh3&#34;,&#34;lizworthey&#34;,&#34;lpachter&#34;,&#34;Magdoll&#34;,&#34;mahtabm81&#34;,&#34;marianattestad&#34;,&#34;MarkGerstein&#34;,&#34;megbowman&#34;,&#34;michaelhoffman&#34;,&#34;michelebusby&#34;,&#34;milot_mirdita&#34;,&#34;MinionLab&#34;,&#34;natalicik&#34;,&#34;NeBanovich&#34;,&#34;nephantes&#34;,&#34;nimra236&#34;,&#34;noush_joglekar&#34;,&#34;ObsGynaeCam&#34;,&#34;OnixHealth&#34;,&#34;pathogenomenick&#34;,&#34;pmelsted&#34;,&#34;pouryany&#34;,&#34;RareSeas&#34;,&#34;Repealist_&#34;,&#34;s_ramach&#34;,&#34;sailakss&#34;,&#34;samstudio8&#34;,&#34;sedlazeck&#34;,&#34;SeriousHorncat&#34;,&#34;SevenBridges&#34;,&#34;sexchrlab&#34;,&#34;si_hardwick&#34;,&#34;sienkieee&#34;,&#34;sinabooeshaghi&#34;,&#34;starfishlu&#34;,&#34;StevenSalzberg1&#34;,&#34;sunggong&#34;,&#34;sz_genomics&#34;,&#34;thesteinegger&#34;,&#34;timp0&#34;,&#34;TTTrinh16&#34;,&#34;TwilightForce1&#34;,&#34;vladimir_tomic&#34;,&#34;wait_sasha&#34;,&#34;winhide&#34;,&#34;YiXing77&#34;,&#34;zevkronenberg&#34;],&#34;popularity&#34;:[1,0,1,0,0,0,0,0,0,0,11,2,0,0,0,1,1,0,0,4,9,0,0,2,2,0,2,1,1,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,11,0,0,0,0,0,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,8,12,0,1,0,0,0,0,1,0,0,0,0,2,0,0,0,3,1,0,1,1,0,0,1,1,0,1,8,0,0,1,0,0,0,0,2,0,2,1,1,0,0,1,0],&#34;ntweets&#34;:[8,1,4,1,1,2,4,1,1,1,39,11,1,2,3,2,2,5,2,32,262,2,1,33,3,3,16,9,2,1,1,2,5,2,1,3,1,4,2,155,1,1,1,1,1,1,4,1,49,4,5,3,2,1,24,14,3,1,7,1,2,1,4,1,2,34,1,1,1,1,1,1,1,274,42,111,1,1,4,1,4,1,3,2,5,1,6,2,9,1,2,11,60,1,4,10,2,1,9,6,6,1,15,6,2,2,2,9,1,4,6,1,1,1,2,1,2,10,1],&#34;title&#34;:[&#34;tweets:8; retweets/favs:31; retweets/favs by:37&#34;,&#34;tweets:1; retweets/favs:10; retweets/favs by:3&#34;,&#34;tweets:4; retweets/favs:11; retweets/favs by:20&#34;,&#34;tweets:1; retweets/favs:42; retweets/favs by:22&#34;,&#34;tweets:1; retweets/favs:1; retweets/favs by:20&#34;,&#34;tweets:2; retweets/favs:60; retweets/favs by:5&#34;,&#34;tweets:4; retweets/favs:50; retweets/favs by:3&#34;,&#34;tweets:1; retweets/favs:13; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:6; retweets/favs by:4&#34;,&#34;tweets:1; retweets/favs:2; retweets/favs by:4&#34;,&#34;tweets:39; retweets/favs:203; retweets/favs by:229&#34;,&#34;tweets:11; retweets/favs:40; retweets/favs by:28&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:2&#34;,&#34;tweets:2; retweets/favs:3; retweets/favs by:4&#34;,&#34;tweets:3; retweets/favs:23; retweets/favs by:60&#34;,&#34;tweets:2; retweets/favs:8; retweets/favs by:28&#34;,&#34;tweets:2; retweets/favs:48; retweets/favs by:53&#34;,&#34;tweets:5; retweets/favs:5; retweets/favs by:17&#34;,&#34;tweets:2; retweets/favs:3; retweets/favs by:0&#34;,&#34;tweets:32; retweets/favs:73; retweets/favs by:64&#34;,&#34;tweets:262; retweets/favs:132; retweets/favs by:220&#34;,&#34;tweets:2; retweets/favs:14; retweets/favs by:5&#34;,&#34;tweets:1; retweets/favs:7; retweets/favs by:7&#34;,&#34;tweets:33; retweets/favs:21; retweets/favs by:106&#34;,&#34;tweets:3; retweets/favs:25; retweets/favs by:51&#34;,&#34;tweets:3; retweets/favs:20; retweets/favs by:9&#34;,&#34;tweets:16; retweets/favs:2; retweets/favs by:34&#34;,&#34;tweets:9; retweets/favs:64; retweets/favs by:19&#34;,&#34;tweets:2; retweets/favs:3; retweets/favs by:10&#34;,&#34;tweets:1; retweets/favs:6; retweets/favs by:10&#34;,&#34;tweets:1; retweets/favs:10; retweets/favs by:3&#34;,&#34;tweets:2; retweets/favs:11; retweets/favs by:5&#34;,&#34;tweets:5; retweets/favs:15; retweets/favs by:4&#34;,&#34;tweets:2; retweets/favs:3; retweets/favs by:6&#34;,&#34;tweets:1; retweets/favs:19; retweets/favs by:0&#34;,&#34;tweets:3; retweets/favs:10; retweets/favs by:21&#34;,&#34;tweets:1; retweets/favs:4; retweets/favs by:2&#34;,&#34;tweets:4; retweets/favs:5; retweets/favs by:6&#34;,&#34;tweets:2; retweets/favs:5; retweets/favs by:5&#34;,&#34;tweets:155; retweets/favs:50; retweets/favs by:181&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:10&#34;,&#34;tweets:1; retweets/favs:7; retweets/favs by:1&#34;,&#34;tweets:1; retweets/favs:130; retweets/favs by:5&#34;,&#34;tweets:1; retweets/favs:17; retweets/favs by:3&#34;,&#34;tweets:1; retweets/favs:13; retweets/favs by:10&#34;,&#34;tweets:1; retweets/favs:9; retweets/favs by:2&#34;,&#34;tweets:4; retweets/favs:14; retweets/favs by:3&#34;,&#34;tweets:1; retweets/favs:2; retweets/favs by:3&#34;,&#34;tweets:49; retweets/favs:103; retweets/favs by:215&#34;,&#34;tweets:4; retweets/favs:18; retweets/favs by:15&#34;,&#34;tweets:5; retweets/favs:87; retweets/favs by:27&#34;,&#34;tweets:3; retweets/favs:7; retweets/favs by:6&#34;,&#34;tweets:2; retweets/favs:49; retweets/favs by:3&#34;,&#34;tweets:1; retweets/favs:7; retweets/favs by:2&#34;,&#34;tweets:24; retweets/favs:17; retweets/favs by:65&#34;,&#34;tweets:14; retweets/favs:52; retweets/favs by:88&#34;,&#34;tweets:3; retweets/favs:6; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:13; retweets/favs by:3&#34;,&#34;tweets:7; retweets/favs:289; retweets/favs by:37&#34;,&#34;tweets:1; retweets/favs:14; retweets/favs by:4&#34;,&#34;tweets:2; retweets/favs:7; retweets/favs by:1&#34;,&#34;tweets:1; retweets/favs:58; retweets/favs by:4&#34;,&#34;tweets:4; retweets/favs:56; retweets/favs by:14&#34;,&#34;tweets:1; retweets/favs:14; retweets/favs by:2&#34;,&#34;tweets:2; retweets/favs:60; retweets/favs by:10&#34;,&#34;tweets:34; retweets/favs:14; retweets/favs by:16&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:2; retweets/favs by:1&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:7&#34;,&#34;tweets:1; retweets/favs:4; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:14; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:45; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:37&#34;,&#34;tweets:274; retweets/favs:68; retweets/favs by:214&#34;,&#34;tweets:42; retweets/favs:40; retweets/favs by:181&#34;,&#34;tweets:111; retweets/favs:13; retweets/favs by:185&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:1&#34;,&#34;tweets:1; retweets/favs:5; retweets/favs by:2&#34;,&#34;tweets:4; retweets/favs:83; retweets/favs by:6&#34;,&#34;tweets:1; retweets/favs:17; retweets/favs by:5&#34;,&#34;tweets:4; retweets/favs:26; retweets/favs by:17&#34;,&#34;tweets:1; retweets/favs:8; retweets/favs by:7&#34;,&#34;tweets:3; retweets/favs:15; retweets/favs by:9&#34;,&#34;tweets:2; retweets/favs:11; retweets/favs by:6&#34;,&#34;tweets:5; retweets/favs:8; retweets/favs by:7&#34;,&#34;tweets:1; retweets/favs:11; retweets/favs by:1&#34;,&#34;tweets:6; retweets/favs:5; retweets/favs by:12&#34;,&#34;tweets:2; retweets/favs:23; retweets/favs by:27&#34;,&#34;tweets:9; retweets/favs:24; retweets/favs by:30&#34;,&#34;tweets:1; retweets/favs:2; retweets/favs by:1&#34;,&#34;tweets:2; retweets/favs:1; retweets/favs by:2&#34;,&#34;tweets:11; retweets/favs:58; retweets/favs by:96&#34;,&#34;tweets:60; retweets/favs:5; retweets/favs by:110&#34;,&#34;tweets:1; retweets/favs:1; retweets/favs by:0&#34;,&#34;tweets:4; retweets/favs:132; retweets/favs by:4&#34;,&#34;tweets:10; retweets/favs:15; retweets/favs by:17&#34;,&#34;tweets:2; retweets/favs:23; retweets/favs by:2&#34;,&#34;tweets:1; retweets/favs:34; retweets/favs by:3&#34;,&#34;tweets:9; retweets/favs:52; retweets/favs by:70&#34;,&#34;tweets:6; retweets/favs:67; retweets/favs by:36&#34;,&#34;tweets:6; retweets/favs:45; retweets/favs by:18&#34;,&#34;tweets:1; retweets/favs:1; retweets/favs by:5&#34;,&#34;tweets:15; retweets/favs:77; retweets/favs by:94&#34;,&#34;tweets:6; retweets/favs:11; retweets/favs by:17&#34;,&#34;tweets:2; retweets/favs:5; retweets/favs by:7&#34;,&#34;tweets:2; retweets/favs:30; retweets/favs by:11&#34;,&#34;tweets:2; retweets/favs:7; retweets/favs by:8&#34;,&#34;tweets:9; retweets/favs:19; retweets/favs by:65&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:1&#34;,&#34;tweets:4; retweets/favs:40; retweets/favs by:17&#34;,&#34;tweets:6; retweets/favs:12; retweets/favs by:16&#34;,&#34;tweets:1; retweets/favs:16; retweets/favs by:0&#34;,&#34;tweets:1; retweets/favs:3; retweets/favs by:9&#34;,&#34;tweets:1; retweets/favs:1; retweets/favs by:1&#34;,&#34;tweets:2; retweets/favs:6; retweets/favs by:10&#34;,&#34;tweets:1; retweets/favs:31; retweets/favs by:2&#34;,&#34;tweets:2; retweets/favs:5; retweets/favs by:2&#34;,&#34;tweets:10; retweets/favs:42; retweets/favs by:28&#34;,&#34;tweets:1; retweets/favs:6; retweets/favs by:1&#34;],&#34;size&#34;:[5.58394160583942,5.07299270072993,5.29197080291971,5.07299270072993,5.07299270072993,5.14598540145985,5.29197080291971,5.07299270072993,5.07299270072993,5.07299270072993,7.84671532846715,5.8029197080292,5.07299270072993,5.14598540145985,5.21897810218978,5.14598540145985,5.14598540145985,5.36496350364964,5.14598540145985,7.33576642335766,24.1240875912409,5.14598540145985,5.07299270072993,7.40875912408759,5.21897810218978,5.21897810218978,6.16788321167883,5.65693430656934,5.14598540145985,5.07299270072993,5.07299270072993,5.14598540145985,5.36496350364964,5.14598540145985,5.07299270072993,5.21897810218978,5.07299270072993,5.29197080291971,5.14598540145985,16.3138686131387,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.29197080291971,5.07299270072993,8.57664233576642,5.29197080291971,5.36496350364964,5.21897810218978,5.14598540145985,5.07299270072993,6.75182481751825,6.02189781021898,5.21897810218978,5.07299270072993,5.51094890510949,5.07299270072993,5.14598540145985,5.07299270072993,5.29197080291971,5.07299270072993,5.14598540145985,7.48175182481752,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,5.07299270072993,25,8.06569343065693,13.1021897810219,5.07299270072993,5.07299270072993,5.29197080291971,5.07299270072993,5.29197080291971,5.07299270072993,5.21897810218978,5.14598540145985,5.36496350364964,5.07299270072993,5.43795620437956,5.14598540145985,5.65693430656934,5.07299270072993,5.14598540145985,5.8029197080292,9.37956204379562,5.07299270072993,5.29197080291971,5.72992700729927,5.14598540145985,5.07299270072993,5.65693430656934,5.43795620437956,5.43795620437956,5.07299270072993,6.0948905109489,5.43795620437956,5.14598540145985,5.14598540145985,5.14598540145985,5.65693430656934,5.07299270072993,5.29197080291971,5.43795620437956,5.07299270072993,5.07299270072993,5.07299270072993,5.14598540145985,5.07299270072993,5.14598540145985,5.72992700729927,5.07299270072993]},&#34;edges&#34;:{&#34;from&#34;:[&#34;__yoson__&#34;,&#34;_bakshay&#34;,&#34;_lazappi_&#34;,&#34;aaronquinlan&#34;,&#34;ACSCevents&#34;,&#34;AdamJOrr&#34;,&#34;Ahmed_Microbes&#34;,&#34;ahmedElkoussy&#34;,&#34;alaina_shumate&#34;,&#34;alexwoolley&#34;,&#34;AliciaOshlack&#34;,&#34;anaconesa&#34;,&#34;AndrewBCaldwell&#34;,&#34;AP_Boyle&#34;,&#34;aphillippy&#34;,&#34;ArangRhie&#34;,&#34;BenLangmead&#34;,&#34;BillHanage&#34;,&#34;BioinfoTools&#34;,&#34;bnlasse&#34;,&#34;byuhobbes&#34;,&#34;camerongenomics&#34;,&#34;CChujia&#34;,&#34;chrisamiller&#34;,&#34;cshlmeetings&#34;,&#34;CuriousMaia&#34;,&#34;David_McGaughey&#34;,&#34;DCGenomics&#34;,&#34;deannachurch&#34;,&#34;dgmacarthur&#34;,&#34;DNAwyman&#34;,&#34;dsurujon&#34;,&#34;DUNQU1&#34;,&#34;envisagenics&#34;,&#34;FadelBerkadar&#34;,&#34;FairlieReese&#34;,&#34;Gavin_Oliver&#34;,&#34;GeneviaLtd&#34;,&#34;GenomeAssembler&#34;,&#34;GenomeBiology&#34;,&#34;GenomeInABottle&#34;,&#34;genomicscloud&#34;,&#34;giuliaguidi&#34;,&#34;gkay92&#34;,&#34;gnarzisi&#34;,&#34;GrameneDatabase&#34;,&#34;groza_cristian&#34;,&#34;guilbourque&#34;,&#34;hdashnow&#34;,&#34;HeiniMNatri&#34;,&#34;hjpimentel&#34;,&#34;HKhiabanian&#34;,&#34;hpcprogrammer&#34;,&#34;IanFiddes&#34;,&#34;iddux&#34;,&#34;infoecho&#34;,&#34;jake_vancampen&#34;,&#34;JaneAnnPulman&#34;,&#34;JasonWilliamsNY&#34;,&#34;JMonlong&#34;,&#34;JonathanGoeke&#34;,&#34;jordanberg0&#34;,&#34;k3yavi&#34;,&#34;KadashKate&#34;,&#34;KarineLeRoch1&#34;,&#34;kasukawa&#34;,&#34;Kiss_RNA_Lab&#34;,&#34;KitRidout&#34;,&#34;KMS_Meltzy&#34;,&#34;kuthedk&#34;,&#34;KVittingSeerup&#34;,&#34;LaurenCowley4&#34;,&#34;lh3lh3&#34;,&#34;lizworthey&#34;,&#34;lpachter&#34;,&#34;Magdoll&#34;,&#34;mahtabm81&#34;,&#34;marianattestad&#34;,&#34;MarkGerstein&#34;,&#34;megbowman&#34;,&#34;michaelhoffman&#34;,&#34;michelebusby&#34;,&#34;milot_mirdita&#34;,&#34;MinionLab&#34;,&#34;natalicik&#34;,&#34;NeBanovich&#34;,&#34;nephantes&#34;,&#34;nimra236&#34;,&#34;noush_joglekar&#34;,&#34;ObsGynaeCam&#34;,&#34;OnixHealth&#34;,&#34;pathogenomenick&#34;,&#34;pmelsted&#34;,&#34;pouryany&#34;,&#34;RareSeas&#34;,&#34;Repealist_&#34;,&#34;s_ramach&#34;,&#34;sailakss&#34;,&#34;samstudio8&#34;,&#34;sedlazeck&#34;,&#34;SeriousHorncat&#34;,&#34;SevenBridges&#34;,&#34;sexchrlab&#34;,&#34;si_hardwick&#34;,&#34;sienkieee&#34;,&#34;sinabooeshaghi&#34;,&#34;starfishlu&#34;,&#34;StevenSalzberg1&#34;,&#34;sunggong&#34;,&#34;sz_genomics&#34;,&#34;thesteinegger&#34;,&#34;timp0&#34;,&#34;TTTrinh16&#34;,&#34;TwilightForce1&#34;,&#34;vladimir_tomic&#34;,&#34;wait_sasha&#34;,&#34;winhide&#34;,&#34;YiXing77&#34;,&#34;zevkronenberg&#34;],&#34;to&#34;:[&#34;lpachter&#34;,&#34;lpachter&#34;,&#34;bnlasse&#34;,&#34;AliciaOshlack&#34;,&#34;sexchrlab&#34;,&#34;sexchrlab&#34;,&#34;pathogenomenick&#34;,&#34;GenomeBiology&#34;,&#34;thesteinegger&#34;,&#34;GenomeBiology&#34;,&#34;hdashnow&#34;,&#34;Magdoll&#34;,&#34;iddux&#34;,&#34;BenLangmead&#34;,&#34;ArangRhie&#34;,&#34;infoecho&#34;,&#34;AliciaOshlack&#34;,&#34;pathogenomenick&#34;,&#34;sexchrlab&#34;,&#34;lizworthey&#34;,&#34;lizworthey&#34;,&#34;hdashnow&#34;,&#34;GenomeBiology&#34;,&#34;_lazappi_&#34;,&#34;Repealist_&#34;,&#34;AliciaOshlack&#34;,&#34;hdashnow&#34;,&#34;byuhobbes&#34;,&#34;Magdoll&#34;,&#34;sexchrlab&#34;,&#34;anaconesa&#34;,&#34;lpachter&#34;,&#34;Magdoll&#34;,&#34;cshlmeetings&#34;,&#34;AliciaOshlack&#34;,&#34;anaconesa&#34;,&#34;hdashnow&#34;,&#34;bnlasse&#34;,&#34;AliciaOshlack&#34;,&#34;hdashnow&#34;,&#34;DCGenomics&#34;,&#34;SevenBridges&#34;,&#34;GenomeBiology&#34;,&#34;pathogenomenick&#34;,&#34;AliciaOshlack&#34;,&#34;infoecho&#34;,&#34;nimra236&#34;,&#34;sexchrlab&#34;,&#34;AliciaOshlack&#34;,&#34;GenomeBiology&#34;,&#34;lpachter&#34;,&#34;sexchrlab&#34;,&#34;byuhobbes&#34;,&#34;infoecho&#34;,&#34;byuhobbes&#34;,&#34;Magdoll&#34;,&#34;bnlasse&#34;,&#34;hdashnow&#34;,&#34;byuhobbes&#34;,&#34;Magdoll&#34;,&#34;Magdoll&#34;,&#34;hdashnow&#34;,&#34;byuhobbes&#34;,&#34;YiXing77&#34;,&#34;lizworthey&#34;,&#34;chrisamiller&#34;,&#34;TTTrinh16&#34;,&#34;hdashnow&#34;,&#34;chrisamiller&#34;,&#34;samstudio8&#34;,&#34;byuhobbes&#34;,&#34;byuhobbes&#34;,&#34;Magdoll&#34;,&#34;hdashnow&#34;,&#34;__yoson__&#34;,&#34;David_McGaughey&#34;,&#34;AliciaOshlack&#34;,&#34;deannachurch&#34;,&#34;lizworthey&#34;,&#34;hdashnow&#34;,&#34;sexchrlab&#34;,&#34;lpachter&#34;,&#34;thesteinegger&#34;,&#34;sexchrlab&#34;,&#34;pmelsted&#34;,&#34;lpachter&#34;,&#34;bnlasse&#34;,&#34;infoecho&#34;,&#34;Magdoll&#34;,&#34;lpachter&#34;,&#34;RareSeas&#34;,&#34;AliciaOshlack&#34;,&#34;sinabooeshaghi&#34;,&#34;cshlmeetings&#34;,&#34;byuhobbes&#34;,&#34;lizworthey&#34;,&#34;hdashnow&#34;,&#34;GenomeBiology&#34;,&#34;GenomeBiology&#34;,&#34;GenomeBiology&#34;,&#34;Magdoll&#34;,&#34;vladimir_tomic&#34;,&#34;AliciaOshlack&#34;,&#34;AliciaOshlack&#34;,&#34;iddux&#34;,&#34;lpachter&#34;,&#34;nimra236&#34;,&#34;byuhobbes&#34;,&#34;David_McGaughey&#34;,&#34;Magdoll&#34;,&#34;milot_mirdita&#34;,&#34;sedlazeck&#34;,&#34;TTTrinh16&#34;,&#34;TwilightForce1&#34;,&#34;Magdoll&#34;,&#34;infoecho&#34;,&#34;iddux&#34;,&#34;Magdoll&#34;,&#34;marianattestad&#34;],&#34;from.id&#34;:[&#34;1699767620&#34;,&#34;760184116541140992&#34;,&#34;2601010981&#34;,&#34;293116923&#34;,&#34;420574055&#34;,&#34;287953746&#34;,&#34;52240235&#34;,&#34;168478817&#34;,&#34;917765718682275841&#34;,&#34;13941962&#34;,&#34;1547838528&#34;,&#34;156162127&#34;,&#34;4750151687&#34;,&#34;24257253&#34;,&#34;52133120&#34;,&#34;817382322274070528&#34;,&#34;296300255&#34;,&#34;21184460&#34;,&#34;86493795&#34;,&#34;1081042932&#34;,&#34;37997717&#34;,&#34;778232695302291457&#34;,&#34;898069274341908480&#34;,&#34;10054472&#34;,&#34;454977993&#34;,&#34;818256778945241089&#34;,&#34;1382528755&#34;,&#34;1608312078&#34;,&#34;16174754&#34;,&#34;16629477&#34;,&#34;1141449353522900992&#34;,&#34;750347027456860160&#34;,&#34;2856326414&#34;,&#34;2239884889&#34;,&#34;1028770772&#34;,&#34;440115109&#34;,&#34;257903608&#34;,&#34;3179285374&#34;,&#34;2930281926&#34;,&#34;115039678&#34;,&#34;778427430&#34;,&#34;2897667230&#34;,&#34;112156645&#34;,&#34;132841631&#34;,&#34;228410704&#34;,&#34;293139665&#34;,&#34;837344325520482306&#34;,&#34;493594946&#34;,&#34;20126211&#34;,&#34;3245973772&#34;,&#34;2213018582&#34;,&#34;4026259319&#34;,&#34;40707676&#34;,&#34;394283200&#34;,&#34;15276911&#34;,&#34;29575969&#34;,&#34;918304901171625984&#34;,&#34;222255743&#34;,&#34;1692248610&#34;,&#34;2781954351&#34;,&#34;2664569172&#34;,&#34;822551391541542912&#34;,&#34;1022198774&#34;,&#34;1167507112836128768&#34;,&#34;1039300879189327873&#34;,&#34;7583472&#34;,&#34;931179725694914561&#34;,&#34;79293586&#34;,&#34;1425644274&#34;,&#34;855754040&#34;,&#34;2992390126&#34;,&#34;1137135674&#34;,&#34;2165843324&#34;,&#34;562328466&#34;,&#34;31936449&#34;,&#34;18927401&#34;,&#34;47566275&#34;,&#34;109487723&#34;,&#34;230944453&#34;,&#34;18154205&#34;,&#34;14897792&#34;,&#34;155651779&#34;,&#34;424098004&#34;,&#34;2530913857&#34;,&#34;18913738&#34;,&#34;2285597287&#34;,&#34;201043553&#34;,&#34;2482049948&#34;,&#34;931540786616963077&#34;,&#34;2569068973&#34;,&#34;1153420722687098880&#34;,&#34;85906238&#34;,&#34;1135472480&#34;,&#34;1566909187&#34;,&#34;2355383844&#34;,&#34;4615306949&#34;,&#34;1370684718&#34;,&#34;1493247858&#34;,&#34;40444555&#34;,&#34;2781296741&#34;,&#34;286967790&#34;,&#34;260900441&#34;,&#34;143086518&#34;,&#34;4196485460&#34;,&#34;358172333&#34;,&#34;1455996980&#34;,&#34;931741628141891584&#34;,&#34;782615960&#34;,&#34;35460946&#34;,&#34;994031581789589504&#34;,&#34;784241064936771584&#34;,&#34;191501637&#34;,&#34;1192092249137524737&#34;,&#34;1184415367579328513&#34;,&#34;885356456&#34;,&#34;917386554280239104&#34;,&#34;15273272&#34;,&#34;1589203201&#34;,&#34;22741656&#34;],&#34;to.id&#34;:[&#34;31936449&#34;,&#34;31936449&#34;,&#34;1081042932&#34;,&#34;1547838528&#34;,&#34;143086518&#34;,&#34;143086518&#34;,&#34;85906238&#34;,&#34;115039678&#34;,&#34;784241064936771584&#34;,&#34;115039678&#34;,&#34;20126211&#34;,&#34;18927401&#34;,&#34;15276911&#34;,&#34;296300255&#34;,&#34;817382322274070528&#34;,&#34;29575969&#34;,&#34;1547838528&#34;,&#34;85906238&#34;,&#34;143086518&#34;,&#34;562328466&#34;,&#34;562328466&#34;,&#34;20126211&#34;,&#34;115039678&#34;,&#34;2601010981&#34;,&#34;4615306949&#34;,&#34;1547838528&#34;,&#34;20126211&#34;,&#34;37997717&#34;,&#34;18927401&#34;,&#34;143086518&#34;,&#34;156162127&#34;,&#34;31936449&#34;,&#34;18927401&#34;,&#34;454977993&#34;,&#34;1547838528&#34;,&#34;156162127&#34;,&#34;20126211&#34;,&#34;1081042932&#34;,&#34;1547838528&#34;,&#34;20126211&#34;,&#34;1608312078&#34;,&#34;260900441&#34;,&#34;115039678&#34;,&#34;85906238&#34;,&#34;1547838528&#34;,&#34;29575969&#34;,&#34;2482049948&#34;,&#34;143086518&#34;,&#34;1547838528&#34;,&#34;115039678&#34;,&#34;31936449&#34;,&#34;143086518&#34;,&#34;37997717&#34;,&#34;29575969&#34;,&#34;37997717&#34;,&#34;18927401&#34;,&#34;1081042932&#34;,&#34;20126211&#34;,&#34;37997717&#34;,&#34;18927401&#34;,&#34;18927401&#34;,&#34;20126211&#34;,&#34;37997717&#34;,&#34;1589203201&#34;,&#34;562328466&#34;,&#34;10054472&#34;,&#34;1192092249137524737&#34;,&#34;20126211&#34;,&#34;10054472&#34;,&#34;40444555&#34;,&#34;37997717&#34;,&#34;37997717&#34;,&#34;18927401&#34;,&#34;20126211&#34;,&#34;1699767620&#34;,&#34;1382528755&#34;,&#34;1547838528&#34;,&#34;16174754&#34;,&#34;562328466&#34;,&#34;20126211&#34;,&#34;143086518&#34;,&#34;31936449&#34;,&#34;784241064936771584&#34;,&#34;143086518&#34;,&#34;1135472480&#34;,&#34;31936449&#34;,&#34;1081042932&#34;,&#34;29575969&#34;,&#34;18927401&#34;,&#34;31936449&#34;,&#34;2355383844&#34;,&#34;1547838528&#34;,&#34;1455996980&#34;,&#34;454977993&#34;,&#34;37997717&#34;,&#34;562328466&#34;,&#34;20126211&#34;,&#34;115039678&#34;,&#34;115039678&#34;,&#34;115039678&#34;,&#34;18927401&#34;,&#34;885356456&#34;,&#34;1547838528&#34;,&#34;1547838528&#34;,&#34;15276911&#34;,&#34;31936449&#34;,&#34;2482049948&#34;,&#34;37997717&#34;,&#34;1382528755&#34;,&#34;18927401&#34;,&#34;424098004&#34;,&#34;2781296741&#34;,&#34;1192092249137524737&#34;,&#34;1184415367579328513&#34;,&#34;18927401&#34;,&#34;29575969&#34;,&#34;15276911&#34;,&#34;18927401&#34;,&#34;109487723&#34;],&#34;retweets&#34;:[1,1,1,1,0,0,1,1,1,0,13,4,0,1,2,0,2,0,0,1,29,0,0,0,1,0,1,4,1,1,1,1,0,1,0,0,1,0,0,7,0,1,0,0,0,1,1,0,5,1,0,0,1,1,4,3,1,0,11,1,1,0,5,3,0,3,1,1,0,1,0,0,0,6,2,1,0,1,5,0,0,1,2,0,0,1,1,1,0,0,0,0,1,0,11,1,1,7,1,3,0,1,2,0,1,3,1,0,0,1,2,1,0,0,0,0,0,0,0],&#34;favorites&#34;:[5,4,1,8,1,5,6,2,1,1,18,6,1,1,2,3,8,2,1,10,0,3,1,3,2,3,0,2,0,1,1,0,4,1,6,1,0,1,1,0,1,1,11,3,3,1,1,1,12,5,17,1,10,1,1,4,0,5,20,3,2,5,6,5,12,3,1,0,1,1,4,8,1,7,3,1,2,1,17,7,3,1,2,3,1,1,0,2,11,1,1,5,0,1,16,2,3,0,8,7,5,0,13,2,1,8,1,3,1,5,2,1,1,1,1,4,1,6,1],&#34;all&#34;:[6,5,2,9,1,5,7,3,2,1,31,10,1,2,4,3,10,2,1,11,29,3,1,3,3,3,1,6,1,2,2,1,4,2,6,1,1,1,1,7,1,2,11,3,3,2,2,1,17,6,17,1,11,2,5,7,1,5,31,4,3,5,11,8,12,6,2,1,1,2,4,8,1,13,5,2,2,2,22,7,3,2,4,3,1,2,1,3,11,1,1,5,1,1,27,3,4,7,9,10,5,1,15,2,2,11,2,3,1,6,4,2,1,1,1,4,1,6,1],&#34;weight&#34;:[0.193548387096774,0.5,0.181818181818182,0.214285714285714,1,0.0833333333333333,0.14,0.230769230769231,0.333333333333333,0.5,0.151960784313725,0.25,0.333333333333333,0.666666666666667,0.173913043478261,0.375,0.208333333333333,0.4,0.333333333333333,0.150684931506849,0.21969696969697,0.214285714285714,0.142857142857143,0.142857142857143,0.12,0.15,0.5,0.09375,0.333333333333333,0.333333333333333,0.2,0.0909090909090909,0.266666666666667,0.666666666666667,0.315789473684211,0.1,0.25,0.2,0.2,0.14,0.333333333333333,0.285714285714286,0.0846153846153846,0.176470588235294,0.230769230769231,0.222222222222222,0.142857142857143,0.5,0.16504854368932,0.333333333333333,0.195402298850575,0.142857142857143,0.224489795918367,0.285714285714286,0.294117647058824,0.134615384615385,0.166666666666667,0.384615384615385,0.107266435986159,0.285714285714286,0.428571428571429,0.0862068965517241,0.196428571428571,0.571428571428571,0.2,0.428571428571429,0.666666666666667,0.5,0.333333333333333,0.5,0.285714285714286,0.177777777777778,0.333333333333333,0.191176470588235,0.125,0.153846153846154,0.666666666666667,0.4,0.265060240963855,0.411764705882353,0.115384615384615,0.25,0.266666666666667,0.272727272727273,0.125,0.181818181818182,0.2,0.130434782608696,0.458333333333333,0.5,1,0.0862068965517241,0.2,1,0.204545454545455,0.2,0.173913043478261,0.205882352941176,0.173076923076923,0.149253731343284,0.111111111111111,1,0.194805194805195,0.181818181818182,0.4,0.366666666666667,0.285714285714286,0.157894736842105,0.333333333333333,0.15,0.333333333333333,0.125,0.333333333333333,1,0.166666666666667,0.129032258064516,0.2,0.142857142857143,0.166666666666667],&#34;title&#34;:[0.194,0.5,0.182,0.214,1,0.083,0.14,0.231,0.333,0.5,0.152,0.25,0.333,0.667,0.174,0.375,0.208,0.4,0.333,0.151,0.22,0.214,0.143,0.143,0.12,0.15,0.5,0.094,0.333,0.333,0.2,0.091,0.267,0.667,0.316,0.1,0.25,0.2,0.2,0.14,0.333,0.286,0.085,0.176,0.231,0.222,0.143,0.5,0.165,0.333,0.195,0.143,0.224,0.286,0.294,0.135,0.167,0.385,0.107,0.286,0.429,0.086,0.196,0.571,0.2,0.429,0.667,0.5,0.333,0.5,0.286,0.178,0.333,0.191,0.125,0.154,0.667,0.4,0.265,0.412,0.115,0.25,0.267,0.273,0.125,0.182,0.2,0.13,0.458,0.5,1,0.086,0.2,1,0.205,0.2,0.174,0.206,0.173,0.149,0.111,1,0.195,0.182,0.4,0.367,0.286,0.158,0.333,0.15,0.333,0.125,0.333,1,0.167,0.129,0.2,0.143,0.167],&#34;width&#34;:[1.93548387096774,5,1.81818181818182,2.14285714285714,10,0.833333333333333,1.4,2.30769230769231,3.33333333333333,5,1.51960784313725,2.5,3.33333333333333,6.66666666666667,1.73913043478261,3.75,2.08333333333333,4,3.33333333333333,1.50684931506849,2.1969696969697,2.14285714285714,1.42857142857143,1.42857142857143,1.2,1.5,5,0.9375,3.33333333333333,3.33333333333333,2,0.909090909090909,2.66666666666667,6.66666666666667,3.15789473684211,1,2.5,2,2,1.4,3.33333333333333,2.85714285714286,0.846153846153846,1.76470588235294,2.30769230769231,2.22222222222222,1.42857142857143,5,1.6504854368932,3.33333333333333,1.95402298850575,1.42857142857143,2.24489795918367,2.85714285714286,2.94117647058824,1.34615384615385,1.66666666666667,3.84615384615385,1.07266435986159,2.85714285714286,4.28571428571429,0.862068965517241,1.96428571428571,5.71428571428571,2,4.28571428571429,6.66666666666667,5,3.33333333333333,5,2.85714285714286,1.77777777777778,3.33333333333333,1.91176470588235,1.25,1.53846153846154,6.66666666666667,4,2.65060240963855,4.11764705882353,1.15384615384615,2.5,2.66666666666667,2.72727272727273,1.25,1.81818181818182,2,1.30434782608696,4.58333333333333,5,10,0.862068965517241,2,10,2.04545454545455,2,1.73913043478261,2.05882352941176,1.73076923076923,1.49253731343284,1.11111111111111,10,1.94805194805195,1.81818181818182,4,3.66666666666667,2.85714285714286,1.57894736842105,3.33333333333333,1.5,3.33333333333333,1.25,3.33333333333333,10,1.66666666666667,1.29032258064516,2,1.42857142857143,1.66666666666667]},&#34;nodesToDataframe&#34;:true,&#34;edgesToDataframe&#34;:true,&#34;options&#34;:{&#34;width&#34;:&#34;100%&#34;,&#34;height&#34;:&#34;100%&#34;,&#34;nodes&#34;:{&#34;shape&#34;:&#34;dot&#34;},&#34;manipulation&#34;:{&#34;enabled&#34;:false},&#34;edges&#34;:{&#34;arrows&#34;:{&#34;to&#34;:{&#34;enabled&#34;:true,&#34;scaleFactor&#34;:0.5}}}},&#34;groups&#34;:null,&#34;width&#34;:&#34;1000px&#34;,&#34;height&#34;:&#34;800px&#34;,&#34;idselection&#34;:{&#34;enabled&#34;:false},&#34;byselection&#34;:{&#34;enabled&#34;:false},&#34;main&#34;:null,&#34;submain&#34;:null,&#34;footer&#34;:null,&#34;background&#34;:&#34;rgba(0, 0, 0, 0)&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;/div&gt;
&lt;div id=&#34;methods&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Methods&lt;/h3&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Extract tweets/retweet from accounts that have tweeted at least once with the conference hashtag (&lt;code&gt;#gi2019&lt;/code&gt;).
&lt;ul&gt;
&lt;li&gt;Searched for &lt;code&gt;#gi2019&lt;/code&gt;. Extracted accounts when excluding retweets. Kept tweet/retweets from these accounts.&lt;/li&gt;
&lt;li&gt;Easy, the &lt;em&gt;rtweet&lt;/em&gt; package can easily do this type of search.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Extract the recent favorited tweet for these accounts and keep all the ones with the conference hashtag.
&lt;ul&gt;
&lt;li&gt;More laborious because it’s not part of the search results.&lt;/li&gt;
&lt;li&gt;Also there is a limit for the number of query per 15 mins. Had to extract some, wait and repeat.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Make a network with each accounts (node) and the number of times they retweeted/favorited a tweet from someone in the set.
&lt;ul&gt;
&lt;li&gt;For a pair of accounts, I summed the number of retweets and favorited tweets.&lt;/li&gt;
&lt;li&gt;The size of the edges are the relative amount of retweet/favorites for each account, i.e. the proportion of someone’s GI2019 retweets/favorites that went to a particular user.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Look for sub-groups
&lt;ul&gt;
&lt;li&gt;I first tried to keep only one outgoing edge per node: the most retweeted/favorited GI2019 twitter account for each user.&lt;/li&gt;
&lt;li&gt;I also ran some community detection algorithms but the results weren’t very informative (way too many communities, don’t want to dig into them…).&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data&lt;/h3&gt;
&lt;p&gt;I made two TSV files with tweet/retweets and favorites info, available &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/gi2019tweetnetwork&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Workflow Description Language (WDL) in Emacs</title>
          <link>/2019/07/15/workflow-description-language-wdl-in-emacs/</link>
          <pubDate>Mon, 15 Jul 2019 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2019/07/15/workflow-description-language-wdl-in-emacs/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#wdl-mode&#34;&gt;wdl-mode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#poly-wdl&#34;&gt;poly-wdl&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#language-server-protocol&#34;&gt;Language Server Protocol&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#screenshots&#34;&gt;Screenshots&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;I recently started working with &lt;a href=&#34;https://software.broadinstitute.org/wdl/documentation/&#34;&gt;WDL&lt;/a&gt; files.
The Broad Institute recommends using Sublime and the &lt;a href=&#34;https://github.com/broadinstitute/wdl-sublime-syntax-highlighter&#34;&gt;syntax highlighter&lt;/a&gt; that they provide.
They also provide a &lt;a href=&#34;https://github.com/broadinstitute/vim-wdl&#34;&gt;syntax highlighter for Vim&lt;/a&gt;.
&lt;a href=&#34;https://github.com/openwdl/wdl/pull/321#issuecomment-511617350&#34;&gt;As Denis Loginov mentioned&lt;/a&gt;, they are working on an LSP implementation for WDL that could be used by tools to get syntax validation.&lt;/p&gt;
&lt;p&gt;I looked first for a &lt;strong&gt;solution in Emacs&lt;/strong&gt;, my go-to editor.
Luckily there was already a WDL mode available that I just slightly improved.
I also made a polymode to complement it and configured &lt;em&gt;lsp-mode&lt;/em&gt; to use the WDL implementation.
All packages are available through &lt;a href=&#34;https://github.com/melpa/melpa&#34;&gt;MELPA&lt;/a&gt; as &lt;code&gt;wdl-mode&lt;/code&gt;, &lt;code&gt;poly-wdl&lt;/code&gt;, &lt;code&gt;lsp-mode&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Other useful commands include &lt;code&gt;(setq-default indent-tabs-mode nil)&lt;/code&gt; and the &lt;code&gt;whitespace-mode&lt;/code&gt; to ensure consistent indents (see the &lt;a href=&#34;./emacs#for-wdl-workflows&#34;&gt;WDL section of my Emacs page&lt;/a&gt;).&lt;/p&gt;
&lt;div id=&#34;wdl-mode&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;wdl-mode&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&#34;https://github.com/zhanxw/wdl-mode&#34;&gt;wdl-mode package&lt;/a&gt; provides &lt;strong&gt;syntax highlighting and indentation&lt;/strong&gt;.
It was developed by &lt;a href=&#34;https://github.com/zhanxw&#34;&gt;Xiaowei Zhan&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I noticed that the indentation was not triggered in the presence of space(s) after the character that should trigger it (&lt;code&gt;{&lt;/code&gt;, &lt;code&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/code&gt;, &lt;code&gt;}&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;).
Maybe this space is not supposed to be there in the first place.
Still, some the files I was working with (or some of &lt;a href=&#34;https://github.com/DataBiosphere/topmed-workflows/blob/master/variant-caller/variant-caller-wdl/topmed_freeze3_calling.wdl&#34;&gt;TOPMed’s workflows&lt;/a&gt;) had those sometimes.
I think it’s worth catching those, so I modified the package.
It’s now a &lt;a href=&#34;https://github.com/zhanxw/wdl-mode/pull/3&#34;&gt;PR in the main repo&lt;/a&gt;.
If it’s not merged and part of the next version on MELPA, it could always be modified locally (e.g. in the &lt;code&gt;.emacs.d/elpa/wdl-mode*/wdl-mode.el&lt;/code&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;poly-wdl&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;poly-wdl&lt;/h2&gt;
&lt;p&gt;Starting from existing polymodes, I wrote one for WDL.
The goal was to &lt;strong&gt;automatically switch to “&lt;em&gt;shell mode&lt;/em&gt;” in the command chunks&lt;/strong&gt;, mostly to get the appropriate indentation.
The &lt;a href=&#34;https://github.com/jmonlong/poly-wdl&#34;&gt;poly-wdl package&lt;/a&gt; is now in MELPA and I’m glad I got to contribute to MELPA even if just with a simple and field-specific package.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;language-server-protocol&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Language Server Protocol&lt;/h2&gt;
&lt;p&gt;There is an &lt;a href=&#34;https://github.com/broadinstitute/wdl-ide&#34;&gt;LSP implementation for WDL&lt;/a&gt; that can be used by Emacs to provide &lt;strong&gt;syntax validation and (some) auto-completion&lt;/strong&gt;.
It’s still under active development but it seems to work well already.&lt;/p&gt;
&lt;p&gt;To use it in Emacs, the python package providing the server needs to be installed first and Emacs’ &lt;em&gt;lsp-mode&lt;/em&gt; needs to be configured:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install the &lt;a href=&#34;https://pypi.org/project/wdl-lsp/&#34;&gt;LSP server for WDL&lt;/a&gt;: &lt;code&gt;pip install wdl-lsp&lt;/code&gt; (or &lt;code&gt;pip3&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Install packages through MELPA: &lt;code&gt;lsp-mode&lt;/code&gt;, &lt;code&gt;lsp-ui&lt;/code&gt; and &lt;code&gt;company-lsp&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Add to &lt;code&gt;.emacs&lt;/code&gt; file:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;lisp&#34;&gt;&lt;code&gt;(require &amp;#39;lsp-mode)
(add-to-list &amp;#39;lsp-language-id-configuration &amp;#39;(wdl-mode . &amp;quot;wdl&amp;quot;))
(defgroup lsp-wdl nil
  &amp;quot;LSP support for WDL.&amp;quot;
  :group &amp;#39;lsp-mode
  :link &amp;#39;(url-link &amp;quot;https://github.com/broadinstitute/wdl-ide&amp;quot;))
(defcustom lsp-wdl-server-command &amp;quot;wdl-lsp&amp;quot;
  &amp;quot;Command to start wdl-lsp.&amp;quot;
  :group &amp;#39;lsp-wdl
  :risky t
  :type &amp;#39;file)
(lsp-register-client
 (make-lsp-client :new-connection (lsp-stdio-connection
                                   (lambda () lsp-wdl-server-command))
                  :major-modes &amp;#39;(wdl-mode)
                  :priority -1
                  :server-id &amp;#39;wdl))
(add-hook &amp;#39;wdl-mode-hook #&amp;#39;lsp)
;; Syntax validation interface
(require &amp;#39;lsp-ui)
(add-hook &amp;#39;lsp-mode-hook &amp;#39;lsp-ui-mode)
(setq lsp-ui-sideline-enable nil)
;; To get some auto-completion
(require &amp;#39;company-lsp)
(push &amp;#39;company-lsp company-backends)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note: The first time a file is opened, the package will ask what is the root of the project.
I use the folder that contains the WDL file because I don’t think project structures are integrated at this point.
This can be changed at any time using &lt;code&gt;M-x lsp-workspace-folders-remove&lt;/code&gt; and &lt;code&gt;M-x lsp-workspace-folders-add&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;screenshots&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Screenshots&lt;/h2&gt;
&lt;p&gt;As an example, here is part of a TOPMed workflow for read alignment &lt;a href=&#34;https://github.com/DataBiosphere/topmed-workflows/blob/master/aligner/u_of_michigan_aligner/u_of_michigan_aligner.wdl&#34;&gt;available here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;I removed empty lines and some comments to make it more compact.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./imgs/emacs-wdl-ex.png&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;em&gt;Syntax validation (error message at the bottom)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./imgs/emacs-wdl-ex-validation.png&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;em&gt;Auto-completion&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./imgs/emacs-wdl-ex-autocomp.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Cancer genes and CNA hotspots</title>
          <link>/2019/04/03/cancer-genes-cna-r/</link>
          <pubDate>Wed, 03 Apr 2019 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2019/04/03/cancer-genes-cna-r/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#candidate-cancer-gene-database-ccgd&#34;&gt;Candidate Cancer Gene Database (CCGD)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#cancer-gene-census&#34;&gt;Cancer Gene Census&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#merge-the-gene-lists&#34;&gt;Merge the gene lists&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#effect-vs-role&#34;&gt;“Effect” vs “Role” ?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#known-cna-hotspots&#34;&gt;Known CNA hotspots&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#saving-the-r-objects&#34;&gt;Saving the R objects&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;This is an updated version of an old private post where I had prepared some R objects with cancer genes and CNA hotspots.
I used this to quickly annotate copy number results in cancer projects.
The file was almost 3 years old so here is an updated version (as of today, Apr 3 2019).&lt;/p&gt;
&lt;div id=&#34;candidate-cancer-gene-database-ccgd&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Candidate Cancer Gene Database (CCGD)&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;The &lt;a href=&#34;http://ccgd-starrlab.oit.umn.edu/about.php&#34;&gt;Candidate Cancer Gene Database (CCGD)&lt;/a&gt; was developed to disseminate the results of transposon-based forward genetic screens in mice that identify candidate cancer genes.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I downloaded the version available on Apr 3 2019.
There is information about each study that reports a gene as a cancer driver.
I’m mostly interested about the list of cancer driver.
As a secondary information, I will save the cancer type(s) and the predicted effect for each gene.&lt;/p&gt;
&lt;p&gt;For each study, the predicted effect is either &lt;em&gt;Not Determined&lt;/em&gt;, &lt;em&gt;Gain&lt;/em&gt; or &lt;em&gt;Loss&lt;/em&gt;.
I define an &lt;em&gt;effect&lt;/em&gt; field with the major “determined” effect.
The &lt;em&gt;effects&lt;/em&gt; column contains all the predicted effect with the number of supporting studies.
It looks like this:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;effect&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;effects&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ABCD3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(3),Gain(1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ADAM19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Gain(1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAK1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(6),Loss(1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ABHD2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(7),Loss(1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A1CF&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(3)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A4GALT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(1)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In total, there are 9488 cancer driver genes in this list.
For most of them we don’t know the effect.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;effect&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gene&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8141&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1151&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;196&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;cancer-gene-census&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Cancer Gene Census&lt;/h2&gt;
&lt;p&gt;The gene list can be downloaded from the &lt;a href=&#34;https://cancer.sanger.ac.uk/cosmic/download&#34;&gt;COSMIC website&lt;/a&gt;.
The user must register and login to download.
I’m using version 88 on GRCh38.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The cancer Gene Census is an ongoing effort to catalogue those genes for which mutations have been causally implicated in cancer. The original census and analysis was published in &lt;a href=&#34;http://www.nature.com/nrc/journal/v4/n3/abs/nrc1299.html&#34;&gt;Nature Reviews Cancer&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Here the genes are either &lt;em&gt;oncogene&lt;/em&gt;, &lt;em&gt;TSG&lt;/em&gt; or &lt;em&gt;fusion&lt;/em&gt; (or a combination of those).
I’ll also save the tumor types where somatic mutations were observed.
It looks like this:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;role&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;cgcTumor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A1CF&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;melanoma&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ABI1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TSG, fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AML&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ABL1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CML, ALL, T-ALL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ABL2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AML&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACKR3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;lipoma&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACSL3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;prostate&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In total, there are 723 cancer driver genes in this list.
The role are distributed as follows:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;role&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gene&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;363&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;oncogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;315&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TSG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;315&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;merge-the-gene-lists&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Merge the gene lists&lt;/h2&gt;
&lt;p&gt;I merged the two gene lists into a &lt;em&gt;driver.genes&lt;/em&gt; data.frame:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;effect&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;effects&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ccgdTumor&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;role&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;cgcTumor&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ccgd&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;cgc&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACKR3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;lipoma&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACSL3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;prostate&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A4GALT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(1)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Blood Cancer&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(1)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Colorectal Cancer&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A1CF&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(3)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Liver Cancer&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;melanoma&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACSL6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Not Determined(2)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Blood Cancer&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AML, AEL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div id=&#34;effect-vs-role&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;“Effect” vs “Role” ?&lt;/h3&gt;
&lt;p&gt;I would expect a &lt;em&gt;loss&lt;/em&gt; for a &lt;em&gt;tumor suppressor&lt;/em&gt;, and a &lt;em&gt;gain&lt;/em&gt; of function for &lt;em&gt;oncogenes&lt;/em&gt;.
Are the two databases consistent ?&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;effect&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;role&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gene&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TSG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;42&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TSG, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, TSG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, TSG, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TSG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Loss&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, TSG, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TSG, fusion&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gain&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oncogene, TSG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Kind of:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Most of the &lt;em&gt;Loss&lt;/em&gt; effects are &lt;em&gt;TSG&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Most of the &lt;em&gt;Gain&lt;/em&gt; effects are &lt;em&gt;oncogene&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;However several &lt;em&gt;Loss&lt;/em&gt; are also &lt;em&gt;oncogene&lt;/em&gt;, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;known-cna-hotspots&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Known CNA hotspots&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://www.nature.com/ng/journal/v45/n10/full/ng.2760.html&#34;&gt;Zack et al&lt;/a&gt; identified hotspots of somatic CNA from ~5,000 tumors across 11 cancer types.
They called CNA from the SNP-array in TCGA.
I downloaded Supp Table 2, the pan-cancer regions of significant somatic CNA, and cleaned up the &lt;em&gt;xls&lt;/em&gt; file into a &lt;em&gt;csv&lt;/em&gt; file.&lt;/p&gt;
&lt;p&gt;In total there are 140 CNA hotspots.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;region&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;gain&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;loss&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Caution: this is hg19!&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;saving-the-r-objects&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Saving the R objects&lt;/h2&gt;
&lt;p&gt;I saved the &lt;em&gt;driver.genes&lt;/em&gt; data.frame and the &lt;em&gt;cna.zack.hg19.gr&lt;/em&gt; GRanges object into a &lt;code&gt;.RData&lt;/code&gt; file .
It’s available &lt;a href=&#34;https://dl.dropboxusercontent.com/s/kayue1w92no4nz4/cancerDriverGenes.RData?dl=0&#34;&gt;there&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>First look at the gnomAD SV catalog</title>
          <link>/2019/03/31/gnomad-sv-first-look/</link>
          <pubDate>Sun, 31 Mar 2019 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2019/03/31/gnomad-sv-first-look/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#tldr&#34;&gt;TL;DR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#sv-types&#34;&gt;SV types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#detection-methods&#34;&gt;Detection methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#allele-frequency&#34;&gt;Allele frequency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#size-distribution&#34;&gt;Size distribution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#sv-coordinates-confusion&#34;&gt;SV coordinates confusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#potential-duplicates&#34;&gt;Potential duplicates&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#sv-calling-method&#34;&gt;SV calling method&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#two-size-clusters-of-potentially-duplicated-complex-variants&#34;&gt;Two size clusters of potentially duplicated complex variants&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#effect-on-allele-frequency-estimates&#34;&gt;Effect on allele frequency estimates&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#giab-comparison-to-investigate-sequence-resolution&#34;&gt;GiaB comparison to investigate sequence resolution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#chr2-and-end&#34;&gt;CHR2 and END&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Edit April 1 2019: I added columns with the proportion of variants with PASS filter in the tables about the END/POS confusion and duplicated variants.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Edit September 23 2019: Some tables (SV types, methods), investigation of the inconsistent CHR2/END for a few SVs.&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;The recent gnomAD-SV catalog is potentially a great resource that we could use to annotate SV calls or augment genome graphs with.
For now there is a &lt;a href=&#34;https://www.biorxiv.org/content/10.1101/578674v1&#34;&gt;preprint on bioRxiv&lt;/a&gt; and a &lt;a href=&#34;https://macarthurlab.org/2019/03/20/structural-variants-in-gnomad/&#34;&gt;comprehensive blog post&lt;/a&gt; that explains how the SVs were called and how to use the catalog.&lt;/p&gt;
&lt;p&gt;I had a quick look at these variants and here are my observations/notes.
I’m using the following VCF file from the gnomAD download page: &lt;a href=&#34;https://storage.googleapis.com/gnomad-public/papers/2019-sv/gnomad_v2_sv.sites.vcf.gz&#34;&gt;gnomad_v2_sv.sites.vcf.gz&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;tldr&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;TL;DR&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The vast majority of SVs look good and there is a lot of information in the VCF.&lt;/li&gt;
&lt;li&gt;Some insertions and complex variants have contradicting POS/END fields (not sure what to do with those).&lt;/li&gt;
&lt;li&gt;Thousands of SVs are so similar that they could be the same SVs that weren’t merged.&lt;/li&gt;
&lt;li&gt;In a few cases, duplicates might lead to under-estimating the allele frequency.&lt;/li&gt;
&lt;li&gt;Take-home message: don’t annotate SVs using only the best matching SV in gnomAD.&lt;/li&gt;
&lt;li&gt;Most likely, the majority of variants are not really sequence-resolved (like in most SV catalogs).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;sv-types&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;SV types&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;SVTYPE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;199,498&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;115,407&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BND&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72,411&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51,428&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,249&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MCNV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,148&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;707&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CTX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;detection-methods&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Detection methods&lt;/h2&gt;
&lt;p&gt;How many variants are supported by each method, for each SV type:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;method&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;BND&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;CPX&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;CTX&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;DEL&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;DUP&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;INS&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;INV&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MCNV&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;delly&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46,210&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,050&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;122,492&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24,669&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,360&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;685&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;depth&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38,102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21,607&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;948&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31,510&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,516&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75,089&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22,809&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31,222&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;181&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;77&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;melt&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83,420&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note: the same variant is counted several times in this table if it is supported by multiple methods.&lt;/p&gt;
&lt;p&gt;Interesting to see that MELT supports a few duplications (are they MEI close to an existing TE?) and that read depth changes support a few insertions (maybe some very recent MEI?).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;allele-frequency&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Allele frequency&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;AF field: sometimes one value (when biallelic), sometimes multiple values.&lt;/li&gt;
&lt;li&gt;Only MCNVs contain multiple AF values (one for each copy number).&lt;/li&gt;
&lt;li&gt;All MCNVs have a &lt;em&gt;CN=2&lt;/em&gt; allele.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I want one value of allele frequency per variant so I sum up the AF values across alleles excluding the &lt;em&gt;CN=2&lt;/em&gt; allele for MCNVs.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/af-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;size-distribution&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Size distribution&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/size-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/size-2.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/size-3.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/size-4.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The &lt;strong&gt;peak at 5 kbp is a bit puzzling&lt;/strong&gt;.
Maybe it’s a technical artifact, e.g. due to a method that detects &lt;em&gt;DEL&lt;/em&gt;/&lt;em&gt;DUP&lt;/em&gt; only down to 5 kbp.
Looking at the variants with absolute &lt;em&gt;SVLEN&lt;/em&gt; of exactly 5 kbp:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;methods&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;depth&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;delly_depth&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;delly&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;delly_depth_manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It’s most likely an artifact of the &lt;em&gt;depth&lt;/em&gt; algorithm.
Does it affect the allele frequency distribution?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/meths-5kbp-af-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The tail of the distribution is longer in the 5-6 kbp class.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;sv-coordinates-confusion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;SV coordinates confusion&lt;/h2&gt;
&lt;p&gt;It seems like the &lt;strong&gt;&lt;em&gt;END&lt;/em&gt; value is not always larger than the position &lt;em&gt;POS&lt;/em&gt;&lt;/strong&gt; in the VCF.
Most of it comes from &lt;em&gt;CTX&lt;/em&gt; (reciprocal chromosomal translocation) variants or translocations which makes sense: the END might relate to the second breakpoint, potentially anywhere in the genome.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;SVTYPE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;end.before.pos&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;prop&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;prop.PASS&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;358&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0031&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9973&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;289&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0551&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9737&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BND&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CTX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6667&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8833&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9772&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9986&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MCNV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Some are insertions and I’m not sure how to interpret them.
The vast majority of these variants have a &lt;em&gt;PASS&lt;/em&gt; filter.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/ins-end-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For most of these insertions the &lt;em&gt;END&lt;/em&gt; is not that far from the &lt;em&gt;POS&lt;/em&gt; (&amp;lt;100bp) but &lt;strong&gt;for some the &lt;em&gt;END&lt;/em&gt; and &lt;em&gt;POS&lt;/em&gt; are hundreds of kbp apart&lt;/strong&gt;.
Hum.
Let’s have a look at some of those:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## GRanges object with 3 ranges and 13 metadata columns:
##                         seqnames                 ranges strand |
##                            &amp;lt;Rle&amp;gt;              &amp;lt;IRanges&amp;gt;  &amp;lt;Rle&amp;gt; |
##   gnomAD_v2_INS_4_34681        4 [116015282, 116015282]      * |
##   gnomAD_v2_INS_2_13594        2 [ 85885163,  85885163]      * |
##   gnomAD_v2_INS_9_69619        9 [ 28199346,  28199346]      * |
##                         paramRangeID            REF             ALT
##                             &amp;lt;factor&amp;gt; &amp;lt;DNAStringSet&amp;gt; &amp;lt;CharacterList&amp;gt;
##   gnomAD_v2_INS_4_34681         &amp;lt;NA&amp;gt;              N    &amp;lt;INS:ME:ALU&amp;gt;
##   gnomAD_v2_INS_2_13594         &amp;lt;NA&amp;gt;              N    &amp;lt;INS:ME:ALU&amp;gt;
##   gnomAD_v2_INS_9_69619         &amp;lt;NA&amp;gt;              N           &amp;lt;INS&amp;gt;
##                              QUAL      FILTER      SVTYPE     SVLEN
##                         &amp;lt;numeric&amp;gt; &amp;lt;character&amp;gt; &amp;lt;character&amp;gt; &amp;lt;integer&amp;gt;
##   gnomAD_v2_INS_4_34681       646        PASS         INS       281
##   gnomAD_v2_INS_2_13594       652        PASS         INS       279
##   gnomAD_v2_INS_9_69619       407        PASS         INS       136
##                               END        CHR2    CPX_TYPE          methods
##                         &amp;lt;integer&amp;gt; &amp;lt;character&amp;gt; &amp;lt;character&amp;gt;      &amp;lt;character&amp;gt;
##   gnomAD_v2_INS_4_34681  44565090           4        &amp;lt;NA&amp;gt; delly_manta_melt
##   gnomAD_v2_INS_2_13594   8372664           2        &amp;lt;NA&amp;gt; delly_manta_melt
##   gnomAD_v2_INS_9_69619  17898584           9        &amp;lt;NA&amp;gt;      delly_manta
##                                            ID        AF
##                                   &amp;lt;character&amp;gt; &amp;lt;numeric&amp;gt;
##   gnomAD_v2_INS_4_34681 gnomAD_v2_INS_4_34681  0.001490
##   gnomAD_v2_INS_2_13594 gnomAD_v2_INS_2_13594  0.005355
##   gnomAD_v2_INS_9_69619 gnomAD_v2_INS_9_69619  0.057464
##   -------
##   seqinfo: 24 sequences from an unspecified genome&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I don’t see anything else suspicious.&lt;/p&gt;
&lt;p&gt;For complex variants, the &lt;em&gt;POS&lt;/em&gt; and &lt;em&gt;END&lt;/em&gt; are always less than 100 bp apart and all for one type of complex SV: &lt;strong&gt;“dispersed duplications”&lt;/strong&gt;.
If I understand correctly, this type of complex SV is pretty much an insertion of a sequence already in the genome (but not a transposable element I guess?).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/cpx-end-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;I’m not sure how to interpret them either.&lt;/p&gt;
&lt;p&gt;For now, I’ll use the &lt;strong&gt;POS field for both insertions and dispersed duplications&lt;/strong&gt; when manipulating the variants as genomic intervals.
So I’ll assume that they are both simple insertions (which I think is fair enough).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;potential-duplicates&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Potential duplicates&lt;/h2&gt;
&lt;p&gt;Are there any pairs of variants with a &lt;strong&gt;reciprocal overlap higher than 90%&lt;/strong&gt;?
For insertions, I match them if they are located at less than 30 bp from each other and their size is 90% similar.&lt;/p&gt;
&lt;p&gt;Note: Here I don’t consider &lt;em&gt;BND&lt;/em&gt; or &lt;em&gt;CTX&lt;/em&gt; variants, and I count each pair of variants only once.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;types&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;prop.both.PASS&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,335&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8237&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS_INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,221&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9955&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_DUP&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,057&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9728&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,077&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0529&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DUP&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;797&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8821&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;253&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9921&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_MCNV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;117&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_DUP&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9091&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_MCNV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INV_INV&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;There are &lt;strong&gt;thousands of deletions, insertions and duplications with high reciprocal overlap.&lt;/strong&gt;
Also many complex variants but I can imagine that it’s difficult to merge those.
For the vast majority of pairs, both variants have a &lt;em&gt;PASS&lt;/em&gt; filter.
However, for most of the complex variants duplicates, one of the variant doesn’t have a PASS filter.
&lt;strong&gt;Using &lt;em&gt;FILTER==PASS&lt;/em&gt; would remove almost all the complex SV duplicates.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Let’s look at the size distribution of these potential duplicates.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-size-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Wow, very “peaky”.
Let’s zoom in with no log-scale:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-peaks-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-peaks-2.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-peaks-3.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The “Alu” peak around 300 bp is made of around 200 insertion pairs.&lt;/li&gt;
&lt;li&gt;The “L1” peak around 6 kbp is made of around 30 insertion pairs and almost as many duplication pairs.&lt;/li&gt;
&lt;li&gt;Again the technical peak at 5 kbp, here mostly pairs of deletions.&lt;/li&gt;
&lt;li&gt;The complex variants that are potentially duplicated form two size clusters.&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;sv-calling-method&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;SV calling method&lt;/h3&gt;
&lt;p&gt;Duplicates can occur when merging two sets of variants, for example the call sets of different methods.
&lt;strong&gt;Are the potential duplicates from different methods?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Top 10 of the most common pairs:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;types&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;methods&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;prop.both.PASS&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS_INS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;manta__manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,639&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9969&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DEL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6009&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DEL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;manta__manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;652&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9417&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_DUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9688&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;528&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0436&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS_INS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;melt__melt&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9918&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_DUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;manta__manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9842&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;depth__depth&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;395&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8785&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DUP_DUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;376&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9787&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL_DEL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__manta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;319&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9310&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;For thousands of potential duplicates the variants were called by the same algorithm.&lt;/strong&gt;
The question is then: were these methods run once in a “single-sample” mode or on all the samples together?
I think at least Delly and MELT can do the genotyping step across all samples together.
Even in those, there can be duplicates in the discovery phase that are not merged properly before genotyping.&lt;/p&gt;
&lt;p&gt;I’m still not sure if these deletions/duplications/MEIs are actually different SVs.
Especially the mobile element insertions, I would lean toward them being duplicates.
Otherwise, it means the TE jumped and then got an indel later.
It’s possible but maybe not that often.
Also, the comparison with GiaB below shows that we are not there yet in term of bp resolution.
&lt;strong&gt;It might be safer to assume these variants are duplicates.&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;two-size-clusters-of-potentially-duplicated-complex-variants&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Two size clusters of potentially duplicated complex variants&lt;/h3&gt;
&lt;p&gt;The vast majority of the complex SV duplicates would disappear if we were filtering variants with &lt;em&gt;FILTER=PASS&lt;/em&gt;.
I’m still curious about the fact that two groups of potentially duplicated complex variants clustered by size.
Defining size clusters 1 and 2 for the complex variants of sizes around 120 kbp and 160 kbp, respectively.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-cpx-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Some do cluster together in the genome and, looking up a few of them, they seem to be in segmental duplications.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;chr&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;types&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;methods&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;coord&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&amp;amp;position=chr7:64296630-64416847&#34;&gt;7:64296630-64416847&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&amp;amp;position=chr11:4253841-4360790&#34;&gt;11:4253841-4360790&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&amp;amp;position=chr12:9556527-9723033&#34;&gt;12:9556527-9723033&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&amp;amp;position=chr14:106040016-106164465&#34;&gt;14:106040016-106164465&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX_CPX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;delly__delly_manta&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&amp;amp;position=chr16:33350710-33513016&#34;&gt;16:33350710-33513016&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;effect-on-allele-frequency-estimates&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Effect on allele frequency estimates&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;What is the potential effect of these duplicated variants on the frequency annotation?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Below, I compare the allele frequencies of each variant and its potential duplicate.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-af-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Most pairs of potential duplicates have similar frequencies.&lt;/strong&gt;
Does that mean that the frequencies of these variants are supposed to be the double of what we have?&lt;/p&gt;
&lt;p&gt;Let’s zoom in to the long tail with the highest difference in allele frequency.
To make the graph clearer, I compare the lowest frequency to the highest.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/dups-af-scatter-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some SVs with low frequencies might be a duplicate of a SV with higher frequency.&lt;/li&gt;
&lt;li&gt;E.g. 827 of these variants have AF&amp;lt;0.1% while the other variant has AF&amp;gt;1%.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Although it’s only a minority of cases, &lt;strong&gt;we should be careful when matching our SVs to this catalog.&lt;/strong&gt;
Otherwise we might think that a variant is rarer than it is.
Instead of annotating a SV with the allele frequency of the most similar SV in gnomAD-SV, a more robust strategy would be to use the maximum frequency across all SVs that are similar enough.
That’s what we had done when annotating CNVs in our &lt;a href=&#34;https://doi.org/10.1371/journal.pgen.1007285&#34;&gt;epilepsy study&lt;/a&gt;, although we were being maybe too conservative by considering any overlapping SV.
For short deletions it’s fine, but in general something like &lt;em&gt;reciprocal overlap &amp;gt; XX%&lt;/em&gt; would be less conservative.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;giab-comparison-to-investigate-sequence-resolution&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;GiaB comparison to investigate sequence resolution&lt;/h2&gt;
&lt;p&gt;The Genome in a Bottle consortium combined many types of techonologies (ultra deep short-read, linked-reads, long reads, optical mapping) to generate a &lt;strong&gt;high-quality SV catalog&lt;/strong&gt;.
Maybe not all variants are correct but it’s one of the best quality catalog we have.
I want to quickly compare these SVs with the ones in the gnomAD catalog.
If many variants look exactly the same in both datasets, it would be good evidence that they are both sequence-resolved.&lt;/p&gt;
&lt;p&gt;I downloaded the &lt;a href=&#34;ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis/NIST_SVs_Integration_v0.6/&#34;&gt;NIST SVs Integration v0.6&lt;/a&gt;.
This catalog also uses GRCh37.
It includes short indels that I decided to filter out, keeping only variants of size 50 bp or more.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;SVTYPE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean.bp&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min.bp&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max.bp&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14,588&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,715&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;997,115&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15,432&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;595&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;125,187&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I’m curious to compare the exact breakpoint locations of SVs shared by both catalogs.
Do they have exactly the same breakpoints/sequence?
To make things easier let’s just look at deletions.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/giab-del-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Many deletions in the gnomAD catalog are &lt;strong&gt;extremely similar&lt;/strong&gt; to the GiaB dataset &lt;strong&gt;but not exactly the same&lt;/strong&gt;.
Some examples (randomly selected):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;seqnames&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;start&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;end&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;SVTYPE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;SVLEN&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;catalog&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93541818&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93542540&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;720&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93541816&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93542539&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;723&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34523655&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34525720&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2065&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34523656&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34525719&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2063&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;X&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70424308&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70430224&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5916&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;X&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70424367&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70430283&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5916&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96500161&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96503043&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2882&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96500163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96503042&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2879&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83125959&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83127570&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1611&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83125976&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83127569&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1593&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69255776&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69256518&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;742&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GiaB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69255779&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69256517&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DEL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;738&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;gnomAD&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This quick comparison suggests that the variants are not really sequence-resolved.
&lt;strong&gt;In gnomAD, the GiaB dataset, or both, the breakpoints might have a few errors.&lt;/strong&gt;
That will be important when genotyping these SVs or injecting them in genome graphs.&lt;/p&gt;
&lt;p&gt;Of note, I’m not sure if the variants were left-aligned.
In this case it wouldn’t make a big difference because we see that the deletions are discordant in term of size also.
Still, ideally both VCF should be normalized first to better estimate how many deletions are exactly matched.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;chr2-and-end&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;CHR2 and END&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;CHR2&lt;/em&gt; is supposed to be the “Chromosome for END coordinate”.
However I noticed that it might not be the case sometimes.
For example, when &lt;em&gt;CHR2&lt;/em&gt; is different from &lt;em&gt;#CHROM&lt;/em&gt; but the &lt;em&gt;END&lt;/em&gt; is very close to the variant’s position.
In those cases it might be that the &lt;em&gt;END&lt;/em&gt; was set to the position in the &lt;em&gt;#CHROM&lt;/em&gt;/&lt;em&gt;POS&lt;/em&gt; side, like for insertions for example.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2019-03-31-gnomadSV_files/figure-html/chr2end-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;filter.pass&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;SVTYPE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pos.equal.end&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pos.20bp.end&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BND&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21,079&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21,079&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CPX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;INS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CTX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It happens a lot (the y-axis is log-scale) but mostly in variants without a &lt;em&gt;FILTER=PASS&lt;/em&gt;.
Just a few dozens variants with &lt;em&gt;FILTER=PASS&lt;/em&gt; may have a problem with their &lt;em&gt;CHR2&lt;/em&gt; or &lt;em&gt;END&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Some examples:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;##   seqnames    start      end width strand paramRangeID REF   ALT QUAL
## 1        1  8620717  8620717     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;INS&amp;gt;  999
## 2        1  9121444  9121444     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;CPX&amp;gt;  331
## 3        1 23636591 23636591     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;CPX&amp;gt;  330
## 4        1 30893626 30893626     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;INS&amp;gt;  534
## 5        1 59880893 59880893     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;INS&amp;gt;  351
## 6        1 66188203 66188203     1      *         &amp;lt;NA&amp;gt;   N &amp;lt;INS&amp;gt;  175
##   FILTER SVTYPE SVLEN      END CHR2 CPX_TYPE methods                   ID
## 1   PASS    INS   277  8620717   22     &amp;lt;NA&amp;gt;   manta  gnomAD_v2_INS_1_295
## 2   PASS    CPX   718  9121444   14     dDUP   manta   gnomAD_v2_CPX_1_20
## 3   PASS    CPX   270 23636591    2     dDUP   manta   gnomAD_v2_CPX_1_57
## 4   PASS    INS   172 30893626    X     &amp;lt;NA&amp;gt;   manta gnomAD_v2_INS_1_1114
## 5   PASS    INS   340 59880893    2     &amp;lt;NA&amp;gt;   manta gnomAD_v2_INS_1_2293
## 6   PASS    INS   344 66188203    7     &amp;lt;NA&amp;gt;   manta gnomAD_v2_INS_1_2601
##         AF
## 1 0.000047
## 2 0.225787
## 3 0.000047
## 4 0.001762
## 5 0.001261
## 6 0.000047&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Artistic representation of DNA tests&#39; results</title>
          <link>/2018/12/08/dna-art/</link>
          <pubDate>Sat, 08 Dec 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/12/08/dna-art/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#version-1-tree&#34;&gt;Version 1: Tree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#version-2-weave&#34;&gt;Version 2: Weave&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#version-3-noise&#34;&gt;Version 3: Noise&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#version-4-stars&#34;&gt;Version 4: Stars&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#gallery&#34;&gt;Gallery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#code&#34;&gt;Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#notes&#34;&gt;Notes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;Christmas is coming. DNA tests are cool gifts but I’ve already offered it to some members of my family before. Now I was wondering if I could use this data in a more creative way and produce some kind of artistic representation of the DNA data to give them for Christmas. Some kind of DNA art or painting that would be unique.&lt;/p&gt;
&lt;p&gt;Surprisingly, I didn’t find much on the internet for something like this. I expected some people to have already tried considering the success of 23andMe, Ancestry etc. &lt;a href=&#34;https://www.dotone.io/&#34;&gt;One company&lt;/a&gt; sells scarves with motives generated from selected variants with associated traits (eye color, etc). Others were just printing &lt;a href=&#34;https://www.dna11.com/dna-images-gallery&#34;&gt;photos of gels&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So I started tinkering a script around a year ago and now it feel like a good time to stop and put it out there. First, I’ve long passed the peak of excitement/inspiration. And second, I used the script a couple of month ago for a friend’s birthday present and I think it turned out OK. So here it is, my attempt at DNA art…&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;After getting some feedback from friends, I ended up implementing &lt;strong&gt;four different versions&lt;/strong&gt;: tree, weave, noise, and stars. Each time, the DNA is used to create a background or some kind of mesh that, by itself, is not that amazing but could be combined with some photo edition to create cool images.&lt;/p&gt;
&lt;div id=&#34;version-1-tree&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Version 1: Tree&lt;/h2&gt;
&lt;p&gt;The first idea was to represent how unique is the person. Each fork represents a mutation with three “options”: homozygous for the common allele, heterozygous, or homozygous for the rare allele. The complete tree would be huge and this version represents just the branch/path followed by that person. The image is unique because the “chances” to go though the same path (same choices at each fork) are extremely low. At least that’s what I wanted to communicate.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/dnart/cartoon1.jpg&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;version-2-weave&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Version 2: Weave&lt;/h2&gt;
&lt;p&gt;Very similar to version 1 but with a thicker path/fork so that it covers more surface. This is better suited to use as a mask for a photo, while the first version worked mostly when combining with simple “texture” images.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/dnart/cartoon2.jpg&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;version-3-noise&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Version 3: Noise&lt;/h2&gt;
&lt;p&gt;Here the goal was to create some kind of pixel noise based on the DNA data and see if larger patterns would arise. Each variant is represented as a pixel whose size depends on the genotype: no pixel if homozygous for the common allele; small pixel if heterozygous; large pixel if homozygous for the rare allele.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/dnart/cartoon3.jpg&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;version-4-stars&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Version 4: Stars&lt;/h2&gt;
&lt;p&gt;Finally, variants are represented as points whose size depends on the genotype. Similar to the previous version: no point if homozygous for the common allele; small point if heterozygous; large point if homozygous for the rare allele. We can then make these points look like stars and combine with some other space images.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/dnart/cartoon4.jpg&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;gallery&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Gallery&lt;/h2&gt;
&lt;p&gt;A couple of example of each version (or see &lt;a href=&#34;https://flic.kr/s/aHskKjn4w6&#34;&gt;album on Flickr&lt;/a&gt;) :&lt;/p&gt;
&lt;a data-flickr-embed=&#34;true&#34; data-footer=&#34;true&#34;  href=&#34;https://www.flickr.com/photos/137419613@N08/albums/72157674331904837&#34; title=&#34;DNArt&#34;&gt;&lt;img src=&#34;https://farm5.staticflickr.com/4863/46186328172_32c8630662.jpg&#34; width=&#34;900&#34; height=&#34;600&#34; alt=&#34;DNArt&#34;&gt;&lt;/a&gt;
&lt;script async src=&#34;//embedr.flickr.com/assets/client-code.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;div id=&#34;code&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Code&lt;/h2&gt;
&lt;p&gt;The scripts and some basic GIMP instructions are &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/python/dnart&#34;&gt;available on GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;notes&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Notes&lt;/h2&gt;
&lt;p&gt;I didn’t think about that at first but there are so many variants that we don’t see much if we use all of them and print on a reasonable surface (having an entire wall covered with this would cool though). My solution was to pack variants and represent these packs with a special symbol. For example, draw 200 variants, then pack the next 10K, draw 200 variants, …&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/dnart/cartoon1-pack.jpg&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;We could imagine these packs as nucleosomes, the DNA packing system. It could also be something more poetic like galaxies in the stars representation, or imagining the tree branch looping in a third dimension for version 1.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;I used the frequency of the variant in the 1000GP to find out which allele is common vs rare. I like the idea of the brighter stars representing rare things about the person.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Speeding up blogdown/Pandoc for large bibliography</title>
          <link>/2018/11/17/speedup-blogwdown-pandoc-large-bibliography/</link>
          <pubDate>Sat, 17 Nov 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/11/17/speedup-blogwdown-pandoc-large-bibliography/</guid>
          <description>


&lt;p&gt;I have another website where I write down my reviews of the papers I read.
To handle citations in pages and posts, I was originally using &lt;a href=&#34;https://github.com/inukshuk/jekyll-scholar&#34;&gt;jekyll-scholar&lt;/a&gt;.
It scales well enough that I could have &lt;strong&gt;one main BibTeX file for all the pages&lt;/strong&gt; of the website.
I’m now switching to &lt;a href=&#34;https://bookdown.org/yihui/blogdown/&#34;&gt;blogdown&lt;/a&gt;/&lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt; because it’s apparently faster, with less dependencies, but most importantly because it’s very easy to integrate R code with RMarkdown.
To use citations in blogdown, we can specify the BibTeX file in the YAML header and then use either &lt;code&gt;@blabla&lt;/code&gt; or &lt;code&gt;[@blabla]&lt;/code&gt; in the text (for multiple citations: &lt;code&gt;[@blabla;@foo]&lt;/code&gt;).
In the YAML header:&lt;/p&gt;
&lt;pre class=&#34;yaml&#34;&gt;&lt;code&gt;bibliography: [../../static/library.bib]
link-citations: true&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It seemed to work well at first but after adding more pages &lt;strong&gt;the rendering got stuck&lt;/strong&gt;.
Googling around, it seemed to be a &lt;a href=&#34;https://stackoverflow.com/questions/16223019/pandoc-performs-very-slowly-when-referencing-large-biblatex-file&#34;&gt;known issue for pandoc-citation and large bibliography&lt;/a&gt;, the solution being to use a bib file as small as possible by keeping only the records cited.
Surprisingly this didn’t fix my problem and now even with a tiny BibTeX file I couldn’t render some pages.
It turned out that &lt;strong&gt;the problem was the very long author list&lt;/strong&gt; in some citations, which is common in the genomics field.
So the solution for me was to keep only the records cited AND set a maximum number of authors.&lt;/p&gt;
&lt;p&gt;I wrote a small &lt;strong&gt;Python script&lt;/strong&gt; that scans Markdown files for citations and extract them from a BibTeX file, shortening the author list if necessary.
I put the &lt;code&gt;reduceBib.py&lt;/code&gt; Python script &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/python/reduceBib&#34;&gt;on GitHub here&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;reducebib.py-usage&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;code&gt;reduceBib.py&lt;/code&gt; usage&lt;/h2&gt;
&lt;p&gt;At the root of the website, I use the following command:&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;python reduceBib.py -b static/library.bib -o static/library-small.bib content/fixed/*.Rmd content/post/*.Rmd&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The help page:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; python reduceBib.py -h
usage: reduceBib.py [-h] [-b BIB] [-o OUT] [-a NAUTHS] [-f FIELDS]
                    mds [mds ...]

Reduce a .bib file.

positional arguments:
  mds         the markdown files to scan

optional arguments:
  -h, --help  show this help message and exit
  -b BIB      the original bib file
  -o OUT      the new bib file
  -a NAUTHS   the maximum number of authors. Default: 5.
  -f FIELDS   the BibTeX fields to keep (comma separated). Default:
              &amp;quot;author,title,doi,journal,year,url&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>The Formation of the Scientific Mind, Gaston Bachelard - part 1</title>
          <link>/2018/11/12/bachelard-formation-esprit-scientifique-part1/</link>
          <pubDate>Mon, 12 Nov 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/11/12/bachelard-formation-esprit-scientifique-part1/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#quotes-about-science&#34;&gt;Quotes about science&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#the-concept-of-epistemological-obstacle&#34;&gt;The concept of epistemological obstacle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#the-first-obstacle-the-primary-experiment&#34;&gt;The first obstacle: the primary experiment&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#general-knowledge-as-an-obstacle&#34;&gt;General knowledge as an obstacle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#an-example-of-verbal-obstacle-the-sponge&#34;&gt;An example of verbal obstacle: the &lt;em&gt;sponge&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#aside-on-education&#34;&gt;Aside on education&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#sick-burns&#34;&gt;Sick burns&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;These are notes from my reading of &lt;a href=&#34;https://fr.wikipedia.org/wiki/La_Formation_de_l%27esprit_scientifique&#34;&gt;&lt;em&gt;La formation de l’esprit scientifique&lt;/em&gt;&lt;/a&gt; by &lt;a href=&#34;https://en.wikipedia.org/wiki/Gaston_Bachelard&#34;&gt;Gaston Bachelard&lt;/a&gt;. I hesitated a bit but finally decided to write the notes in English. In the end this blog is as much a place to save things I want to remember as a place to practice writing in English and share with other people. There are lots of quotes that I liked. I tried to translate them as best I could.&lt;/p&gt;
&lt;p&gt;This is “part 1” which covers the concept of epistemological obstacle and the first chapters about the primary experiment, images and generalization as obstacles.&lt;/p&gt;
&lt;div id=&#34;quotes-about-science&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Quotes about science&lt;/h2&gt;
&lt;p&gt;Let’s warm up with some positive quotes from the opening chapter before focusing on the obstacles.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La connaissance du réel est une lumière qui projette toujours quelque part des ombres.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Real-world knowledge is a light that always throws shadows somewhere.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;En résumé, l’homme animé par l’esprit scientifique désire sans doute savoir, mais c’est aussitôt pour mieux interroger.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“In summary, the individual moved by the scientific mind surely wants to know, but it’s to better question immediately after.” &lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;En fait, l’histoire des mathématiques est une merveille de régularité. Elle connaît des périodes d’arrêt. Elle ne connaît pas des périodes d’erreurs.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“In reality, history of mathematics is a marvel of regularity. It knows some interruption periods. It doesn’t know any error periods.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;the-concept-of-epistemological-obstacle&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The concept of epistemological obstacle&lt;/h2&gt;
&lt;p&gt;This is the central concept of this work. The obstacle is not external, it is not caused by observed phenomenon that are too mysterious or complex, or by technological limitations. The epistemological obstacle is internal and ideological. When ideas stagnate or regress, we are facing an epistemological obstacle.&lt;/p&gt;
&lt;p&gt;The epistemological obstacle is studied in two settings: the development of scientific thinking throughout history and in the educational practice.&lt;/p&gt;
&lt;p&gt;The difference between a historian and an epistemologist is that the historian takes ideas as fact, while the epistemologist takes fact as ideas and place them in a system of thoughts. Through the notion of epistemological obstacle, the history of scientific thinking gains a spiritual value.&lt;/p&gt;
&lt;p&gt;The first experiment/observation is the first epistemological obstacle. It looks easy to understand or to generalize, seducing us into believing that we understand the beauty of nature. It usually comes with a sense of marvel as it’s the first time it’s observed or “understood”. We think we understand and that’s the obstacle.&lt;/p&gt;
&lt;p&gt;The second obstacle is to follow hasty generalizations like the ones that emerge from the primary experiment.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Comme le dit si bien d’Alembert, on généralise ses premières remarques, l’instant d’après qu’on ne remarquait rien.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Like d’Alembert nicely stated, we generalize our first observations, the moment after we didn’t observe anything.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Other obstacles in no particular order (that will be covered in other posts):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using the unity of Nature as an explanation.&lt;/li&gt;
&lt;li&gt;Using the utility of natural phenomenon as an explanation.&lt;/li&gt;
&lt;li&gt;The verbal obstacle that uses explanatory words.&lt;/li&gt;
&lt;li&gt;Substantialism/realism.&lt;/li&gt;
&lt;li&gt;“The animist obstacle in physical sciences”.&lt;/li&gt;
&lt;li&gt;False geometrization and rigor.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the opening chapter Bachelard mentions the obstacles of close-mindedness and prior knowledge. Instincts, opinions, as well as education and previous knowledge are obstacles. A researcher must be able to rethink, to make abstraction of what she thinks is true, when battling an epistemological obstacle.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Accéder à la science, c’est, spirituellement rajeunir, c’est accepter une mutation brusque qui doit contredire un passé.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“To access science is to spiritually rejuvenate, it’s accepting an abrupt mutation that must contradict a past.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;On ne peut rien fonder sur l’opinion: il faut d’abord la détruire. Elle est le premier obstacle à surmonter.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“We cannot base anything on opinion: it must be destroyed first. It’s the first obstacle to overcome.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;Les grands hommes sont utiles à la science dans la première moitié de leur vie, nuisibles dans la seconde moitié.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Great men are useful to science in the first half of their life, harmful in the second half.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;[…] l’homme devient une espèce mutante, ou pour mieux dire encore, une espèce qui a besoin de muter, qui souffre de ne pas changer.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Man becomes a mutant species, or better said still, a species that needs to mutate, that suffers from not changing.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;Toute culture scientifique doit commencer […] par une catharsis intelectuelle et affective.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Any scientific culture must begin with an intellectual and emotional catharsis.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Yes, catharsis of course…&lt;em&gt;googling&lt;/em&gt;…ah yes, &lt;a href=&#34;https://en.wikipedia.org/wiki/Catharsis&#34;&gt;catharsis&lt;/a&gt;, that makes sense.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;the-first-obstacle-the-primary-experiment&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The first obstacle: the primary experiment&lt;/h2&gt;
&lt;p&gt;The scientific mind must develop &lt;em&gt;against&lt;/em&gt; Nature. During the pre-scientific period (XVIII century), scientific books were not based on peer-reviewed science, it was more about the author’s ideas than accuracy. More importance was given to the “story” or how it explained daily phenomena. Bachelard then describes a few of these books and their (funny) explanations. Although he agrees that these were picked as bad examples, he argues that the science at a particular time is not the science that survives time (especially in the pre-scientific period).&lt;/p&gt;
&lt;p&gt;There is a danger on relying too much on primary experiments, on selected observations and images, and on easy explanations.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;On remplace la connaissance par l’admiration, les idées par les images.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“We replace knowledge with admiration, ideas with images.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;Une science qui accepte les images est, plus que toute autre, victime des métaphores. Aussi l’esprit scientifique doit-il sans cesse lutter contre les images, contre les analogies, contre les métaphores.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“A science that accepts images is, more than any other, victim of metaphors. Hence, the scientific mind must continuously fight against images, against analogies, against metaphors.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Coupled with general curiosity, we might end up listing observations and their independent explanations without digging deeper or testing variation of the experiments. These easy solutions satisfy our primal curiosity but destroy the sense of &lt;em&gt;problem&lt;/em&gt; that is vital for progress.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Elle cherche non pas la variation, mais la variété.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“It’s not looking for variation, but for variety.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;He gives the example of electricity, its “easy” explanations at the beginning and its entertaining experiments (people were fascinated by &lt;a href=&#34;https://www.youtube.com/watch?v=xjW-isgOijs&#34;&gt;Leyden jars&lt;/a&gt;).&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Il est si doux à la paresse intellectuelle d’être cantonnée dans l’empirisme, d’appeler un fait un fait et d’interdire la recherche d’une loi!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“It is so attractive to intellectual laziness to keep to empiricism, to call a fact a fact and forbid the search of a law!”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;With these experiments, the answers are clearer than the questions. They promote some sort of &lt;em&gt;subconscious of the scientific mind&lt;/em&gt; that is difficult to get rid of. I imagine this as all these experiments/observations, all independent, all subconsciously accepted, with no clear link or structure, floating around and clouding the scientific mind. He quotes M. Édouard Le Roy:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La connaissance commune est inconscience de soi.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Common knowledge is unconsciousness of oneself”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Bachelard concludes this chapter with the example of alchemy. With its strong images and symbols, alchemy seems to touch us deep within our subconscious and represented a formidable epistemological obstacle.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;En vérité, l’amour d’une Chimère est le plus fidèle des amours.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“The truth is: love for a Chimera is the most faithful love.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;general-knowledge-as-an-obstacle&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;General knowledge as an obstacle&lt;/h2&gt;
&lt;p&gt;We have to go beyond the primary experiment and its images. Doing so the scientist faces another obstacle which is to generalize too quickly or too far.&lt;/p&gt;
&lt;p&gt;Quoting Marcel Boll on what characterizes the modern scientist:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;C’est l’objectivité et non pas l’universalisme: la pensée doit être objective, elle ne sera universelle que si elle le peut, que si la réalité l’y autorise.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“It’s objectivity and not universalism: the mind must be objective, it will be universal only if it can, if reality allows it to be.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Beyond being sometimes false, general rules tend to stop the scientific endeavor. A general rule is sometimes satisfying enough that the scientist might not feel the need to explore further. Other times it is just difficult to “attack” what’s left of the problem, to find the right angle to study further.&lt;/p&gt;
&lt;p&gt;A general rule tend to rely on the meaning of its words which are often vague or subjective. The more useful rule uses objective terms and describes precisely the conditions in which it applies. Sometimes these conditions are more interesting than the rule.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ce qui limite une connaissance est souvent plus important, pour les progrès de la pensée, que ce qui étend vaguement la connaissance.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“What limits a principle is often more important, to advance our understanding, than something that vaguely extends knowledge”&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Une connaissance générale est presque fatalement une connaissance vague.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“A general knowledge is almost inevitably a vague knowledge.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;General rules seem good in the short term as they rebuke older theories, but they are also stopping further characterization in the long term.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Autour d’une connaissance trop générale, la zone d’inconnu ne se résout pas en problèmes précis.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Around a knowledge that is too general, the area of unknown is not formed of precise problems.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;He gives the example of the following statement: &lt;em&gt;everything falls&lt;/em&gt;. Although more accurate than older theories (like the ancient Greeks and their heavy vs light objects), it’s difficult to go further. Experiments in vacuums show that everything falls. Case closed, what do we do now? The rule seems sufficient to explain the observations but often it is not the most important concept that is put forward. In the example above, the movement/speed might be what’s usually described but acceleration is at the root of the law.&lt;/p&gt;
&lt;p&gt;In the second part of this chapter, Bachelard gives two examples of over-generalization: fermentation and coagulation. Basically, at some point many phenomena were grouped together and assumed to involve the same general mechanism. At this time, coagulation explained blood coagulation but also milk curdling, metal solidification, water freezing, or ocean froth. Similar story for fermentation that also explained digestion, metal formation, or electricity.&lt;/p&gt;
&lt;p&gt;Once general concepts explained that many things, it was frowned upon to go the other way. Why try to differentiate phenomena if we can explain everything with coagulation?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Cette méfiance des variations, cette paresse de la distinction, voilà précisément des marques du concept sclérosé !&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“This distrust for variations, this laziness for distinction, this is precisely the signs of the sclerosed concept!”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Echoing the previous obstacle, general concepts often gave birth to higher-level symbols and philosophy. For example, the source the fermentation that was everywhere obtained a new value, the started/pre-ferment became a symbol.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[…] toute trace de valorisation est un mauvais signe pour une connaissance qui vise l’objectivité.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Any trace of valorization is a bad sign for a knowledge that aspires for objectivity.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;an-example-of-verbal-obstacle-the-sponge&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;An example of verbal obstacle: the &lt;em&gt;sponge&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;Here, Bachelard presents a special case of the obstacles described above. The image of the &lt;em&gt;sponge&lt;/em&gt; was used extensively to explain many phenomena in a typical example of over-generalization. This word was so useful that it infiltrated different fields and later hindered correct explanations. The &lt;em&gt;sponge&lt;/em&gt; described phenomena so elegantly that they believed it explained it.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ces phénomènes, on les exprime: on croit donc les expliquer. On les reconnaît: on croit donc les connaître.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“These phenomena, we express them: hence we think we explain them. We recognize them: hence we think we know them.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Essentially, verbal habits constrains scientific thinking, so we should be wary of the words and expressions we use when thinking about science. In science, we should use images and analogies only &lt;em&gt;after&lt;/em&gt; establishing the theory. In contrast, the image of the &lt;em&gt;sponge&lt;/em&gt; actually made people come up with new explanations or theories.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Voilà la preuve d’un mouvement purement et simplement linguistique qui, en associant, à un mot concret, un mot abstrait, croit avoir fait avancer la pensée.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Here is the proof of a movement purely and simply linguistic which, by associating an abstract word to a concrete word, thinks it has advanced our understanding.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Once a word like the &lt;em&gt;sponge&lt;/em&gt; had been attached to a phenomenon, it was difficult to get rid of it. Even if some details didn’t match the image, people kept using the &lt;em&gt;sponge&lt;/em&gt; because it elegantly explained the rest.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Le doute général est plus facile que le doute particulier.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“The general doubt is easier than the particular doubt.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Descartes fell for it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La métaphysique de l’espace chez Descartes est la métaphysique de l’éponge.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“For Descartes, the metaphysics of space is the metaphysics of the sponge.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;aside-on-education&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Aside on education&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;In the introduction, Bachelard also talks about education. &lt;/em&gt; &lt;em&gt;I don’t think there is a chapter on that particular subject so here it is.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Little effort has been directed toward the study of the psychology of ignorance and error. People think it’s just a matter of giving a lesson, repeating it until it’s grasped by the student, often using the same approach each time (e.g. retaking the class). The problem is that the student already has previous knowledge that impedes the understanding of the “lesson”. So the teacher needs first to break down these obstacles, that come from the student’s previous observations, in order to efficiently teach the new concepts. We spend too much effort on adding new concepts that will not always sort themselves out nicely in the student’s mind. We should spend more time guiding this conceptual readjustments when teaching science.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Les professeurs de sciences, plus encore que les autres si c’est possible, ne comprennent pas qu’on ne comprenne pas.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Science teachers, even more than others if that is possible, don’t understand that one doesn’t understand.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;Un éducateur n’a pas le sens de l’échec précisément parce qu’il se croit un maître.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“A teacher doesn’t have a sense of failure precisely because he believes himself to be a master.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;When performing experiments in class, the teacher should switch as fast as possible from experiment to abstract concepts, going back and forth between experiment and theory. Otherwise, the students will remember the most colorful and impressive experiments but not for the right reason. Sure they’ll remember when the tube exploded but not why or in which context.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Mieux vaudrait une ignorance complète qu’une connaissance privée de son principe fondamental.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“Complete ignorance would be better than knowledge deprived of its fundamental principle.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;sick-burns&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sick burns&lt;/h2&gt;
&lt;p&gt;About Carra’s explanation of bipedal walking that involve centrifugal force from earth rotation and electricity in the atmosphere:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;On imagine assez facilement qu’un enfant de huit ans, à la seule condition d’avoir à sa disposition un vocabulaire pédant, pourrait développer de telles billevesées.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“We can imagine quite easily that an eight years old child, if only he had a pedantic vocabulary at his disposal, would develop similar nonsense.”&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://media.giphy.com/media/xUPGcoUeohKhIesT5K/giphy.gif&#34; /&gt;

&lt;/div&gt;
&lt;hr /&gt;
&lt;p&gt;Philosophers vs scientists:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;E. Mach ne manquait pas de malice quand il répondait à l’affirmation de W. James «Tout savant a sa philosophie» par la constatation réciproque «Tout philosophe a sa science à lui».&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“E. Mach playfully responded to W. James’s statement that «Every scientist has his own philosophy» by the reciprocal «Every philosopher has his own science».”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;About Réaumur’s explanation of air as a &lt;em&gt;sponge&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Nous sentons le besoin de nous excuser auprès du lecteur d’avoir cité cette page interminable, cette page si mal écrite, d’un auteur célèbre.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“We feel we must apologize to the reader that we quoted this never-ending page, this page so badly written, from a famous author.”&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;P. de Lozeran won the Academy price with his explanation of thunder as a chemical reaction of gun powder-like ingredients in the air. Bachelard quotes the Academy:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;L’Académie qui n’avait pu discerner le prix l’année précédente se félicite d’avoir attendu un si beau mémoire.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;“The Academy which hadn’t been able to give a prize the year before congratulate itself for having waited for such a beautiful memoir.”&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Peer-review opportunities for early career researchers</title>
          <link>/2018/11/07/ecr-peerreview/</link>
          <pubDate>Wed, 07 Nov 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/11/07/ecr-peerreview/</guid>
          <description>


&lt;p&gt;Some notes from &lt;a href=&#34;https://uspa.ucsc.edu/2018/10/31/peer-review-workshop-117-12-pm-in-biomed-200/&#34;&gt;today’s workshop organized by USPA&lt;/a&gt; with bio-protocol and eLife ambassadors.&lt;/p&gt;
&lt;div id=&#34;bio-protocol&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bio-protocol&lt;/h2&gt;
&lt;p&gt;Data is uploaded to databases, code to repos like GitHub but protocols are still just in the &lt;em&gt;Methods&lt;/em&gt; section of papers.
And the &lt;em&gt;Methods&lt;/em&gt; of a paper often omits many details which makes it difficult to reuse the experiment or reproduce results.&lt;/p&gt;
&lt;p&gt;Dennis Bua introduced &lt;a href=&#34;https://bio-protocol.org/&#34;&gt;bio-protocol&lt;/a&gt;, a platform to peer-review protocols.
Here the goal is to make sure all the information is provided to reproduce an experiment.
Videos can also be uploaded to better show the manipulations.
There is no access or publication fee in bio-protocol, and reviewers are early-careers researchers.&lt;/p&gt;
&lt;p&gt;Currently it’s mostly used for wet lab experiments but Dennis said it was mostly because of a lack of expertise in the current pool of reviewers.
At first, it doesn’t feel as essential for dry lab experiments because we can already put the code in repos.
It’s also easier (in theory) to ask for assistance with code problems to the authors or in online forums.
That covers the situation when someone wants to use the code but not specifically to reproduce the results of the primary article.
So most of the time the code linked to a paper is still not really peer-reviewed (I think).
And we’ve all seen examples where the “code” is just a bunch of scripts with no comprehensive instructions or README.&lt;/p&gt;
&lt;p&gt;Dennis mentioned the &lt;a href=&#34;https://en.wikipedia.org/wiki/Curse_of_knowledge&#34;&gt;curse of knowledge&lt;/a&gt; which is when we can’t imagine that other people don’t know what we know.
It sounds like the kind of flaw we easily imagine others having but not to us.
I’m sure it happens in bioinformatics too.
Some scripts are simple or self-explanatory IF the user has the same knowledge (tools, favorite command lines, programming language, organization habits) as the original author.&lt;/p&gt;
&lt;p&gt;Another step that is often left aside it the data preparation.
The main method is often described in more detail because it’s usually novel.
How the data was downloaded or preprocessed is sometimes just mentioned in the method section.&lt;/p&gt;
&lt;p&gt;The more I think about it, the more I think bio-protocol could be useful to &lt;em&gt;vet&lt;/em&gt; a bioinformatics analysis.&lt;/p&gt;
&lt;p&gt;I’ve tried to make an effort to provide usable scripts to reproduce the results in my papers.
At least I (will) try to comment the scripts, even “trivial” commands to limit the &lt;em&gt;curse of knowledge&lt;/em&gt;.
For figures/numbers, I found that R-Markdown reports were pretty good because they show the code next to the output so it’s easier to find the code for a particular result.
Having the analysis as a &lt;em&gt;protocol&lt;/em&gt; would be an extra step but I feel like it wouldn’t be that much of an effort.
Just a reformatting of a comprehensive README/tutorial.
The benefit would be:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;having someone external having a second look at the code and instructions.&lt;/li&gt;
&lt;li&gt;making the methods accessible to a larger audience hence making it more likely to be used.&lt;/li&gt;
&lt;li&gt;getting something official (a “publication”) out of the reproducibility effort.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;elife&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;eLife&lt;/h2&gt;
&lt;p&gt;Jason Fernandez and Jordan Ward, two of the three eLife ambassadors at UCSC with Daniel Kim, talked about eLife.
I was already quite familiar with eLife and really like the idea of not just a more efficient peer-reviewing but also a better one.
Especially better for authors because there is a discussion between reviewers that helps get more useful reviews.&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/3pjXfgeOCho&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt; &lt;/p&gt;
&lt;p&gt;eLife is also very active (YouTube videos, podcasts, blogs, innovations) and the ambassadors mentioned &lt;a href=&#34;https://elifesciences.org/inside-elife/ae2cc6b5/early-career-researcher-travel-grants-2018-open-for-applications&#34;&gt;travel grants&lt;/a&gt; for authors and &lt;a href=&#34;https://elifesciences.org/inside-elife/31a5173b/elife-promotes-early-career-involvement-in-peer-review&#34;&gt;review opportunities for early-careers researchers&lt;/a&gt;.
Although it might look &lt;em&gt;closed&lt;/em&gt; on the website, they recommended to contact eLife anyway.
To have a chance to be included in the pool of reviewers, we should submit a letter of support from a supervisor and a few representative publications.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;other-resources-mentioned-during-the-workshop&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Other resources mentioned during the workshop&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://masterclasses.nature.com/users/4925-claire-hodge/posts/20006-free-online-course-on-peer-review&#34;&gt;Course on peer review from Nature&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;“&lt;a href=&#34;https://www.nature.com/articles/d41586-018-06991-0&#34;&gt;How to write a thorough peer review&lt;/a&gt;” by Matthew Stiller-Reeve explaining his three reading methods.&lt;/li&gt;
&lt;li&gt;“&lt;a href=&#34;https://jbiol.biomedcentral.com/articles/10.1186/jbiol125&#34;&gt;Are we training pit bulls to review our manuscripts?&lt;/a&gt;” by Virginia Walbot.&lt;/li&gt;
&lt;li&gt;“&lt;a href=&#34;http://blogs.nature.com/ofschemesandmemes/2017/12/21/are-you-aware-of-gender-bias-in-peer-review&#34;&gt;Are you aware of gender bias in peer review?&lt;/a&gt;” by Elizabeth Moylan and Elisa de Ranieri.&lt;/li&gt;
&lt;li&gt;“&lt;a href=&#34;https://peerj.com/blog/post/73296165864/how-to-become-good-at-peer-review/&#34;&gt;How To Become Good At Peer-Review&lt;/a&gt;” on PeerJ blog.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.prereview.org/users/8850/articles/198235-welcome-to-prereview&#34;&gt;PREreview&lt;/a&gt; reviews preprints. Part of the &lt;a href=&#34;http://asapbio.org/&#34;&gt;ASAPbio&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://publons.com/home/&#34;&gt;Publons Academy&lt;/a&gt; to learn how to peer review and connect with journal editors&lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//player.vimeo.com/video/218452887&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;
 &lt;/div&gt;

&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Syncing Mendeley and PDFs across devices</title>
          <link>/2018/09/22/sync-mendeley/</link>
          <pubDate>Sat, 22 Sep 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/09/22/sync-mendeley/</guid>
          <description>


&lt;p&gt;&lt;em&gt;20 March 2019 Edit: I switched to Zotero (yeay open-source, bye Elsevier), using Google Drive to store the PDF files. See the &lt;a href=&#34;./internet#zotero&#34;&gt;Internet section&lt;/a&gt; and &lt;a href=&#34;https://ikashnitsky.github.io/2019/zotero/&#34;&gt;the blog post that inspired the change&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Recently, I’ve been setting up new computers from scratch as I moved from Montreal to Santa Cruz. Like for spring cleaning, it might be a good idea to clarify the system I’ve been using to manage bibliography and PDF annotation.&lt;/p&gt;
&lt;p&gt;Briefly I use Mendeley Desktop and also put all PDF files in a Google Drive. Both are synced with my Android tablet. On the tablet, I use the Mendeley app to get information, search etc, but I read/annotate the PDFs from the Google Drive. On a computer I use a custom Python script to update the PDFs if necessary.&lt;/p&gt;
&lt;div id=&#34;the-updatemendeley.py-script&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The &lt;code&gt;updateMendeley.py&lt;/code&gt; script&lt;/h2&gt;
&lt;p&gt;I wrote a Python script that checks the Google Drive folder and Mendeley’s local folder, matches PDF files and syncs them. The &lt;code&gt;updateMendeley.py&lt;/code&gt; script is on &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/python/updateMendeley&#34;&gt;the GitHub repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I needed something slightly better than a &lt;code&gt;rsync&lt;/code&gt; because it’s possible that the filenames are not the same between the two folders. This might not be a big problem for new files but at some point Mendeley Desktop and the app I used on the tablet produced slightly different file names for the same article. I don’t use the Android app to download PDFs anymore but I still have old PDFs that I didn’t take the time to rename.&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;matching&lt;/em&gt; part of the script compares each file name in the Google Drive with the file names in the local Mendeley folder. It uses the &lt;em&gt;SequenceMatcher&lt;/em&gt; function from the &lt;a href=&#34;https://docs.python.org/2/library/difflib.html&#34;&gt;difflib&lt;/a&gt; module. If two file names have more than 90% match, it assumes that it’s the same article. The result of the matching step is saved locally in a “cache” file to speed up future runs.&lt;/p&gt;
&lt;p&gt;Then it’s just a question of copying the new articles to the Google Drive or updating the local Mendeley folder (if files have different sizes).&lt;/p&gt;
&lt;p&gt;In practice, I run the following command when I feel a sync is needed (first a dry run, then without the &lt;code&gt;-dry&lt;/code&gt;):&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;python updateMendeley.py -local PATH/TO/MendeleyDesktop -remote PATH/TO/GoogleDrive/ArticlesPDF -dry&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;why-mendeley&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Why Mendeley?&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;That’s what I started using a while ago (before Elsevier acquired it).&lt;/li&gt;
&lt;li&gt;It has an Android app (I have an Android tablet).&lt;/li&gt;
&lt;li&gt;It does what I need: tagging system, export to BibTeX, search in PDFs, online portal.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Maybe I could find a good system with EndNote or Zotero but that would take some time and work. The idea of Zotero is appealing and I would prefer an open-source software (not owned by Elsevier). I tried to make the switch but it froze when importing my entire library. I should try again. There is still the problem of the Android app: I don’t know what they are worth for Zotero. There are two unofficial apps. Maybe I could pay the $2 and test them.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;why-not-use-the-pdf-syncing-mechanism-from-mendeley&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Why not use the PDF syncing mechanism from Mendeley?&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Google Drive is more user-friendly: quickly access from different devices, easy to share PDF with others.&lt;/li&gt;
&lt;li&gt;Control over the files.&lt;/li&gt;
&lt;li&gt;Easy to update PDFs annotated on the tablet. Useful because I prefer to use a separate Android application to annotate PDFs (RepliGo).&lt;/li&gt;
&lt;li&gt;Bad experience this summer with &lt;a href=&#34;https://blog.mendeley.com/2018/06/01/support-update-pdfs-missing-from-desktop-and-web-library/&#34;&gt;a bug in Mendeley&lt;/a&gt; (blocked for more than a month and lost many PDFs, some of which were annotated).&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;syncing-the-google-drive-folder&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Syncing the Google Drive folder&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;On Android I use &lt;a href=&#34;https://play.google.com/store/apps/details?id=dk.tacit.android.foldersync.lite&amp;amp;hl=en_US&#34;&gt;FolderSync&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;On Ubuntu I use &lt;a href=&#34;./internet#sync-a-specific-google-drive-folder-on-ubuntu&#34;&gt;grive&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;On OSX I use the official Google Drive app: &lt;a href=&#34;https://www.google.com/drive/download/&#34;&gt;Backup and Sync&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Mental health crisis in science...but careful with nonresponse bias</title>
          <link>/2018/07/08/mental-health-crisis-science/</link>
          <pubDate>Sun, 08 Jul 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/07/08/mental-health-crisis-science/</guid>
          <description>


&lt;p&gt;A few month ago, a short paper was published in Nature Biotechnology&lt;a href=&#34;#fn1&#34; class=&#34;footnoteRef&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; about the mental health crisis in science. It attracted a bit of attention on the news and social media, which is good because it’s an important matter. The article was very good at putting the subject on the table and proposing some solutions, but it picked my curiosity about nonresponse bias.&lt;/p&gt;
&lt;div id=&#34;issues-with-the-nature-biotech-article&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Issues with the Nature Biotech article&lt;/h2&gt;
&lt;p&gt;The numbers are based on an email survey so &lt;strong&gt;one issue is the nonresponse bias&lt;/strong&gt;: the individuals that responded might not be representative of the population. The authors quickly mention it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Although this is a convenience sample in which respondents who have had a history of anxiety or depression may have been more apt to respond to the survey, the data should prompt both academia and policy makers to consider intervention strategies.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;However, in the next paragraph, this number is directly compared with the population number from a study that used a “nationally representative face-to-face household survey”&lt;a href=&#34;#fn2&#34; class=&#34;footnoteRef&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Our results show that graduate students are more than six times as likely to experience depression and anxiety as compared to the general population. Forty-one percent of graduate students scored as having moderate to severe anxiety on the GAD07 scale as compared to 6% of the general population, as demonstrated previously.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I find it a bit misleading to put both numbers in the same sentence without explaining that they were derived from different methods.&lt;/p&gt;
&lt;p&gt;On a side note, I was also surprised that the figures are incorrectly described in the text. Saying &lt;em&gt;“56% of students experiencing anxiety have an unhealthy work-life balance”&lt;/em&gt; is different from saying &lt;em&gt;“56% of students with unhealthy work-life balance experience anxiety”&lt;/em&gt;. Still, all the numbers about work-life balance and relationship with mentor are incorrectly described like this… A shame because at least these comparisons shouldn’t be affected by nonresponse bias as much. End of rant.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;better-studies&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Better studies&lt;/h2&gt;
&lt;p&gt;Although not cited in the Nature Biotech paper, I found two studies that are quite similar but were more careful with their methods/conclusions.&lt;/p&gt;
&lt;p&gt;The first was published in the American Journal of Orthopsychiatry in 2010&lt;a href=&#34;#fn3&#34; class=&#34;footnoteRef&#34; id=&#34;fnref3&#34;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; and looked at mental health in university students (graduate students included). The PHQ-9 questionnaire was also used to assess depression and ~1,700 graduate students responded to their email survey. In this study, the authors tried to &lt;strong&gt;account for nonresponse bias&lt;/strong&gt; by computing weights based on two types of information:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Demographic and academic representation compared to the university’s registar.&lt;/li&gt;
&lt;li&gt;Results from nonrespondents that were recontacted and given larger incentive to respond.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The proportion of students with depression was significantly higher in the respondents than the non-respondents (&lt;strong&gt;14.1% vs 6.1%&lt;/strong&gt;). After correcting for the nonresponse bias they found that 11.3% of graduate students were positive for a depressive or anxiety disorder.&lt;/p&gt;
&lt;p&gt;The second study was published in Academic Psychiatry in 2014&lt;a href=&#34;#fn4&#34; class=&#34;footnoteRef&#34; id=&#34;fnref4&#34;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;. This one is not really saying much about the estimates for the graduate student population but shows &lt;strong&gt;what can (and cannot) be said&lt;/strong&gt; when the nonresponse bias is not controlled. It used the same questionnaire for depression (PHQ-9) and screened ~300 students with an email survey. However, the goal was essentially to find factors that correlate with the questionnaire score. Although they describe the global number in the cohort, most of the study focuses on the association with other factors like substance use and eating problems. The discussion makes it clear too:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Therefore, the results of this study should not be generalized to the entire graduate student population on this campus or to graduate students outside of the study institution. As the goal of the screening was to identify and triage at-risk students into treatment, survey respondents may have represented students with more severe mental health needs who responded to the survey as a means of seeking help.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The 40% number might be a bit over-estimated. &lt;strong&gt;Is that a problem?&lt;/strong&gt; &lt;strong&gt;No&lt;/strong&gt; because mental health is a problem and we should talk about it and try to fix it. I just wanted to cite and put these two good studies somewhere I can remember (and also rant).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;Evans, T. M., Bira, L., Gastelum, J. B., Weiss, L. T., &amp;amp; Vanderford, N. L. (2018). Evidence for a mental health crisis in graduate education. &lt;em&gt;Nature Biotechnology&lt;/em&gt;, volume 36, pages 282–284. &lt;a href=&#34;https://www.nature.com/articles/nbt.4089&#34;&gt;Link&lt;/a&gt;&lt;a href=&#34;#fnref1&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;Kocalevent, R. D., Hinz, A., &amp;amp; Brähler, E. (2013). Standardization of the depression screener Patient Health Questionnaire (PHQ-9) in the general population. &lt;em&gt;General Hospital Psychiatry&lt;/em&gt;, 35(5), 551–555. &lt;a href=&#34;https://doi.org/10.1016/j.genhosppsych.2013.04.006&#34;&gt;Link&lt;/a&gt;&lt;a href=&#34;#fnref2&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn3&#34;&gt;&lt;p&gt;Eisenberg, D. , Gollust, S. E., Golberstein, E. and Hefner, J. L. (2007). Prevalence and Correlates of Depression, Anxiety, and Suicidality Among University Students. &lt;em&gt;American Journal of Orthopsychiatry&lt;/em&gt;, 77: 534-542. &lt;a href=&#34;https://doi.org/10.1037/0002-9432.77.4.534&#34;&gt;Link&lt;/a&gt;&lt;a href=&#34;#fnref3&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn4&#34;&gt;&lt;p&gt;Garcia-Williams, A.G., Moffitt, L. &amp;amp; Kaslow, N.J. (2014). Mental Health and Suicidal Behavior Among Graduate Students. &lt;em&gt;Acad Psychiatry&lt;/em&gt;, 38: 554. &lt;a href=&#34;https://doi.org/10.1007/s40596-014-0041-y&#34;&gt;Link&lt;/a&gt;&lt;a href=&#34;#fnref4&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Clustering into same size clusters</title>
          <link>/2018/06/09/cluster-same-size/</link>
          <pubDate>Sat, 09 Jun 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/06/09/cluster-same-size/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#methods&#34;&gt;Methods&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#iterative-dichotomy&#34;&gt;Iterative dichotomy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#iterative-nearest-neighbor&#34;&gt;Iterative nearest neighbor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#same-size-k-means-variation&#34;&gt;Same-size k-Means Variation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#iterative-bottom-leaves-hierarchical-clustering&#34;&gt;Iterative “bottom-leaves” hierarchical clustering&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#test-data&#34;&gt;Test data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#results&#34;&gt;Results&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#cluster-size&#34;&gt;Cluster size&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#within-cluster-distance&#34;&gt;Within-cluster distance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#silhouette-score&#34;&gt;Silhouette score&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#conclusions&#34;&gt;Conclusions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#extra-optimization&#34;&gt;Extra: optimization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#code&#34;&gt;Code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Update Nov 23 2018: New iterative approach using hierarchical clustering and better graphs.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I would like to cluster points into groups of similar size.
For example I would like to group 1000 points into clusters of around 20 points each.
The two aspects that are important here are:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;The cluster size distribution (or the deviation from the desired cluster size).&lt;/li&gt;
&lt;li&gt;The quality of the clusters (i.e. how similar are points within a cluster).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In addition to the typical hierarchical clustering approach, I will test the following iterative approaches:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Iterative dichotomy: large clusters are split in two until around the desired size (using hierarchical clustering).&lt;/li&gt;
&lt;li&gt;Iterative nearest neighbor: a point and its closest neighboring points are assigned to a cluster and removed before processing another point.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://elki-project.github.io/tutorial/same-size_k_means&#34;&gt;Same-size k-Means Variation&lt;/a&gt; that some quick googling returned.&lt;/li&gt;
&lt;li&gt;Iterative “bottom-leaves” hierarchical clustering: keeping the first cluster of the desired size at the “bottom” of the dendrogram.&lt;/li&gt;
&lt;/ol&gt;
&lt;div id=&#34;methods&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Methods&lt;/h2&gt;
&lt;p&gt;In the following &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; is the target cluster size.&lt;/p&gt;
&lt;div id=&#34;iterative-dichotomy&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Iterative dichotomy&lt;/h3&gt;
&lt;p&gt;Starting with one cluster containing all the points, a cluster is split in two if larger that &lt;span class=&#34;math inline&#34;&gt;\(1.5*s\)&lt;/span&gt;.
When all clusters are smaller than &lt;span class=&#34;math inline&#34;&gt;\(1.5*s\)&lt;/span&gt;, the process stops.&lt;/p&gt;
&lt;p&gt;The points are split in two using hierarchical clustering.
I will try different linkage criteria.
My guess is that the Ward criterion will be good at this because it tends to produce balanced dendrograms.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;iterative-nearest-neighbor&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Iterative nearest neighbor&lt;/h3&gt;
&lt;p&gt;While there are more than &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; unassigned points:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;A point is selected. Randomly or following a rule (see below).&lt;/li&gt;
&lt;li&gt;The &lt;span class=&#34;math inline&#34;&gt;\(s-1\)&lt;/span&gt; closest points are found and assigned to a new cluster.&lt;/li&gt;
&lt;li&gt;These points are removed.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;If the total number of points is not a multiple of &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;, the remaining points could be either assigned to their own clusters or to an existing cluster.
Actually, we completely control the cluster sizes here so we could fix the size of some clusters to &lt;span class=&#34;math inline&#34;&gt;\(s+1\)&lt;/span&gt; beforehand to avoid leftovers and ensure balanced sizes.&lt;/p&gt;
&lt;p&gt;In the first step, a point is selected.
I’ll start by choosing a point randomly (out of the unassigned points).
Eventually I could try picking the points with close neighbors, or the opposite, far from other points.
I’ll use the mean distance between a point and the others to define the order at which points are processed.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;same-size-k-means-variation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Same-size k-Means Variation&lt;/h3&gt;
&lt;p&gt;As explained in a few pages online (e.g. &lt;a href=&#34;https://elki-project.github.io/tutorial/same-size_k_means&#34;&gt;here&lt;/a&gt;), one approach consists of using K-means to derive centers and then assigning the same amount of points to each center/cluster.&lt;/p&gt;
&lt;p&gt;In the proposed approach the points are ordered by their distance to the closest center minus the distance to the farthest cluster.
Each point is assigned to the best cluster in this order.
If the best cluster is full, the second best is chosen, etc.&lt;/p&gt;
&lt;p&gt;I’ll also try to order the points by the distance to the closest center, by the distance to the farthest cluster, or using a random order.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;iterative-bottom-leaves-hierarchical-clustering&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Iterative “bottom-leaves” hierarchical clustering&lt;/h3&gt;
&lt;p&gt;While there are more than &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; unassigned points:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;A hierarchical clustering is built.&lt;/li&gt;
&lt;li&gt;The tree is cut at increasing level until one cluster is &lt;span class=&#34;math inline&#34;&gt;\(\gt s\)&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;Assign these points to a cluster and repeat.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Instead of working at the level of the point, the idea is to find the best &lt;em&gt;cluster&lt;/em&gt; at each step.
The hierarchical clustering integrates information across all the (available) points which might be more robust than ad-hoc rules (e.g. nearest neighbors approach).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;test-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Test data&lt;/h2&gt;
&lt;p&gt;I’ll test the different approaches on dummy data with Gaussian distributions and some outliers.
The 1000 points are grouped in 4 groups with one larger than the others.
I added 100 outliers.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;Let’s aim for clusters of around &lt;span class=&#34;math inline&#34;&gt;\(s=21\)&lt;/span&gt; points.
Why 21, and not 20? Because that way there will be “left-over” points (more realistic).&lt;/p&gt;
&lt;div id=&#34;cluster-size&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Cluster size&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The dichotomy and hclust sometimes produce an average cluster size close to the desired size but still many cluster are much smaller/bigger.&lt;/li&gt;
&lt;li&gt;As expected, we get the correct size when using the methods that specifically control for cluster size.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;within-cluster-distance&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Within-cluster distance&lt;/h3&gt;
&lt;p&gt;We compute the average pairwise distance per cluster and the maximum pairwise distance per cluster.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-10-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Several approaches perform well.
Among the methods with cluster size control, &lt;em&gt;hclust-bottom&lt;/em&gt; and &lt;em&gt;nearest neighbors&lt;/em&gt; looks quite good considering that they have the additional constraint of the fixed cluster size.
However we notice a few outlier points with high values.
These are usually the last cluster of the iterative process, kind of a left-over cluster with many distant outlier points.
That’s why the nearest neighbors approach with the &lt;em&gt;maxD&lt;/em&gt; rule, which starts with outlier points on purpose, is performing better (narrower distribution and much weaker outliers).&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;A summary bar chart with the median values only:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;silhouette-score&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Silhouette score&lt;/h3&gt;
&lt;p&gt;Another way of estimating cluster quality is the &lt;a href=&#34;https://en.wikipedia.org/wiki/Silhouette_(clustering)&#34;&gt;silhouette score&lt;/a&gt;.
The higher the silhouette score for a point the better (the more it belongs to its cluster rather than another).
We could look at the mean silhouette score per cluster or overall.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-12-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Again higher and narrower score distribution for the &lt;em&gt;nearest neighbors&lt;/em&gt; with &lt;em&gt;maxD&lt;/em&gt; rule.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;The &lt;em&gt;iterative dichotomy&lt;/em&gt; approach is not as bad as I thought, especially using Ward linkage criterion, but it doesn’t really controls for the final cluster size.
We end up with most clusters around the desired size but the size of some clusters still vary by a factor of 2 or more.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The nearest neighbor approach (&lt;em&gt;maxD&lt;/em&gt; variant), is the best approach in my opinion.&lt;/strong&gt;
The cluster size is completely controlled and the mean/maximum pairwise distance for points in the same cluster is similar (or better) to other approaches.&lt;/p&gt;
&lt;p&gt;The K-means approach didn’t perform as well but we can keep it in mind if the number of points is very large, as it is much more memory efficient (no need for a pairwise distance matrix).&lt;/p&gt;
&lt;p&gt;Although the “bottom-leaves” hierarchical clustering doesn’t look as good as the nearest neighbors, it might be more robust sometimes.
In a real data analysis for example, I had noticed that it created better cluster (in my opinion).
So, as usual, it would be a good idea to try several methods when analyzing a new dataset and see which behaves the best.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;extra-optimization&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Extra: optimization&lt;/h2&gt;
&lt;p&gt;The nearest neighbor approach uses a &lt;code&gt;while&lt;/code&gt; loop, which is not efficient in R.
Maybe implementing the loop with Rcpp could speed up the computation (in practice I would like to run this on up to 10K points).&lt;/p&gt;
&lt;p&gt;After implementing the loop using Rcpp, I ran it on datasets of different size and got these computation times.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-14-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It’s around three times faster with Rcpp. Not bad!&lt;/p&gt;
&lt;p&gt;Quick sanity check: are the results actually the same ?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2018-06-09-ClusterEqualSize_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Yes. Ouf…&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;code&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Code&lt;/h2&gt;
&lt;p&gt;The source code of this page can be found &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/master/content/post/2018-06-09-ClusterEqualSize.Rmd&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Converting scientific reviews to EPUB</title>
          <link>/2018/05/07/epub-reviews/</link>
          <pubDate>Mon, 07 May 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/05/07/epub-reviews/</guid>
          <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#first-check-on-pubmed-central&#34;&gt;First, check on PubMed Central&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#convert-the-html-page-to-epub&#34;&gt;Convert the HTML page to EPUB&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#clean-up-the-html-before-conversion&#34;&gt;Clean up the HTML before conversion&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#compiling-several-reviews-into-one-epub-document&#34;&gt;Compiling several reviews into one EPUB document&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#vpn-paywall-and-pandoc&#34;&gt;VPN, paywall and Pandoc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#limitations&#34;&gt;Limitations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#methods&#34;&gt;Methods&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#other-epub-resources&#34;&gt;Other EPUB resources&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#loose-ends-by-sidney-brenner&#34;&gt;Loose Ends by Sidney Brenner&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Edit Apr 6 2019: Added the compilation of Loose Ends columns by Sidney Brenner.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Third post on the series of &lt;em&gt;“Things I did instead of writing my thesis to help me write my thesis”&lt;/em&gt;: how to find/convert reviews in the EPUB format to read in an ebook reader.&lt;/p&gt;
&lt;p&gt;To motivate myself to write the thesis introduction and get some “style” inspiration, I read a few reviews. Reviews are longer and often more wordy than original research articles so I’d sometimes prefer to use my e-reader. It’s more compact and the e-ink is more comfortable to read, especially outside. But I find PDFs a bit awkward to use on an e-reader so it would be better to have the reviews in a e-reader format like EPUB.&lt;/p&gt;
&lt;p&gt;In my experience, this is the best strategy to get a review in EPUB format:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Check if available on PubMed Central.&lt;/li&gt;
&lt;li&gt;If not, download HTML page and convert with Pandoc.
&lt;ul&gt;
&lt;li&gt;If &lt;em&gt;Nature Reviews&lt;/em&gt; or &lt;em&gt;Annual Reviews&lt;/em&gt;, clean up the HTML file before conversion.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;For &lt;em&gt;Nature Reviews&lt;/em&gt; and &lt;em&gt;Annual Reviews&lt;/em&gt;, the script I wrote can also merge several reviews into one EPUB ebook.&lt;/p&gt;
&lt;div id=&#34;first-check-on-pubmed-central&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;First, check on PubMed Central&lt;/h2&gt;
&lt;p&gt;In the top-right corner of the article page there is a &lt;em&gt;ePub&lt;/em&gt; option (&lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3612533/&#34;&gt;example&lt;/a&gt;). This feature has been in &lt;em&gt;beta&lt;/em&gt; version for years but the EPUB files are really good.&lt;/p&gt;
&lt;p&gt;Unfortunately, many articles/reviews are not available through PMC, including the majority of reviews from dedicated journals like &lt;a href=&#34;https://www.nature.com/nrg/&#34;&gt;Nature Reviews Genetics&lt;/a&gt; and &lt;a href=&#34;https://www.annualreviews.org/journal/genet&#34;&gt;Annual Review of Genetics&lt;/a&gt;. For example, there are more than a thousand reviews from Nature Reviews Genetics on PubMed, but only &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pmc/?term=%22nat+rev+genet%22%5BJournal%5D&#34;&gt;200-300 available on PubMed Central&lt;/a&gt;. Same for Annual Review of Genetics which has &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pmc/?term=%22annual+review+of+genetics%22%5BJournal%5D&#34;&gt;~70 reviews available on PMC&lt;/a&gt; but almost 1K indexed on PubMed.&lt;/p&gt;
&lt;p&gt;If it’s not available in PMC (and the journal doesn’t provide an EPUB file), no choice but to manually convert to EPUB.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;convert-the-html-page-to-epub&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Convert the HTML page to EPUB&lt;/h2&gt;
&lt;p&gt;Rather than trying to convert the PDF, I found it easier to convert the HTML page. EPUB is a XML-based format which is quite close to the HTML anyway so it should be the way to go.&lt;/p&gt;
&lt;p&gt;After saving the webpage locally, the HTML file can be converted with &lt;a href=&#34;http://pandoc.org/index.html&#34;&gt;Pandoc&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;pandoc webpage-i-manually-downloaded.html -o webpage-i-manually-downloaded.epub&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Usually, the result is &lt;strong&gt;readable but not very practical&lt;/strong&gt; because the interface of the website is polluting the ebook, many links are external (pointing at webpages), and content is sometimes missing. It’s annoying not being able to click on the reference/figure links (or clicking inadvertently and opening a web browser), having to skip dozens of pages to get to the content, or missing information because they needed to be “expanded” on the website.&lt;/p&gt;
&lt;p&gt;There are exceptions. For example the &lt;strong&gt;“&lt;em&gt;Opportunities and obstacles for deep learning in biology and medicine&lt;/em&gt;”&lt;/strong&gt;, a cool (and long) review which was published in &lt;a href=&#34;http://rsif.royalsocietypublishing.org/content/15/141/20170387&#34;&gt;the Journal of the Royal Society Interface&lt;/a&gt;, is also formatted in &lt;a href=&#34;https://greenelab.github.io/deep-review/&#34;&gt;a GitHub HTML page&lt;/a&gt;. The manuscript is actually written and build using Markdown/GitHub (I want to learn how to do that at some point). Anyway, the GitHub webpage was straightforward to convert with Pandoc and produced a perfect EPUB version of the review.&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;wget -p https://greenelab.github.io/deep-review/
cd greenelab.github.io/deep-review
pandoc index.html -o DeepLearningBioMed.epub&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;clean-up-the-html-before-conversion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Clean up the HTML before conversion&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;For Nature Reviews and Annual Reviews&lt;/strong&gt;, I wrote a small R script that downloads a HTML page and:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Keeps only the article content (remove the rest of the webpage).&lt;/li&gt;
&lt;li&gt;Fixes the table of content.&lt;/li&gt;
&lt;li&gt;Fixes links to reference/figure/glossary in the text.&lt;/li&gt;
&lt;li&gt;Makes the figures not clickable.&lt;/li&gt;
&lt;li&gt;Removes external links around references and images.&lt;/li&gt;
&lt;li&gt;Simplify complex tables to allow for EPUB display.&lt;/li&gt;
&lt;li&gt;Shows the content of a &lt;em&gt;box&lt;/em&gt; even if hidden in the webpage.&lt;/li&gt;
&lt;li&gt;Replaces low-resolution figure with high-resolution (for Annual Reviews).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I put the &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/epubifyReviews&#34;&gt;two R scripts on GitHub&lt;/a&gt;. Using the URL of the review, run this to clean up the HTML and call Pandoc:&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;Rscript epubify-annualreviews.R -i https://www.annualreviews.org/doi/full/10.1146/annurev-genet-120215-034854
## or
Rscript epubify-naturereviews.R -i https://www.nature.com/articles/nrg.2015.16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;The scripts rely on the &lt;a href=&#34;https://github.com/hadley/rvest&#34;&gt;rvest package&lt;/a&gt; (&lt;code&gt;install.packages(&#39;rvest&#39;)&lt;/code&gt; to install in &lt;code&gt;R&lt;/code&gt;) and the &lt;a href=&#34;https://yihui.name/knitr/&#34;&gt;knitr package&lt;/a&gt; (&lt;code&gt;install.packages(&#39;knitr&#39;)&lt;/code&gt; to install in &lt;code&gt;R&lt;/code&gt;).&lt;/em&gt; &lt;em&gt;It also assumes that &lt;code&gt;pandoc&lt;/code&gt; is installed.&lt;/em&gt;&lt;/p&gt;
&lt;div id=&#34;compiling-several-reviews-into-one-epub-document&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Compiling several reviews into one EPUB document&lt;/h3&gt;
&lt;p&gt;Some reviews or articles are part of collections, like the “Points of significance” serie in Nature Methods. It would be nice to convert these articles into one EPUB.&lt;/p&gt;
&lt;p&gt;To do this both scripts can loop over URLs in a list and produce one EPUB. The &lt;code&gt;-i&lt;/code&gt; argument should be a text file with one URL per line, and the &lt;code&gt;-list&lt;/code&gt; argument should be added to switch on the “list” mode. Optional, you can specify a title using the &lt;code&gt;-title&lt;/code&gt; argument.&lt;/p&gt;
&lt;p&gt;I don’t think I’m allowed to share publicly the &lt;strong&gt;“Points of Significance” EPUB&lt;/strong&gt; but I can share the commands I used (see &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/epubifyReviews&#34;&gt;instructions on GitHub&lt;/a&gt;). There are also commands to download &lt;strong&gt;collections&lt;/strong&gt; of Nature Reviews (e.g. Genome Editing or Computational Tools) or search results for Annual Reviews (e.g. Microbiome &amp;amp; Sequencing).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;vpn-paywall-and-pandoc&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;VPN, paywall and Pandoc&lt;/h3&gt;
&lt;p&gt;The script and Pandoc will try to download the text/images so &lt;strong&gt;they should be used behind the university’s VPN (or at the university).&lt;/strong&gt; For Nature Reviews, the page can also be downloaded locally and used instead of the URL argument. That might be useful if the articles are accessed by logging in through the web browser (e.g. McGill’s &lt;a href=&#34;http://www.mcgill.ca/library/services/connect&#34;&gt;EZproxy system&lt;/a&gt;). For Annual Reviews however, the Pandoc command will try to download high-res figures so it’s better to run with a VPN.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;limitations&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Limitations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Tables are “simplified” which makes them uglier but compatible with EPUB. For example, a multi-rows label is repeated in each row.&lt;/li&gt;
&lt;li&gt;If/when the websites change, the scripts will need to be adapted.&lt;/li&gt;
&lt;li&gt;This is &lt;a href=&#34;https://togelius.blogspot.ca/2016/04/the-differences-between-tinkering-and.html&#34;&gt;tinkering&lt;/a&gt; so it’s possible that some pages won’t work properly. The ones I tried worked but I didn’t test that many.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;methods&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Methods&lt;/h3&gt;
&lt;p&gt;The scripts use functions from the &lt;a href=&#34;https://github.com/hadley/rvest&#34;&gt;&lt;em&gt;rvest&lt;/em&gt;&lt;/a&gt; package to download the HTML code of a webpage. Then they use three different strategies to clean up the HTML code. Sometimes &lt;em&gt;rvest&lt;/em&gt;’s functions can directly select the relevant parts. Many times, the HTML code is modified using &lt;code&gt;gsub&lt;/code&gt; and regular expressions. A few times the script writes new HTML code based on information retrieved using &lt;em&gt;rvest&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Tables are converted into &lt;em&gt;data.frames&lt;/em&gt; with &lt;code&gt;html_table&lt;/code&gt;, then converted back to HTML usint &lt;a href=&#34;https://yihui.name/knitr/&#34;&gt;&lt;em&gt;knitr&lt;/em&gt;&lt;/a&gt;’s &lt;code&gt;kable&lt;/code&gt; function. In &lt;em&gt;list&lt;/em&gt; mode, the script loops through URLs from the input file and concatenate the cleaned HTML code. At the end, the final HTML code is written in a file which is converted to EPUB by &lt;a href=&#34;http://pandoc.org/index.html&#34;&gt;Pandoc&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;other-epub-resources&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Other EPUB resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Books&lt;/strong&gt; from the &lt;a href=&#34;https://link.springer.com/bookseries/7651&#34;&gt;Methods in Molecular Biology&lt;/a&gt; series can be downloaded in the EPUB format.&lt;/li&gt;
&lt;li&gt;The &lt;a href=&#34;http://collections.plos.org/translational-bioinformatics&#34;&gt;Translational Bioinformatics collection&lt;/a&gt; in PLoS Computational Biology has &lt;a href=&#34;http://www.ploscollections.org/downloads/TranslationalBioinformatics.epub&#34;&gt;an ePub option&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;loose-ends-by-sidney-brenner&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Loose Ends by Sidney Brenner&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Added Apr 6 2019.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Sydney_Brenner&#34;&gt;Sidney Brenner&lt;/a&gt; passed away yesterday. I knew his name and that he is a legend in the field but never had the chance to really read about him. I saw this tweet from Yaniv Erlich:&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;His loose ends book was instrumental for me to get through grad school. You can read it online here:&lt;a href=&#34;https://t.co/d4Ni1vosYN&#34;&gt;https://t.co/d4Ni1vosYN&lt;/a&gt;&lt;/p&gt;&amp;mdash; Yaniv Erlich 💔 (@erlichya) &lt;a href=&#34;https://twitter.com/erlichya/status/1114107353090146304?ref_src=twsrc%5Etfw&#34;&gt;April 5, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;


&lt;p&gt;So I decided to compile &lt;a href=&#34;https://www.cell.com/current-biology/libraries/loose-ends&#34;&gt;these monthly columns from 1994-2000&lt;/a&gt; that Sidney Brenner wrote into EPUB/MOBI files to read on my ebook reader. I put the &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/blob/config/R/epubifyReviews/README.md#loose-ends-by-sidney-brenner&#34;&gt;files on GitHub&lt;/a&gt; if anyone else is interested.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Additional checks for a LaTeX manuscript</title>
          <link>/2018/04/18/check-latex-pub/</link>
          <pubDate>Wed, 18 Apr 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/04/18/check-latex-pub/</guid>
          <description>


&lt;p&gt;To continue on the series of &lt;em&gt;“Things I did instead of writing my thesis to help me write my thesis”&lt;/em&gt;, another Python script that reads a LaTeX manuscript and helps check that everything is fine. More specifically, the &lt;code&gt;checkLatex.py&lt;/code&gt; script (&lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/python/checkLatex&#34;&gt;on GitHub&lt;/a&gt;) will:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;List missing references.&lt;/li&gt;
&lt;li&gt;List multi-references to reorder.&lt;/li&gt;
&lt;li&gt;List duplicated labels.&lt;/li&gt;
&lt;li&gt;List labels that don’t start by &lt;code&gt;fig:&lt;/code&gt; or &lt;code&gt;tab:&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;List figures/tables that are not in order.&lt;/li&gt;
&lt;li&gt;List &lt;em&gt;??&lt;/em&gt;, &lt;em&gt;REF&lt;/em&gt; or &lt;em&gt;XX&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;List acronyms in italic (for gene names).&lt;/li&gt;
&lt;li&gt;List acronyms in serif (for method names).&lt;/li&gt;
&lt;li&gt;List acronyms not in italic nor in serif.&lt;/li&gt;
&lt;li&gt;Shows the first usage of each acronym (not in italic/serif).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This was particularly useful for my thesis because I combined three manuscripts and a general intro. I had to make sure that the labels, acronyms, references were all correct and consistent throughout the thesis. I might still use this again on smaller documents like research manuscripts.&lt;/p&gt;
&lt;div id=&#34;why-this-output&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Why this output?&lt;/h2&gt;
&lt;p&gt;“&lt;em&gt;List missing references&lt;/em&gt;” because &lt;code&gt;bibtex&lt;/code&gt; output was sandwiched between long latex logs and it was easy to do. “&lt;em&gt;List multi-references to reorder&lt;/em&gt;” is to transform “something&lt;sup&gt;19,3,12&lt;/sup&gt;” into “something&lt;sup&gt;3,12,19&lt;/sup&gt;”. Not a big deal but I prefer when it’s ordered…&lt;/p&gt;
&lt;p&gt;“&lt;em&gt;List duplicated labels&lt;/em&gt;” helped merge manuscripts in the thesis but won’t be very useful in general. “&lt;em&gt;List labels that don’t start by &lt;code&gt;fig:&lt;/code&gt; or &lt;code&gt;tab:&lt;/code&gt;&lt;/em&gt;” to make sure that figures and tables have labels starting with &lt;code&gt;fig:&lt;/code&gt; or &lt;code&gt;tab:&lt;/code&gt; (it helps for the next check). “&lt;em&gt;List figures/tables that are not in order&lt;/em&gt;” to make sure the figure/table numbers are in ascending order in the text. It checks for the order of labels in each file separately. That way if the supplementary material is in a separate file (using &lt;code&gt;\input&lt;/code&gt;), the supp figs are considered separately from other figures. It’s not perfect though, because the script doesn’t “understand” sub-figures.&lt;/p&gt;
&lt;p&gt;“&lt;em&gt;List ??, REF or XX&lt;/em&gt;” because that’s what I use when I’m writing and missing a number or reference.&lt;/p&gt;
&lt;p&gt;“&lt;em&gt;List acronyms in italic (for gene names)&lt;/em&gt;” to make sure that acronyms in italic are gene names. “&lt;em&gt;List acronyms in serif (for method names)&lt;/em&gt;” to make sure that acronyms in serif are methods names. “&lt;em&gt;List acronyms not in italic nor in serif&lt;/em&gt;” to check if I forgot to put a gene name in italic or a method in serif. It also helped listing the abbreviations at the beginning of the thesis. “&lt;em&gt;Shows the first usage of an acronym (not in italic/serif)&lt;/em&gt;” to make sure acronyms are defined properly.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;practical-details&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Practical details&lt;/h2&gt;
&lt;p&gt;The script &lt;strong&gt;assumes that the document is compiled&lt;/strong&gt;. For example, it will use the &lt;code&gt;.bbl&lt;/code&gt; file for the checks on the references.&lt;/p&gt;
&lt;p&gt;It will follow &lt;strong&gt;one level of &lt;code&gt;\input{}&lt;/code&gt;&lt;/strong&gt;. It was enough for my thesis: I had one &lt;code&gt;main.tex&lt;/code&gt; file with &lt;code&gt;\input&lt;/code&gt; commands calling the different chapters. It should be enough for a manuscript in general.&lt;/p&gt;
&lt;p&gt;Acronyms are defined by the regular expression &lt;code&gt;[A-Za-z0-9]*[A-Z]{2}[A-Za-z0-9]*&lt;/code&gt;, i.e. at least two consecutive uppercase letters and any letter/number around.&lt;/p&gt;
&lt;p&gt;Some arguments to switch on/off the acronym mode and internal references as explained in the help output:&lt;/p&gt;
&lt;pre class=&#34;txt&#34;&gt;&lt;code&gt;&amp;gt; python checkLatex.py -h
usage: checkLatex.py [-h] -i TEX [-inrefs] [-noacro]

Check for problems in a LaTeX manuscript.

optional arguments:
  -h, --help  show this help message and exit
  -i TEX      the input tex file
  -inrefs     list non-fig/table internal refs
  -noacro     don&amp;#39;t list acronyms&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;final-check&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Final check&lt;/h2&gt;
&lt;p&gt;I used &lt;code&gt;pdfgrep&lt;/code&gt; to check the final PDF for quotation marks that could result from missing reference/figure/table.&lt;/p&gt;
&lt;pre class=&#34;sh&#34;&gt;&lt;code&gt;pdfgrep &amp;#39;\?&amp;#39; main.pdf&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Checking text similarity between two documents</title>
          <link>/2018/04/16/text-similarity/</link>
          <pubDate>Mon, 16 Apr 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/04/16/text-similarity/</guid>
          <description>


&lt;p&gt;To start the series of &lt;em&gt;“Things I did instead of writing my thesis to help me write my thesis”&lt;/em&gt;, a small Python script that compares two text documents and output similar parts. I did that to avoid auto-plagiarism of my manuscripts’ introduction in the main thesis introduction.&lt;/p&gt;
&lt;p&gt;It’s a very naive approach but sped up the checking process (&lt;a href=&#34;https://xkcd.com/1319/&#34;&gt;maybe worth the time&lt;/a&gt;). It first looks for short exact matches between the two documents, then extends these exact matches and uses the &lt;a href=&#34;https://docs.python.org/2/library/difflib.html&#34;&gt;difflib&lt;/a&gt; module to keep text with a minimum similarity score (default 80%).&lt;/p&gt;
&lt;p&gt;I put the &lt;code&gt;simText.py&lt;/code&gt; Python script &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/python/simText&#34;&gt;on GitHub here&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;usage&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;Basic command:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;python simText.py -1 text1.txt -2 text2.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The help page:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; python simText.py -h
usage: simText.py [-h] -1 D1 -2 D2 [-k K] [-e EXT] [-s MINSIM] [-tex]

Find similar text between two documents.

optional arguments:
  -h, --help  show this help message and exit
  -1 D1       Text document 1
  -2 D2       Text document 2
  -k K        The number of char for 1st pass. Default 20
  -e EXT      The number of additional char. Default 70
  -s MINSIM   The minimum similarity to define a match. Default 0.8
  -tex        Skip LaTeX header and lines starting with %&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;latex-documents&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;LaTeX documents&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;-tex&lt;/code&gt; option skips the header in LaTeX documents and lines starting with a &lt;code&gt;%&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;python simText.py -1 text1.tex -2 text2.tex -tex&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I implemented this because the header and commented lines were annoying me in the output. More would be needed to have a good LaTeX mode but I submitted my thesis already so it will be for another time.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;playing-with-the-stringency&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Playing with the stringency&lt;/h3&gt;
&lt;p&gt;By default, the script outputs text that are &lt;strong&gt;at least 80% similar&lt;/strong&gt; (change with &lt;code&gt;-s&lt;/code&gt; argument). To run more or less stringent checks, I play with &lt;code&gt;-e&lt;/code&gt; which controls how long the 80% match must be.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;output&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;The output contains a paragraph for each match. Each paragraph has three lines with the similarity score, the text in the first document, the text in the second document, respectively. For example (with &lt;code&gt;-e 50&lt;/code&gt;):&lt;/p&gt;
&lt;pre class=&#34;txt&#34;&gt;&lt;code&gt;S:0.87
T1: tions of a genomic region, which affect DNA copy number, are collectively known as copy number varia
T2: eletions and duplications, which affect DNA copy number, are collectively known as copy number varia&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Journal comparison</title>
          <link>/2018/02/23/journals-comparison/</link>
          <pubDate>Fri, 23 Feb 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/02/23/journals-comparison/</guid>
          <description>


&lt;p&gt;&lt;em&gt;Edit Feb 24: Added variance graph and some examples of suspiciously fast publications.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Edit Feb 25: Added &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/journalPubTime&#34;&gt;script and data&lt;/a&gt; to GitHub.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Some info about journals in my field.&lt;/p&gt;
&lt;div id=&#34;summary-table&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Summary table&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;Journal&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Co.&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;IF&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;OA&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;APC&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Other fees&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pub/year&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Received-to-accepted in days. median (75th perc.)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://f1000research.com/for-authors/publish-your-research&#34;&gt;F1000Research&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://peerj.com/about/author-instructions/&#34;&gt;PeerJ&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1095 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~1290&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~88 (139)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://submit.elifesciences.org/html/elife_author_instructions.html#process&#34;&gt;eLife&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2500 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1018&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;121 (155)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://academic.oup.com/gigascience/pages/instructions_to_authors&#34;&gt;GigaScience&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;OUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2050 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~50&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~126 (195)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://journals.plos.org/plosone/s/criteria-for-publication&#34;&gt;PLoS One&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1495 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~22K&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~122 (182)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://journals.plos.org/ploscompbiol/s/journal-information&#34;&gt;PLoS Comp Bio&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2250 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~550&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~159 (217)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://journals.plos.org/plosgenetics/s/journal-information&#34;&gt;PLoS Genetics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2250 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;644&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;150 (202)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://journals.plos.org/plosbiology/s/journal-information&#34;&gt;PLoS Biology&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2900 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~176&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~141 (175)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://bmcbioinformatics.biomedcentral.com/submission-guidelines&#34;&gt;BMC Bioinformatics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC/S&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2145 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~333&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~169 (231)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://bmcgenomics.biomedcentral.com/submission-guidelines&#34;&gt;BMC Genomics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC/S&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2145 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~985&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~138 (190)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://bmcbiol.biomedcentral.com/submission-guidelines&#34;&gt;BMC Biology&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC/S&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2785 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~85&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~70 (108)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://genomebiology.biomedcentral.com/submission-guidelines&#34;&gt;Genome Biology&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC/S&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11.9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2975 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~156&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~106 (143)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.cell.com/cell-reports/authors&#34;&gt;Cell Reports&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Els&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8.3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~1005&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~168 (241)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/srep/publish/guidelines&#34;&gt;Scientific Reports&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1760 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~20K&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~104 (151)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/ncomms/submit/guide-to-authors&#34;&gt;Nature Communications&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5200 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~3519&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~168 (228)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://academic.oup.com/nar/pages/Policies&#34;&gt;NAR&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;OUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;10.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Y&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2770 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pp9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~1359&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~82 (131)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.genetics.org/content/prep-manuscript&#34;&gt;Genetics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12m/+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pp/pf/psf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~374&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~104 (163)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.cell.com/ajhg/authors&#34;&gt;AJHG&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Els&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6m/+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;850 USD + pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;237&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;89 (121)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.pnas.org/page/authors/submission&#34;&gt;PNAS&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;HWP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6m/+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1450 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1700 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://genome.cshlp.org/site/misc/ifora.xhtml&#34;&gt;Genome Research&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CSH&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11.9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6m/+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2500 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2500 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~179&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~188 (242)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.cell.com/cell/authors&#34;&gt;Cell&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Els&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;30.4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;(12m/+)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~351&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~149 (193)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thelancet.com/lancet/information-for-authors&#34;&gt;Lancet&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Els&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;47.8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6m/+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.sciencemag.org/authors/science-journals-editorial-policies&#34;&gt;Science&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AAAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;37.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12m&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;surprise&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~720&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~112 (162)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://academic.oup.com/bioinformatics/pages/instructions_for_authors&#34;&gt;Bioinformatics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;OUP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;+&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3000 USD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pp7/pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~868&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~126 (180)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;New England Journal Of Medicine&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;72.4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6m&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/nmeth/for-authors&#34;&gt;Nature Methods&lt;/a&gt;_&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;25.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;N&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~130&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~146 (187)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/ng/for-authors&#34;&gt;Nature Genetics&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;28.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;N&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;202&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;147 (203)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/nbt/for-authors&#34;&gt;Nature Biotech&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;41.7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;N&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;pp5/pf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;80&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;202 (262)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;https://www.nature.com/nature/for-authors&#34;&gt;Nature&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;40.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;N&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~855&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;~175 (246)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Open Access (OA) journal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Y&lt;/code&gt;: Yes.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;+&lt;/code&gt;: Authors can pay additional Article Processing Charges (column APC) to make it accessible immediately upon publication.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;12m&lt;/code&gt;: Articles are accessible after 12 months, either from the journal or &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pmc/&#34;&gt;PubMed Central&lt;/a&gt;/&lt;/li&gt;
&lt;li&gt;&lt;code&gt;6m&lt;/code&gt;: Articles are accessible after 6 months, either from the journal or &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pmc/&#34;&gt;PubMed Central&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;()&lt;/code&gt;: Depending on the funding agencies.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;N&lt;/code&gt;: No.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fees:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pp&lt;/code&gt;: Per page.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ppX&lt;/code&gt;: Per pages in excess of X (if more than X pages).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pf&lt;/code&gt;: Per figure.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;psf&lt;/code&gt;: Per supplementary file.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;sources&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Impact Factor for 2016/2017 from &lt;a href=&#34;http://www.bioxbio.com/if/&#34;&gt;bioxbio&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;APC from &lt;a href=&#34;https://doaj.org/&#34;&gt;Directory of Open Access Journals&lt;/a&gt;, or the journal.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;Received-to-accepted time&lt;/em&gt; and &lt;em&gt;Pub/year&lt;/em&gt; are based on articles published in 2016. After a PubMed search, the publication web-page was crawled to get the article type and dates of reception/acceptance. I considered research articles/letters/methods/reports but not reviews/editorial/perspective/erratum/opinion. Sometimes the DOI was not present in the PubMed results or there was a lot of publications to crawl so I analyzed a subset and extrapolated the numbers (&lt;code&gt;~&lt;/code&gt; marks approximated numbers). I still see some suspicious numbers (articles with very short/negative acceptance time). Hopefully the medians are still close to reality but these numbers should be taken with a grain of salt.&lt;/p&gt;
&lt;p&gt;Some data has been produced, now it’s graph time !&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;median-time-to-acceptancepublication&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Median time to acceptance/publication&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-10-15-JournalComparison_files/figure-html/time-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;median-time-to-acceptancepublication-vs-number-of-article-published&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Median time to acceptance/publication vs number of article published&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-10-15-JournalComparison_files/figure-html/timenb-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;median-time-to-acceptancepublication-vs-impact-factor&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Median time to acceptance/publication vs impact factor&lt;/h2&gt;
&lt;p&gt;I’m curious to see if it takes more time in some cases because a journal is more “picky” ?&lt;/p&gt;
&lt;p&gt;The impact factor is not a good indicator of research impact but maybe it can be a proxy for a journal’s pickiness. Looking at the correlation with the impact factor, there’s a trend (with or without the first tier journals). Still, the journals are quite spread out.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-10-15-JournalComparison_files/figure-html/timeif-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2017-10-15-JournalComparison_files/figure-html/timeif-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;variance-in-time-to-acceptance&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Variance in time to acceptance&lt;/h2&gt;
&lt;p&gt;The ranking using the 75th percentile is not so different than the one using the median.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-10-15-JournalComparison_files/figure-html/timevar-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We see some publications with suspiciously short received-to-accepted times…&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;suspiciously-short-received-to-accepted-times&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Suspiciously short received-to-accepted times&lt;/h2&gt;
&lt;p&gt;I’m not sure how each journal defines &lt;em&gt;“received”&lt;/em&gt;. Some publications have acceptance times too short to be the peer-review time.&lt;/p&gt;
&lt;p&gt;I even found two papers that have negative received-to-accepted times… In both the webpage and the PDFs, these papers were &lt;strong&gt;published 3 months before they were submitted&lt;/strong&gt;: &lt;a href=&#34;http://www.genetics.org/content/203/3/1249.article-info&#34;&gt;10.1534/genetics.115.183194&lt;/a&gt; and &lt;a href=&#34;http://www.genetics.org/content/203/3/1425.article-info&#34;&gt;10.1534/genetics.115.185181&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Anyway, looking at a few examples for each journal, some of the “fast” publications are about &lt;strong&gt;resources (databases, portal, websites)&lt;/strong&gt; which makes sense, others look like research that would require peer-review longer than a few days…&lt;/p&gt;
&lt;p&gt;For example, the “fastest” publications for each journal (among the publications I considered):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;Days to acceptance&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Journal&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Title&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Genome Biology&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1186/s13059-016-0929-9&#34;&gt;OncoNEM: inferring tumor evolution from single-cell sequencing data.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS Genet.&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1371/journal.pgen.1006521&#34;&gt;Tbx5 Buffers Inherent Left/Right Asymmetry Ensuring Symmetric Forelimb Formation.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;eLife&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.7554/eLife.21635&#34;&gt;Lysosomal membrane glycoproteins bind cholesterol and contribute to lysosomal cholesterol export.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PeerJ&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.7717/peerj.1969&#34;&gt;Ectopic expression of Jatropha curcas APETALA1 (JcAP1) caused early flowering in Arabidopsis, but not in Jatropha.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Genetics&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1534/genetics.115.183137&#34;&gt;Identifying Regulators of Morphogenesis Common to Vertebrate Neural Tube Closure and Caenorhabditis elegans Gastrulation.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NAR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1093/nar/gkv1047&#34;&gt;PDBe: improved accessibility of macromolecular structure data from PDB and EMDB.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GigaScience&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1186/s13742-016-0143-4&#34;&gt;RES-Scanner: a software package for genome-wide identification of RNA-editing sites.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS ONE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1371/journal.pone.0149986&#34;&gt;Time-Resolved Visualisation of Nearly-Native Influenza A Virus Progeny Ribonucleoproteins and Their Individual Components in Live Infected Cells.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS Biology&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1371/journal.pbio.1002480&#34;&gt;The DEAD-box Protein Rok1 Orchestrates 40S and 60S Ribosome Assembly by Promoting the Release of Rrp5 from Pre-40S Ribosomes to Allow for 60S Maturation.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC Biology&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1186/s12915-016-0253-6&#34;&gt;Nuclear fallout provides a new link between aPKC and polarized cell trafficking.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bioinformatics&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1093/bioinformatics/btv604&#34;&gt;iEnhancer-2L: a two-layer predictor for identifying enhancers and their strength by pseudo k-tuple nucleotide composition.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Science&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1126/science.aaf1835&#34;&gt;Selective conversion of syngas to light olefins.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Am J Hum Genet.&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1016/j.ajhg.2016.07.014&#34;&gt;The Power of Human Protective Modifiers: PLS3 and CORO1C Unravel Impaired Endocytosis in Spinal Muscular Atrophy and Rescue SMA Phenotype.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell Reports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1016/j.celrep.2016.08.091&#34;&gt;Structures of NS5 Methyltransferase from Zika Virus.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PLoS Comput Biol&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1371/journal.pcbi.1005041&#34;&gt;Direct Correlation between Motile Behavior and Protein Abundance in Single Cells.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nature Communications&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/ncomms10745&#34;&gt;Switchable friction enabled by nanoscale self-assembly on graphene.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Scientific Reports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/srep28849&#34;&gt;Aero-Thermo-Dynamic Mass Analysis.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;25&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nature&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/nature16536&#34;&gt;Non-classical correlations between single photons and phonons from a mechanical oscillator.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1016/j.cell.2016.11.014&#34;&gt;Atomic Structure of the Cystic Fibrosis Transmembrane Conductance Regulator.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nature Methods&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/nmeth.4031&#34;&gt;ATAC-see reveals the accessible genome by transposase-mediated imaging and sequencing.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC Genomics&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1186/s12864-016-2393-z&#34;&gt;Suboptimal culture conditions induce more deviations in gene expression in male than female bovine blastocysts.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;38&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nature Genetics&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/ng.3611&#34;&gt;Genomic analysis of 6,000-year-old cultivated grain illuminates the domestication history of barley.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;43&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;BMC Bioinformatics&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1186/s12859-016-0931-y&#34;&gt;ksRepo: a generalized platform for computational drug repositioning.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;59&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nature Biotech&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1038/nbt.3663&#34;&gt;Blood pressure regulation by CD4(+) lymphocytes expressing choline acetyltransferase.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;94&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Genome Research&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://doi.org/10.1101/gr.215293.116&#34;&gt;Large-scale reduction of the Bacillus subtilis genome: consequences for the transcriptional network, resource allocation, and metabolism.&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;script-and-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Script and data&lt;/h2&gt;
&lt;p&gt;I someone wants to do the same for other journals, I put my script &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/journalPubTime&#34;&gt;there&lt;/a&gt;. The data I used is also there in a &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/raw/config/R/journalPubTime/journalPubTime.tsv&#34;&gt;TSV file&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;good-journals&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;“Good” journals&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://elifesciences.org/&#34;&gt;eLife&lt;/a&gt; is non-profit, open and modern.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.plos.org/which-journal-is-right-for-me&#34;&gt;PLOS&lt;/a&gt; the pioneer in open-access.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.biomedcentral.com/p/the-bmc-series-journals#journallist&#34;&gt;BMC&lt;/a&gt;, although it’s owned by Springer Nature publishing group.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://f1000research.com/&#34;&gt;F1000&lt;/a&gt; where the manuscript is “published” right away and then transparently peer-reviewed. Once peer-reviewed, it is indexed in PubMed etc.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://peerj.com/&#34;&gt;PeerJ&lt;/a&gt; is about open-access and cost-efficient publishing.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;evil-publishing-companies&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;“Evil” publishing companies&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Elsevier.&lt;/li&gt;
&lt;li&gt;Springer Nature.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;further-reading&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Further reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.nature.com/news/does-it-take-too-long-to-publish-research-1.19320&#34;&gt;Does it take too long to publish research? (Nature News Feature)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.talyarkoni.org/blog/2016/12/12/why-i-still-wont-review-for-or-publish-with-elsevier-and-think-you-shouldnt-either/&#34;&gt;“Why I still won’t review for or publish with Elsevier–and think you shouldn’t either” by Tal Yarkoni&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>tSNE and clustering</title>
          <link>/2018/02/13/tsne-and-clustering/</link>
          <pubDate>Tue, 13 Feb 2018 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2018/02/13/tsne-and-clustering/</guid>
          <description>


&lt;p&gt;tSNE can give really nice results when we want to visualize many groups of multi-dimensional points. Once the 2D graph is done we might want to identify which points cluster in the tSNE blobs.&lt;/p&gt;
&lt;p&gt;Using simulated and real data, I’ll try different methods:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Hierarchical clustering&lt;/li&gt;
&lt;li&gt;K-means&lt;/li&gt;
&lt;li&gt;Gaussian mixture&lt;/li&gt;
&lt;li&gt;Density-based clustering&lt;/li&gt;
&lt;li&gt;Louvain community detection.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;TL;DR&lt;/strong&gt; If &amp;lt;30K points, hierarchical clustering is robust, easy to use and with reasonable computing time. KNN + Louvain is fast and works well in general.&lt;/p&gt;
&lt;hr /&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(dplyr)
library(magrittr)
library(ggrepel)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data&lt;/h2&gt;
&lt;div id=&#34;normally-distributed-points&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Normally distributed points&lt;/h3&gt;
&lt;p&gt;First, I’ll simulate an easy situation with 10 different groups. 5,000 points are distributed following Gaussian distributions in 100 dimensions. Points are randomly assigned a group. For each group, 3 dimensions are randomly selected and the points shifted.&lt;/p&gt;
&lt;p&gt;Because there are 10 groups that differ in different dimensions, a PCA shouldn’t be able to separate all the groups with the first two components. That’s when the tSNE comes in to do its magic (easily).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123456)
N = 5000
D = 100
data.norm = matrix(rnorm(N * D, 2), N)
groups.probs = runif(10)
groups = sample(1:10, N, TRUE, groups.probs/sum(groups.probs))
for (gp in unique(groups)) {
    dev = rep(1, D)
    dev[sample.int(D, 3)] = runif(3, -10, 10)
    data.norm[which(groups == gp), ] = data.norm[which(groups == 
        gp), ] %*% diag(dev)
}
info.norm = tibble(truth = factor(groups))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The PCA and tSNE look like this:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pca.norm = prcomp(data.norm)
info.norm %&amp;lt;&amp;gt;% cbind(pca.norm$x[, 1:4])
ggplot(info.norm, aes(x = PC1, y = PC2, colour = truth)) + 
    geom_point(alpha = 0.3) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/pcatsne-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(info.norm, aes(x = PC3, y = PC4, colour = truth)) + 
    geom_point(alpha = 0.3) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/pcatsne-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We see something but it’s not so clear, let’s run the tSNE.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(Rtsne)
tsne.norm = Rtsne(pca.norm$x, pca = FALSE)
info.norm %&amp;lt;&amp;gt;% mutate(tsne1 = tsne.norm$Y[, 1], tsne2 = tsne.norm$Y[, 
    2])
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = truth)) + 
    geom_point(alpha = 0.3) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/tsne-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 83.76 s&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;real-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Real data&lt;/h3&gt;
&lt;p&gt;As a real-life example, I use the data that motivated this exploration. It contains a bit more than 26K points and the tSNE looks like that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tsne.real = read.csv(&amp;quot;https://docs.google.com/uc?id=1KArwfOd5smzuCsrpgW9Xpf9I06VOW4ga&amp;amp;export=download&amp;quot;)
info.real = tsne.real
ggplot(tsne.real, aes(x = tsne1, y = tsne2)) + geom_point(alpha = 0.1) + 
    theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/real-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;hierarchical-clustering&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Hierarchical clustering&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Once built, it’s fast to try different number clusters.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Different linkage criteria to match the behavior we want.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Doesn’t scale well. High memory usage and computation time when &amp;gt;30K.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hc.norm = hclust(dist(tsne.norm$Y))
info.norm$hclust = factor(cutree(hc.norm, 9))
hc.norm.cent = info.norm %&amp;gt;% group_by(hclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = hclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = hclust), 
    data = hc.norm.cent) + guides(colour = FALSE) + 
    ggtitle(&amp;quot;Linkage criterion: Complete&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/hcnorm-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hc.norm = hclust(dist(tsne.norm$Y), method = &amp;quot;ward.D&amp;quot;)
info.norm$hclust = factor(cutree(hc.norm, 9))
hc.norm.cent = info.norm %&amp;gt;% group_by(hclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = hclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = hclust), 
    data = hc.norm.cent) + guides(colour = FALSE) + 
    ggtitle(&amp;quot;Linkage criterion: Ward&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/hcnorm-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Now on real data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hc.real = hclust(dist(tsne.real))
info.real$hclust = factor(cutree(hc.real, 18))
hc.real.cent = info.real %&amp;gt;% group_by(hclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = hclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = hclust), 
    data = hc.real.cent) + guides(colour = FALSE) + 
    ggtitle(&amp;quot;Linkage criterion: Complete&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/hcreal-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hc.real = hclust(dist(tsne.real), method = &amp;quot;ward.D&amp;quot;)
info.real$hclust = factor(cutree(hc.real, 18))
hc.real.cent = info.real %&amp;gt;% group_by(hclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = hclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = hclust), 
    data = hc.real.cent) + guides(colour = FALSE) + 
    ggtitle(&amp;quot;Linkage criterion: Ward&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/hcreal2-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 38.01 s&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;For both data, Ward gives the best clusters. For example it splits the top-left clusters better in the real data.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;kmeans&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Kmeans&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Very fast.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Simple.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;km.norm = kmeans(tsne.norm$Y, 9, nstart = 100)
info.norm$kmeans = factor(km.norm$cluster)
km.cent = info.norm %&amp;gt;% group_by(kmeans) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = kmeans)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = kmeans), 
    data = km.cent) + guides(colour = FALSE) + ggtitle(&amp;quot;9 clusters&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/kmnorm-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;km.norm = kmeans(tsne.norm$Y, 10, nstart = 100)
info.norm$kmeans = factor(km.norm$cluster)
km.cent = info.norm %&amp;gt;% group_by(kmeans) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = kmeans)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = kmeans), 
    data = km.cent) + guides(colour = FALSE) + ggtitle(&amp;quot;10 clusters&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/kmnorm-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Because it’s not working well for cluster that are not “round”, we need to ask for more clusters. In practice we’ll need to merge back together the clusters that were fragmented.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123456)
km.real = kmeans(tsne.real, 24, nstart = 200, iter.max = 100)
info.real$kmeans = factor(km.real$cluster)
km.cent = info.real %&amp;gt;% group_by(kmeans) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = kmeans)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = kmeans), 
    data = km.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/kmreal-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Not perfect in the middle-left big cluster: cluster 11 is grabbing points from the bottom blob. Maybe increasing the number of clusters could fix this?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123456)
km.real = kmeans(tsne.real, 25, nstart = 200, iter.max = 100)
info.real$kmeans = factor(km.real$cluster)
km.cent = info.real %&amp;gt;% group_by(kmeans) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = kmeans)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = kmeans), 
    data = km.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/kmrealmore-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 15.48 s&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Better. Same as with the other methods: we need to manually tweak the parameters to obtain the clustering we want…&lt;/p&gt;
&lt;p&gt;Note: using several starting points help getting more robust results (&lt;code&gt;nstart=&lt;/code&gt;). Increasing the number of iterations helps too (&lt;code&gt;iter.max=&lt;/code&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mclust&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mclust&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Better clusters.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Can find the best K (number of clusters (although slowly).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Slow.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Need to be recomputed for each choice of K (number of clusters).&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(mclust)
mc.norm = Mclust(tsne.norm$Y, 9)
info.norm$mclust = factor(mc.norm$classification)
mc.cent = info.norm %&amp;gt;% group_by(mclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = mclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = mclust), 
    data = mc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/mcnorm-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Even the elongated cluster is nicely identified and we don’t need to split it.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123456)
mc.real = Mclust(tsne.real, 20, initialization = list(subset = sample.int(nrow(tsne.real), 
    1000)))
info.real$mclust = factor(mc.real$classification)
mc.cent = info.real %&amp;gt;% group_by(mclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = mclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = mclust), 
    data = mc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/mcreal-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Sometimes the results are a bit surprising. For example, points are assigned to cluster far away or there is another cluster in between (e.g. clusters 6 and 17). As usual changing the number of clusters helps.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123456)
mc.real = Mclust(tsne.real, 24, initialization = list(subset = sample.int(nrow(tsne.real), 
    1000)))
info.real$mclust = factor(mc.real$classification)
mc.cent = info.real %&amp;gt;% group_by(mclust) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = mclust)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = mclust), 
    data = mc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/mcreal2-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 90.61 s&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Note: I had to use the sub-sampling trick to speed up the process, otherwise it was taking too long. Using &lt;code&gt;initialization=list(subset=sample.int(nrow(tsne.real), 1000))&lt;/code&gt;, only a thousand points are used for the EM (but all the points are assigned to a cluster at the end).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;density-based-clustering&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Density-based clustering&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;+&lt;/strong&gt; Can find clusters with different “shapes”.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Bad on real/noisy data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-&lt;/strong&gt; Slow when many points.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(fpc)
ds.norm = dbscan(tsne.norm$Y, 2)
info.norm$density = factor(ds.norm$cluster)
ds.cent = info.norm %&amp;gt;% group_by(density) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = density)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = density), 
    data = ds.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/densnorm-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Woah, it found the small cluster !&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ds.real = dbscan(tsne.real, 1)
info.real$density = factor(ds.real$cluster)
ds.cent = info.real %&amp;gt;% group_by(density) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = density)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = density), 
    data = ds.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/densreal-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 100.98 s&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ouch…&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;knn-graph-and-louvain-community-detection&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;KNN graph and Louvain community detection&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(igraph)
library(FNN)
k = 100
knn.norm = get.knn(as.matrix(tsne.norm$Y), k = k)
knn.norm = data.frame(from = rep(1:nrow(knn.norm$nn.index), 
    k), to = as.vector(knn.norm$nn.index), weight = 1/(1 + 
    as.vector(knn.norm$nn.dist)))
nw.norm = graph_from_data_frame(knn.norm, directed = FALSE)
nw.norm = simplify(nw.norm)
lc.norm = cluster_louvain(nw.norm)
info.norm$louvain = as.factor(membership(lc.norm))
lc.cent = info.norm %&amp;gt;% group_by(louvain) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = louvain)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = louvain), 
    data = lc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/louvnorm-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Playing with the resolution parameter we can get more/less communities. For &lt;code&gt;gamma=.3&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lc.norm = cluster_louvain(nw.norm, gamma = 0.3)
info.norm$louvain = as.factor(membership(lc.norm))
lc.cent = info.norm %&amp;gt;% group_by(louvain) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.norm, aes(x = tsne1, y = tsne2, colour = louvain)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = louvain), 
    data = lc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/gamma-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;On real data and using &lt;code&gt;gamma=.1&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k = 100
knn.real = get.knn(as.matrix(tsne.real), k = k)
knn.real = data.frame(from = rep(1:nrow(knn.real$nn.index), 
    k), to = as.vector(knn.real$nn.index), weight = 1/(1 + 
    as.vector(knn.real$nn.dist)))
nw.real = graph_from_data_frame(knn.real, directed = FALSE)
nw.real = simplify(nw.real)
lc.real = cluster_louvain(nw.real, gamma = 0.1)
info.real$louvain = as.factor(membership(lc.real))
lc.cent = info.real %&amp;gt;% group_by(louvain) %&amp;gt;% select(tsne1, 
    tsne2) %&amp;gt;% summarize_all(mean)
ggplot(info.real, aes(x = tsne1, y = tsne2, colour = louvain)) + 
    geom_point(alpha = 0.3) + theme_bw() + geom_label_repel(aes(label = louvain), 
    data = lc.cent) + guides(colour = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-12-01-tSNEclustering_files/figure-html/louvreal-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Time for this code chunk: 18.86 s&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Pretty good.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;PS:&lt;/em&gt; I added the resolution parameter &lt;code&gt;gamma&lt;/code&gt; in the &lt;em&gt;igraph&lt;/em&gt; function for the Louvain clustering. While it was easy to change in the C code, compiling &lt;em&gt;igraph&lt;/em&gt; from source was a pain. I couldn’t get it to work on OSX but I managed to install this modified version of igraph on Linux (see &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/tree/config/R/rigraph_gammalouvain&#34;&gt;instructions&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;If not too many points or too many groups, &lt;strong&gt;hierarchical clustering&lt;/strong&gt; might be enough. Especially with the Ward criterion, it worked well for both simulated and real data. Once the hierarchy is built, it’s fast to try different values for the number of clusters. Also, in the real data, I could get satisfactory results using a lower number of clusters than for the K-means (18 vs 25).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;If there are too many points&lt;/strong&gt; (e.g. &amp;gt;30K), hierarchical clustering might be too demanding and I would fall back to &lt;strong&gt;KNN+Louvain&lt;/strong&gt;. It’s fast enough and the results are pretty good.&lt;/p&gt;
&lt;p&gt;The more advanced methods are good to keep in mind if the points ever form diverse or unusual shapes.&lt;/p&gt;
&lt;p&gt;I learned two &lt;strong&gt;tricks to improve the performance&lt;/strong&gt; of the methods: increasing the number of iterations and starting points for the K-means, and sub-sampling for the EM clustering.&lt;/p&gt;
&lt;p&gt;Clustering points from the tSNE is good to explore the groups that we visually see in the tSNE but &lt;strong&gt;if we want more meaningful clusters&lt;/strong&gt; we could run these methods &lt;strong&gt;in the PC space directly&lt;/strong&gt;. The KNN + Louvain community clustering, for example, is used in single cell sequencing analysis.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Bibliography style for AJHG</title>
          <link>/2017/10/04/bibliography-style-for-ajhg/</link>
          <pubDate>Wed, 04 Oct 2017 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2017/10/04/bibliography-style-for-ajhg/</guid>
          <description>


&lt;p&gt;I couldn’t find an up-to-date/working &lt;strong&gt;LaTeX bibliography style for the American Journal of Human Genetics (AJHG)&lt;/strong&gt;. The output from &lt;code&gt;unsrtnat&lt;/code&gt; (my goto style) was also quite different from what the journal wanted.&lt;/p&gt;
&lt;p&gt;I found a bibliography style for &lt;em&gt;Cell&lt;/em&gt; which is almost what AJHG wants, but I also wanted the references to be &lt;strong&gt;ordered by their appearance in the text&lt;/strong&gt; (like for &lt;code&gt;unsrtnat&lt;/code&gt;) and not alphabetically. So I downloaded both &lt;code&gt;cell.bst&lt;/code&gt; (&lt;a href=&#34;https://www.ctan.org/tex-archive/macros/latex/contrib/cell&#34;&gt;here&lt;/a&gt;) and &lt;code&gt;unsrtnat.bst&lt;/code&gt; (&lt;a href=&#34;https://www.ctan.org/tex-archive/macros/latex/contrib/natbib/&#34;&gt;here&lt;/a&gt;) files and merged them. I don’t understand all the details but after some trial-and-errors it seems to work.&lt;/p&gt;
&lt;p&gt;After merging, I removed the &lt;em&gt;emphasis&lt;/em&gt; on the Journal/Book name which was the only difference I could see between the Cell and AJHG styles.&lt;/p&gt;
&lt;p&gt;I also added some code to &lt;strong&gt;automatically compress long author lists&lt;/strong&gt; into “&lt;em&gt;et al.&lt;/em&gt;”. In the code, the line with &lt;code&gt;max.num.names.before.forced.et.al&lt;/code&gt; specifies the maximum number of authors before switching to “&lt;em&gt;et al.&lt;/em&gt;”. The line with &lt;code&gt;num.names.shown.with.forced.et.al&lt;/code&gt; specifies how many authors to show when using &lt;em&gt;et al.&lt;/em&gt;. They are both set at 10, following AJHG guidelines.&lt;/p&gt;
&lt;p&gt;The final &lt;code&gt;ajhg.bst&lt;/code&gt; file can be found &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/blob/config/LaTeX/ajhg.bst&#34;&gt;here&lt;/a&gt;. I used it with &lt;code&gt;\usepackage[comma,super]{natbib}&lt;/code&gt;.&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>MUMmerplots with ggplot2</title>
          <link>/2017/09/19/mummerplots-with-ggplot2/</link>
          <pubDate>Tue, 19 Sep 2017 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2017/09/19/mummerplots-with-ggplot2/</guid>
          <description>


&lt;p&gt;&lt;em&gt;Update Oct 28 2018: added reference id (rid) to be able to visualize multiple reference regions. Also uploaded the example data somewhere.&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(magrittr)
library(GenomicRanges)
library(knitr)
library(ggplot2)
library(tidyr)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;mummer-plot&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;MUMmer plot&lt;/h2&gt;
&lt;p&gt;The MUMmer plot that I want to reproduce showed three contigs overlapping a region of chr 14. I had filtered the delta file with &lt;code&gt;delta-filter -l 10000 -q -r&lt;/code&gt; to get only the contigs with the best alignments. I had used &lt;code&gt;mummerplot&lt;/code&gt; with the &lt;code&gt;-l&lt;/code&gt; layout option to reorder and orient the sequences to have a nice diagonal.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/mumplot-example.png&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;delta-file&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Delta file&lt;/h2&gt;
&lt;p&gt;The delta file is the default output of the &lt;a href=&#34;http://mummer.sourceforge.net/manual/#nucmer&#34;&gt;NUCmer alignment script&lt;/a&gt;. The format of the delta file is described more &lt;a href=&#34;http://mummer.sourceforge.net/manual/#nucmeroutput&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The delta file used in this post can be downloaded &lt;a href=&#34;https://www.dropbox.com/s/3zscsbbex6rgemo/mumplot-example.delta?dl=0&#34;&gt;here&lt;/a&gt;. Otherwise, in R:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if(!file.exists(&amp;#39;mumplot-example.delta&amp;#39;)){
    download.file(&amp;#39;https://dl.dropboxusercontent.com/s/3zscsbbex6rgemo/mumplot-example.delta?dl0&amp;#39;,
                  &amp;#39;mumplot-example.delta&amp;#39;)
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;read-a-delta-file&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Read a delta file&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;readDelta &amp;lt;- function(deltafile){
  lines = scan(deltafile, &amp;#39;a&amp;#39;, sep=&amp;#39;\n&amp;#39;, quiet=TRUE)
  lines = lines[-1]
  lines.l = strsplit(lines, &amp;#39; &amp;#39;)
  lines.len = lapply(lines.l, length) %&amp;gt;% as.numeric
  lines.l = lines.l[lines.len != 1]
  lines.len = lines.len[lines.len != 1]
  head.pos = which(lines.len == 4)
  head.id = rep(head.pos, c(head.pos[-1], length(lines.l)+1)-head.pos)
  mat = matrix(as.numeric(unlist(lines.l[lines.len==7])), 7)
  res = as.data.frame(t(mat[1:5,]))
  colnames(res) = c(&amp;#39;rs&amp;#39;,&amp;#39;re&amp;#39;,&amp;#39;qs&amp;#39;,&amp;#39;qe&amp;#39;,&amp;#39;error&amp;#39;)
  res$qid = unlist(lapply(lines.l[head.id[lines.len==7]], &amp;#39;[&amp;#39;, 2))
  res$rid = unlist(lapply(lines.l[head.id[lines.len==7]], &amp;#39;[&amp;#39;, 1)) %&amp;gt;% gsub(&amp;#39;^&amp;gt;&amp;#39;, &amp;#39;&amp;#39;, .)
  res$strand = ifelse(res$qe-res$qs &amp;gt; 0, &amp;#39;+&amp;#39;, &amp;#39;-&amp;#39;)
  res
}

mumgp = readDelta(&amp;quot;mumplot-example.delta&amp;quot;)

mumgp %&amp;gt;% head %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;rs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;re&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qe&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;error&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;qid&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;rid&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;strand&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;265577&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;265842&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;108520&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;108254&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;265577&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;265842&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;106438&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;106172&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;306695&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;306968&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138241&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138515&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1016956&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1017364&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27806&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27394&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1723715&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1723990&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34123&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33845&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1767531&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1767813&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33842&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34123&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Contig0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;+&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;filter-contigs-with-poor-alignments&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Filter contigs with poor alignments&lt;/h2&gt;
&lt;p&gt;For now, I filter contigs simply based on the size of the aligned segment. I keep only contigs with at least one aligned segment larger than a minimum size. Smaller alignment in these contigs are kept if in the same range as the large aligned segments. Eventually, I could also filter segment based on the number/proportion of errors.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;filterMum &amp;lt;- function(df, minl=1000, flanks=1e4){
    coord = df %&amp;gt;% filter(abs(re-rs)&amp;gt;minl) %&amp;gt;% group_by(qid, rid) %&amp;gt;%
        summarize(qsL=min(qs)-flanks, qeL=max(qe)+flanks, rs=median(rs)) %&amp;gt;%
        ungroup %&amp;gt;% arrange(desc(rs)) %&amp;gt;%
        mutate(qid=factor(qid, levels=unique(qid))) %&amp;gt;% select(-rs)
    merge(df, coord) %&amp;gt;% filter(qs&amp;gt;qsL, qe&amp;lt;qeL) %&amp;gt;%
        mutate(qid=factor(qid, levels=levels(coord$qid))) %&amp;gt;% select(-qsL, -qeL)
}

mumgp.filt = filterMum(mumgp, minl=1e4)
mumgp.filt %&amp;gt;% head %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;qid&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;rid&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;rs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;re&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qe&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;error&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;strand&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1663946&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1665485&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;331648&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;330113&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;171&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1662200&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1684396&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;126037&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;103837&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;234&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1581333&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1582738&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;244635&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;243233&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1597381&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1610746&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;145948&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132626&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;157&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1610278&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1623358&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;130561&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;117468&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;200&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Contig1475&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chr14:105095800-107043718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1616542&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1618080&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;331648&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;330113&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;graph&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Graph&lt;/h2&gt;
&lt;p&gt;I’m going for the same style as &lt;code&gt;mummerplot&lt;/code&gt; to compare.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(mumgp.filt, aes(x=rs, xend=re, y=qs, yend=qe, colour=strand)) + geom_segment() +
    geom_point(alpha=.5) + facet_grid(qid~., scales=&amp;#39;free&amp;#39;, space=&amp;#39;free&amp;#39;, switch=&amp;#39;y&amp;#39;) +
    theme_bw() + theme(strip.text.y=element_text(angle=180, size=5),
                       legend.position=c(.99,.01), legend.justification=c(1,0),
                       strip.background=element_blank(),
                       axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
    xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;assembly&amp;#39;) + scale_colour_brewer(palette=&amp;#39;Set1&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/graph-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Not bad but it would look nicer if we flipped the contigs to have more or less a diagonal.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;diagonalize&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Diagonalize&lt;/h2&gt;
&lt;p&gt;For each contig, I compute the major strand (strand with most bases aligned) and flip if necessary. The contigs are also ordered based on the reference region with most bases and the weighted means of the start position in this matched reference region.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;diagMum &amp;lt;- function(df){
    ## Find best qid order
    rid.o = df %&amp;gt;% group_by(qid, rid) %&amp;gt;% summarize(base=sum(abs(qe-qs)),
                                                    rs=weighted.mean(rs, abs(qe-qs))) %&amp;gt;%
        ungroup %&amp;gt;% arrange(desc(base)) %&amp;gt;% group_by(qid) %&amp;gt;% do(head(., 1)) %&amp;gt;%
        ungroup %&amp;gt;% arrange(desc(rid), desc(rs)) %&amp;gt;%
        mutate(qid=factor(qid, levels=unique(qid)))
    ## Find best qid strand
    major.strand = df %&amp;gt;% group_by(qid) %&amp;gt;%
        summarize(major.strand=ifelse(sum(sign(qe-qs)*abs(qe-qs))&amp;gt;0, &amp;#39;+&amp;#39;, &amp;#39;-&amp;#39;),
                  maxQ=max(c(qe, qs)))
    merge(df, major.strand) %&amp;gt;% mutate(qs=ifelse(major.strand==&amp;#39;-&amp;#39;, maxQ-qs, qs),
                                       qe=ifelse(major.strand==&amp;#39;-&amp;#39;, maxQ-qe, qe),
                                       qid=factor(qid, levels=levels(rid.o$qid)))
}

mumgp.filt.diag = diagMum(mumgp.filt)

ggplot(mumgp.filt.diag, aes(x=rs, xend=re, y=qs, yend=qe, colour=strand)) +
    geom_segment() + geom_point(alpha=.5) + theme_bw() + 
    facet_grid(qid~., scales=&amp;#39;free&amp;#39;, space=&amp;#39;free&amp;#39;, switch=&amp;#39;y&amp;#39;) +
    theme(strip.text.y=element_text(angle=180, size=5), strip.background=element_blank(),
          legend.position=c(.99,.01), legend.justification=c(1,0),
          axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
    xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;assembly&amp;#39;) + scale_colour_brewer(palette=&amp;#39;Set1&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/diag-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;What we were aiming at:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;./imgs/mumplot-example.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;Pretty good.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;To also represent multiple reference regions in separate facets, change the &lt;em&gt;facet_grid&lt;/em&gt; commands. Here we have only one reference region but the command would be:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(mumgp.filt.diag, aes(x=rs, xend=re, y=qs, yend=qe, colour=strand)) +
    geom_segment() + geom_point(alpha=.5) + theme_bw() + 
    facet_grid(qid~rid, scales=&amp;#39;free&amp;#39;, space=&amp;#39;free&amp;#39;, switch=&amp;#39;y&amp;#39;) +
    theme(strip.text.y=element_text(angle=180, size=5), strip.background=element_blank(),
          legend.position=c(.99,.01), legend.justification=c(1,0),
          axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
    xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;assembly&amp;#39;) + scale_colour_brewer(palette=&amp;#39;Set1&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/rid-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;See also &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/issues/2&#34;&gt;this GitHub issue&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;percent-identity-and-coverage&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Percent identity and coverage&lt;/h2&gt;
&lt;p&gt;Another useful MUMmerplot represents the position of each aligned segment and its percent similarity.&lt;/p&gt;
&lt;p&gt;This graph could be useful to decide which size/similarity threshold to use when filtering low alignments.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mumgp %&amp;lt;&amp;gt;% mutate(similarity=1-error/abs(qe-qs))
mumgp.filt %&amp;lt;&amp;gt;% mutate(similarity=1-error/abs(qe-qs))

ggplot(mumgp, aes(x=rs, xend=re, y=similarity, yend=similarity)) + geom_segment() +
    theme_bw() + xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;similarity&amp;#39;) + ggtitle(&amp;#39;All contigs&amp;#39;) +
    ylim(0,1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simgraph-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(mumgp.filt, aes(x=rs, xend=re, y=similarity, yend=similarity)) + geom_segment() +
    theme_bw() + xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;similarity&amp;#39;) +
    ggtitle(&amp;#39;At least 10 Kbp aligned&amp;#39;) + ylim(0,1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simgraph-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;To better highlighted which region in the reference is covered, I annotate each base of the reference with the maximum similarity.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;maxSimilarityDisjoin &amp;lt;- function(df){
  ref.ir = GRanges(&amp;#39;X&amp;#39;, IRanges(df$rs, df$re), similarity=df$similarity)
  ## Efficient clean up of low similarity within high similarity
  step = 1
  while(step&amp;gt;0){
    largealign = ref.ir[head(order(rank(-ref.ir$similarity), rank(-width(ref.ir))),step*1000)]
    ol = findOverlaps(ref.ir, largealign, type=&amp;#39;within&amp;#39;) %&amp;gt;% as.data.frame %&amp;gt;%
        mutate(simW=ref.ir$similarity[queryHits],
               simL=largealign$similarity[subjectHits]) %&amp;gt;% filter(simW&amp;lt;simL)
    if(length(largealign) == length(ref.ir)){
      step = 0
    } else {
      step = step + 1
    }
    ref.ir = ref.ir[-ol$queryHits]
  }
  ## Disjoin and annotate with the max similarity
  ref.dj = disjoin(c(ref.ir, GRanges(&amp;#39;X&amp;#39;, IRanges(min(df$rs), max(df$rs)), similarity=0)))
  ol = findOverlaps(ref.ir, ref.dj) %&amp;gt;% as.data.frame %&amp;gt;%
      mutate(similarity=ref.ir$similarity[queryHits]) %&amp;gt;%
      group_by(subjectHits) %&amp;gt;% summarize(similarity=max(similarity))
  ref.dj$similarity = 0
  ref.dj$similarity[ol$subjectHits] = ol$similarity
  as.data.frame(ref.dj)
}

mumgp.sim = maxSimilarityDisjoin(mumgp)

mumgp.sim %&amp;gt;% select(similarity, start, end) %&amp;gt;% gather(end, pos, 2:3) %&amp;gt;%
    ggplot() + geom_line(aes(x=pos, y=similarity), alpha=.5, color=&amp;#39;red&amp;#39;) + theme_bw() +
    xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;similarity&amp;#39;) + ggtitle(&amp;#39;All contigs&amp;#39;) + ylim(0,1) +
    geom_segment(aes(x=rs, xend=re, y=similarity, yend=similarity), data=mumgp)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simcov-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(mumgp.sim) + geom_segment(aes(x=start, xend=end, yend=similarity, y=similarity),
                                 color=&amp;#39;red&amp;#39;, size=2) +
    theme_bw() + xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;similarity&amp;#39;) + ylim(0,1) +
    geom_segment(aes(x=rs, xend=re, y=similarity, yend=similarity), data=mumgp)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simcov-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;With this graph we could compare different assemblies or before/after filtering:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mumgp.filt.sim = maxSimilarityDisjoin(mumgp.filt)

mumgp.filt.m = rbind(mumgp.sim %&amp;gt;% mutate(filter=&amp;#39;before&amp;#39;),
                     mumgp.filt.sim %&amp;gt;% mutate(filter=&amp;#39;after&amp;#39;))

mumgp.filt.m %&amp;gt;% select(similarity, start, end, filter) %&amp;gt;% gather(end, pos, 2:3) %&amp;gt;%
    ggplot(aes(x=pos, y=similarity, colour=filter)) + geom_line(alpha=.8) + theme_bw() +
    xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;similarity&amp;#39;) + ylim(0,1) +
    scale_colour_brewer(palette=&amp;#39;Set1&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simcovcomp-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Not so pretty but we see that a few region are not covered any more after our filtering. Maybe something like this instead :&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mumgp.filt.m %&amp;gt;% filter(similarity==0) %&amp;gt;%
    ggplot(aes(x=start, xend=end, y=filter, yend=filter)) + geom_segment(size=10) +
    theme_bw() + xlab(&amp;#39;reference sequence&amp;#39;) + ylab(&amp;#39;filter&amp;#39;) +
    scale_colour_brewer(palette=&amp;#39;Set1&amp;#39;) + ggtitle(&amp;#39;Reference regions not covered&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-19-MumplotsWithGgplot2_files/figure-html/simcovcomptrack-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Regression sandbox</title>
          <link>/2017/09/16/regression-sandbox/</link>
          <pubDate>Sat, 16 Sep 2017 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2017/09/16/regression-sandbox/</guid>
          <description>


&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(broom)
library(magrittr)
library(dplyr)
library(knitr)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;logistic-regression&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Logistic regression&lt;/h2&gt;
&lt;div id=&#34;one-way-or-another&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;a href=&#34;https://youtu.be/4kg9LasvLFE&#34;&gt;One way or another&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If we have two binary variables and we want to see if they are associated we could use a logistic regression. How do we decide which variable to be the predictor and which variable to observed variable ?&lt;/p&gt;
&lt;p&gt;In theory there shouldn’t be any differences but let’s check with a dummy example:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df = data.frame(x = sample(c(FALSE, TRUE), 100, TRUE))
df$y = df$x
df$y[1:70] = sample(c(FALSE, TRUE), 70, TRUE)

glm(y ~ x, data = df, family = binomial()) %&amp;gt;% tidy %&amp;gt;% 
    kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2336149&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3070802&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.7607617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4467994&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;xTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.1745982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4256623&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.7594604&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0057897&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glm(x ~ y, data = df, family = binomial()) %&amp;gt;% tidy %&amp;gt;% 
    kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.4054651&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3227486&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.256288&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2090117&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;yTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.1745982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4256624&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.759460&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0057897&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df$z = runif(100)
glm(y ~ x + z, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.5930811&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5436028&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.0910191&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2752645&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;xTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.2012521&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4293265&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.7979921&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0051421&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;z&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6601875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8199692&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8051369&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4207407&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glm(x ~ y + z, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1246648&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5141828&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2424523&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8084297&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;yTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.1996170&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4291206&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.7955243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0051816&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;z&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.5586854&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8023449&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.6963157&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4862311&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Adding another predictor doesn’t change the estimates either.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;interpretation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Interpretation&lt;/h3&gt;
&lt;p&gt;Just to make sure I understand the estimates correctly. It represents the log odds ratio change for each “unit” of the predictor. In the case of a binary variable, the log odds ratio between the two groups.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glm(y ~ x, data = df, family = binomial()) %&amp;gt;% tidy %&amp;gt;% 
    kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2336149&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3070802&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.7607617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4467994&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;xTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.1745982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4256623&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.7594604&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0057897&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;odds.y.ifx = mean(subset(df, x)$y)/mean(!subset(df, 
    x)$y)
odds.y.ifnotx = mean(subset(df, !x)$y)/mean(!subset(df, 
    !x)$y)
log(odds.y.ifx/odds.y.ifnotx)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1.174598&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;extreme-cases&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Extreme cases&lt;/h3&gt;
&lt;p&gt;How efficient is the logistic regression when there is an imbalance between different types of observations ? For example if just a few genomic regions overlap an interesting annotation and I want to test is the overlap is significant.&lt;/p&gt;
&lt;p&gt;Let’s look at the worst cases when there are only 1 observation for a particular class.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df = data.frame(y = sample(c(FALSE, TRUE), 100, TRUE))
df$x = 1:nrow(df) %in% sample.int(nrow(df), 1)
glm(y ~ x, data = df, family = binomial()) %&amp;gt;% tidy %&amp;gt;% 
    kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1010961&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2012644&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5023050&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6154530&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;xTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.4649721&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1455.3975462&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0106259&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9915219&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Although the significance is low, the estimate seems quite high. I’ll repeat this process a bunch of time and with different number of supporting observations to have an idea of the distribution.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ext.df = lapply(1:500, function(ii) {
    res = lapply(1:10, function(ssi) {
        df$x = 1:nrow(df) %in% sample.int(nrow(df), 
            ssi)
        glm(y ~ x, data = df, family = binomial()) %&amp;gt;% 
            tidy %&amp;gt;% mutate(rep = ii, ss = ssi)
    })
    do.call(rbind, res)
})
ext.df = do.call(rbind, ext.df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ext.df %&amp;gt;% filter(term == &amp;quot;xTRUE&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate)) + 
    geom_density(fill = &amp;quot;grey50&amp;quot;) + facet_grid(ss ~ 
    ., scales = &amp;quot;free&amp;quot;) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-16-Regression_files/figure-html/lrextsimgraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It seems like the estimate “inflation” is problematic mostly when there are only 1 or 2 supporting observations. If there are more than 5 supporting observations the estimate is correctly centered in 0.&lt;/p&gt;
&lt;p&gt;This problem is in fact called the &lt;a href=&#34;https://en.wikipedia.org/wiki/Separation_(statistics)&#34;&gt;problem of separation&lt;/a&gt;. There are two approaches to deal with it:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Firth logistic regression.&lt;/li&gt;
&lt;li&gt;Exact logistic regression.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The &lt;a href=&#34;https://cran.r-project.org/web/packages/rms/index.html&#34;&gt;&lt;code&gt;rms&lt;/code&gt; package&lt;/a&gt; from &lt;a href=&#34;http://www.fharrell.com/2017/01/introduction.html&#34;&gt;Frank Harell&lt;/a&gt;. It implements a penalized maximum likelihood estimation of the model coefficients through the &lt;code&gt;lrm&lt;/code&gt; function which has a &lt;code&gt;penalty=&lt;/code&gt; parameter.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rms)
extrms.df = lapply(1:200, function(ii) {
    res = lapply(1:10, function(ssi) {
        res = lapply(c(1, 3, 5), function(pen) {
            df$x = 1:nrow(df) %in% sample.int(nrow(df), 
                ssi)
            cc = lrm(y ~ x, data = df, penalty = pen)$coefficient
            data.frame(term = names(cc), estimate = cc, 
                rep = ii, ss = ssi, penalty = pen, 
                stringsAsFactors = FALSE)
        })
        do.call(rbind, res)
    })
    do.call(rbind, res)
})
extrms.df = do.call(rbind, extrms.df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;extrms.df %&amp;gt;% filter(term == &amp;quot;x&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate)) + 
    geom_density(fill = &amp;quot;grey50&amp;quot;) + facet_grid(ss ~ 
    penalty, scales = &amp;quot;free&amp;quot;) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-16-Regression_files/figure-html/lrmsgraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It definitely helps: the estimates are now much closer to 0. I don’t see much difference between penalties 1, 3 or 5.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&#34;https://cran.r-project.org/web/packages/logistf/index.html&#34;&gt;&lt;code&gt;logistf&lt;/code&gt; package&lt;/a&gt;. It implements Firth’s bias reduction method with its &lt;code&gt;logistf&lt;/code&gt; function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(logistf)
extstf.df = lapply(1:200, function(ii) {
    res = lapply(1:10, function(ssi) {
        df$x = 1:nrow(df) %in% sample.int(nrow(df), 
            ssi)
        cc = logistf(y ~ x, data = df)$coefficient
        data.frame(term = names(cc), estimate = cc, 
            rep = ii, ss = ssi, stringsAsFactors = FALSE)
    })
    do.call(rbind, res)
})
extstf.df = do.call(rbind, extstf.df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;extstf.df %&amp;gt;% filter(term == &amp;quot;xTRUE&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate)) + 
    geom_density(fill = &amp;quot;grey50&amp;quot;) + facet_grid(ss ~ 
    ., scales = &amp;quot;free&amp;quot;) + theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-16-Regression_files/figure-html/lrreggraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This works well too.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;more-advanced-models&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;More advanced models&lt;/h2&gt;
&lt;p&gt;A dummy example with some code for Generalized Additive Models, LOESS and SVM.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nb.samp = 1000
df = data.frame(x = runif(nb.samp, 0, 100))
df$y = rnorm(nb.samp, 0, 5) + abs(df$x - 25)
df$y = ifelse(df$x &amp;gt; 40, rnorm(nb.samp, 0, 5) - df$x * 
    df$x/300 + 20, df$y)
ggplot(df, aes(x = x, y = y)) + geom_point(alpha = 0.5) + 
    theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-16-Regression_files/figure-html/blm-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glm.o = glm(y ~ x, data = df)
loess.o = loess(y ~ x, data = df)
library(mgcv)
gam.o = gam(y ~ s(x, bs = &amp;quot;cs&amp;quot;), data = df)
library(e1071)
svm.o = svm(y ~ x, data = df)

pred.df = rbind(df %&amp;gt;% mutate(y = predict(glm.o), model = &amp;quot;glm&amp;quot;), 
    df %&amp;gt;% mutate(y = predict(gam.o), model = &amp;quot;gam&amp;quot;), 
    df %&amp;gt;% mutate(y = predict(loess.o), model = &amp;quot;LOESS&amp;quot;), 
    df %&amp;gt;% mutate(y = predict(svm.o), model = &amp;quot;SVM&amp;quot;))

ggplot(df, aes(x = x, y = y)) + geom_point(alpha = 0.2) + 
    geom_line(aes(colour = model), size = 2, alpha = 0.9, 
        data = pred.df) + theme_bw() + scale_colour_brewer(palette = &amp;quot;Set1&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-16-Regression_files/figure-html/blmmodels-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Enrichment between genomic regions</title>
          <link>/2017/09/05/enrichment-between-genomic-regions/</link>
          <pubDate>Tue, 05 Sep 2017 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2017/09/05/enrichment-between-genomic-regions/</guid>
          <description>


&lt;p&gt;Testing if two sets of genomic regions overlap significantly is not straightforward. In the simple situation of regions of 1 bp (e.g. SNVs) we could use a hypergeometric test. When the regions are small enough and there are not too many, the hypergeometric test might also be a fair approximation.&lt;/p&gt;
&lt;p&gt;But when we manipulate many regions of variable size covering the entire genome it’s not as straightforward. The gene annotation is an example. The repeat annotation is even worse as it covers almost 50% of the genome and contains different families with very different size/location profiles.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(dplyr)
library(magrittr)
library(broom)
library(knitr)
library(tidyr)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;simulated-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simulated data&lt;/h2&gt;
&lt;p&gt;In a very simple scenario of having only one chromosome of size 250 Mbp.&lt;/p&gt;
&lt;p&gt;First let’s create a function that draw random regions (ranges) in this chromosome.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(IRanges)
randRegions &amp;lt;- function(sizes, max.pos = 2.5e+08, max.iter = 10) {
    gr = IRanges(runif(length(sizes), 0, max.pos - 
        sizes), width = sizes)
    dup = which(countOverlaps(gr, gr) &amp;gt; 1)
    iter = 1
    while (iter &amp;lt;= max.iter &amp;amp; length(dup) &amp;gt; 0) {
        gr[dup] = IRanges(runif(length(dup), 0, max.pos - 
            sizes[dup]), width = sizes[dup])
        dup = which(countOverlaps(gr, gr) &amp;gt; 1)
    }
    return(gr)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now some regions will be our “repeats”: 10,000 regions from size 10 bp to 6 Kbp.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rep.r = randRegions(runif(10000, 10, 6000))
sum(width(rep.r))/2.5e+08&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.1196666&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;They cover 11.97% of the chromosome.&lt;/p&gt;
&lt;p&gt;Now if we have another set of regions and we want to know how much they overlap with the repeats we could use the hypergeometric test. With this test we assume that we are sampling bases in the genome and testing if it’s covered by a repeat. In that sense, we expect 11.97% of our regions to overlap a repeat. If we compare random regions there shouldn’t be a significant overlap and the distribution of the P-value should be flat.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;testHG &amp;lt;- function(feat.r, nb = 1000, size = 1, nb.test = 3000, 
    total.b = 2.5e+08) {
    exp.b = sum(width(feat.r))
    sapply(1:nb.test, function(ii) {
        reg.r = randRegions(rep(size, nb))
        obs.ol = sum(overlapsAny(reg.r, feat.r))
        phyper(obs.ol, exp.b, total.b - exp.b, length(reg.r), 
            lower.tail = FALSE)
    })
}

ht.sim = rbind(data.frame(nb = 1000, size = 1, pv = testHG(rep.r, 
    1000, 1)), data.frame(nb = 1000, size = 1000, pv = testHG(rep.r, 
    1000, 1000)), data.frame(nb = 100, size = 1000, 
    pv = testHG(rep.r, 100, 1000)), data.frame(nb = 1000, 
    size = 100, pv = testHG(rep.r, 1000, 100)))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ht.sim %&amp;gt;% mutate(nbsize = paste0(nb, &amp;quot; x &amp;quot;, size, 
    &amp;quot;bp&amp;quot;)) %&amp;gt;% group_by(nbsize) %&amp;gt;% arrange(pv) %&amp;gt;% 
    mutate(cumprop = (1:n())/n()) %&amp;gt;% ggplot(aes(x = pv, 
    y = cumprop, color = nbsize)) + geom_line() + theme_bw() + 
    geom_abline(linetype = 2) + ylab(&amp;quot;cumulative proportion&amp;quot;) + 
    xlab(&amp;quot;P-value&amp;quot;) + scale_color_brewer(palette = &amp;quot;Set1&amp;quot;, 
    name = &amp;quot;regions&amp;quot;) + theme(legend.justification = c(1, 
    0), legend.position = c(0.99, 0.01))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/testhggraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As expected, the hypergeometric test works well for region of 1 bp. Otherwise the distribution of the P-values is biased. The larger the regions the stronger the bias. To a lower extent, more regions also means more bias.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;using-control-regions-with-similar-features&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Using control regions with similar features&lt;/h2&gt;
&lt;p&gt;We want to control for the size distribution and the total number of regions tested. Instead of the hypergeometric test, we can get control regions and compare their overlap with the actual regions, using a logistic regression for example. The control regions must be randomly distributed in the genome but have the same size distribution as our original regions. In the logistic regression we compare the two binary variables: overlapping a repeat or not, being an original region or a control region.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;testLR &amp;lt;- function(feat.r, nb = 1000, size = 1, nb.test = 3000) {
    sapply(1:nb.test, function(ii) {
        reg.r = randRegions(rep(size, nb))
        cont.r = randRegions(width(reg.r))
        df = rbind(data.frame(region = TRUE, ol = overlapsAny(reg.r, 
            feat.r)), data.frame(region = FALSE, ol = overlapsAny(cont.r, 
            feat.r)))
        pvs = glm(ol ~ region, data = df, family = binomial()) %&amp;gt;% 
            tidy %&amp;gt;% .$p.value
        pvs[2]
    })
}

lr.sim = rbind(data.frame(nb = 1000, size = 1, pv = testLR(rep.r, 
    1000, 1)), data.frame(nb = 1000, size = 1000, pv = testLR(rep.r, 
    1000, 1000)), data.frame(nb = 100, size = 1000, 
    pv = testLR(rep.r, 100, 1000)), data.frame(nb = 1000, 
    size = 100, pv = testLR(rep.r, 1000, 100)))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lr.sim %&amp;gt;% mutate(nbsize = paste0(nb, &amp;quot; x &amp;quot;, size, 
    &amp;quot;bp&amp;quot;)) %&amp;gt;% group_by(nbsize) %&amp;gt;% arrange(pv) %&amp;gt;% 
    mutate(cumprop = (1:n())/n()) %&amp;gt;% ggplot(aes(x = pv, 
    y = cumprop, color = nbsize)) + geom_line() + theme_bw() + 
    geom_abline(linetype = 2) + ylab(&amp;quot;cumulative proportion&amp;quot;) + 
    xlab(&amp;quot;P-value&amp;quot;) + scale_color_brewer(palette = &amp;quot;Set1&amp;quot;, 
    name = &amp;quot;regions&amp;quot;) + theme(legend.justification = c(1, 
    0), legend.position = c(0.99, 0.01))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/contreggraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The distribution of the P-values is much better.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;controlling-for-correlated-features&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Controlling for correlated features&lt;/h2&gt;
&lt;p&gt;In the genome, the distribution of genes, repeats, functional regions, and others is not random. Different types of elements tend to be found together while others don’t. For example some repeats are located in GC-rich regions and others in AT-rich regions. Transposable elements don’t overlap exonic regions much. Their are hotspots of segmental duplications.&lt;/p&gt;
&lt;p&gt;Sometimes we want to control for the overlap with one (or more) genomic features to test the independent association of another. For example, we known copy number variants (CNVs) are enriched in segmental duplications and transposable elements are also enriched in segmental duplications. We might want to test if CNVs are independently enriched in regions with transposable elements, controlling for the overlap with segmental duplications.&lt;/p&gt;
&lt;p&gt;I tried to simulate a first set of regions that significantly overlaps our repeats and another one that significantly overlaps the first set. That way we should see a significant overlap with repeat when we test them separately, but the second one should be significant when we control for the first one.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;corRegions &amp;lt;- function(sizes, feat.r, or = 2, max.iter = 10, 
    max.pos = 2.5e+08) {
    reg.r = randRegions(sizes)
    for (ii in 1:or) {
        reg.r = c(reg.r[overlapsAny(reg.r, feat.r)], 
            randRegions(sizes))
    }
    dup = which(countOverlaps(reg.r, reg.r) &amp;gt; 1)
    sizes = width(reg.r)
    iter = 1
    while (iter &amp;lt;= max.iter &amp;amp; length(dup) &amp;gt; 0) {
        reg.r[dup] = IRanges(runif(length(dup), 0, 
            max.pos - sizes[dup]), width = sizes[dup])
        dup = which(countOverlaps(reg.r, reg.r) &amp;gt; 1)
    }
    reg.r
}

## First set of regions
repcor.r = corRegions(rep(10000, 1000), rep.r)
cont.r = randRegions(width(repcor.r))
df = rbind(data.frame(region = TRUE, ol = overlapsAny(repcor.r, 
    rep.r)), data.frame(region = FALSE, ol = overlapsAny(cont.r, 
    rep.r)))
glm(ol ~ region, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2375323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0464770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.11075&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3e-07&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8549335&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0670786&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.74525&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0e+00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Second set of regions
seed.r = randRegions(rep(10000, 6000))
seed.ol = overlapsAny(seed.r, repcor.r)
repcorcor.r = c(seed.r[seed.ol], seed.r[head(which(!seed.ol), 
    sum(!seed.ol) * 0.05)])
cont.r = randRegions(width(repcorcor.r))
df = rbind(data.frame(region = TRUE, ol = overlapsAny(repcorcor.r, 
    rep.r)), data.frame(region = FALSE, ol = overlapsAny(cont.r, 
    rep.r)))
glm(ol ~ region, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2231436&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0590620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-3.778125&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001580&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2214209&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0832684&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.659123&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0078344&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div id=&#34;extending-the-logistic-regression-model&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Extending the logistic regression model&lt;/h3&gt;
&lt;p&gt;One strategy is to add a variable in the model that represents the effect we want to control for.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df = rbind(data.frame(region = TRUE, ol = overlapsAny(repcorcor.r, 
    rep.r), repcor = overlapsAny(repcorcor.r, repcor.r)), 
    data.frame(region = FALSE, ol = overlapsAny(cont.r, 
        rep.r), repcor = overlapsAny(cont.r, repcor.r)))
glm(ol ~ region + repcor, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2817899&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0612109&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.6035936&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000042&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0452678&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1093757&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.4138742&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6789663&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;repcorTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4156934&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1096425&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.7913531&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001498&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;As expected, adding a variable in the model controls for this.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;better-control-regions&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Better control regions&lt;/h3&gt;
&lt;p&gt;Another approach is to control the specific overlap in the control regions. We want to force our control regions to overlap as much with the feature as the original regions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;randRegionsCons &amp;lt;- function(reg.r, feat.r, nb.seed = 1e+06) {
    seed.r = randRegions(rep(1, nb.seed))
    dist.df = distanceToNearest(seed.r, feat.r) %&amp;gt;% 
        as.data.frame
    reg.ol = overlapsAny(reg.r, feat.r)
    res.r = lapply(unique(width(reg.r)), function(size) {
        size.ii = which(width(reg.r) == size)
        res.r = IRanges()
        if (sum(reg.ol[size.ii]) &amp;gt; 0) {
            seed.ii = dist.df %&amp;gt;% filter(distance &amp;lt; 
                size/2) %&amp;gt;% .$queryHits %&amp;gt;% sample(sum(reg.ol[size.ii]))
            res.r = c(res.r, resize(seed.r[seed.ii], 
                size, fix = &amp;quot;center&amp;quot;))
        }
        if (sum(!reg.ol[size.ii]) &amp;gt; 0) {
            seed.ii = dist.df %&amp;gt;% filter(distance &amp;gt; 
                size/2) %&amp;gt;% .$queryHits %&amp;gt;% sample(sum(!reg.ol[size.ii]))
            res.r = c(res.r, resize(seed.r[seed.ii], 
                size, fix = &amp;quot;center&amp;quot;))
        }
        res.r
    })
    do.call(c, res.r)
}

contSize.r = randRegionsCons(repcorcor.r, repcor.r)
df = rbind(data.frame(region = TRUE, ol = overlapsAny(repcorcor.r, 
    rep.r), repcor = overlapsAny(repcorcor.r, repcor.r)), 
    data.frame(region = FALSE, ol = overlapsAny(contSize.r, 
        rep.r), repcor = overlapsAny(contSize.r, repcor.r)))
glm(ol ~ region, data = df, family = binomial()) %&amp;gt;% 
    tidy %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1709578&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0589111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.901961&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0037083&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1726805&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0831615&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.076448&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0378526&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It works too. One benefit of this approach is its interpretability: we can directly compare summary metrics using the control regions, e.g. like the proportion of regions overlapping repeats.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(overlapsAny(repcorcor.r, repcor.r))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.7812231&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(overlapsAny(cont.r, repcor.r))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.1395349&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(overlapsAny(contSize.r, repcor.r))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.7812231&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This could be useful in situation with extreme overlap distribution. If only a few regions overlap the feature in the simple control regions, the regression might not correct for it as well as if forcing the control regions to be similar. Maybe there would some differences in power in those cases ?&lt;/p&gt;
&lt;p&gt;However building these control regions can become computationally intense, especially if the sizes of the regions vary and several features need to be controlled.&lt;/p&gt;
&lt;p&gt;In practice I would do both: include the variable in the regression model and use regions with controlled overlap.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;comparing-different-sets&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Comparing different sets&lt;/h2&gt;
&lt;p&gt;What if we need to compare sets of regions &lt;em&gt;A&lt;/em&gt; and &lt;em&gt;B&lt;/em&gt; with a third one &lt;em&gt;C&lt;/em&gt;. If the &lt;em&gt;A&lt;/em&gt; and &lt;em&gt;B&lt;/em&gt; are comparable in term of size and total number we could directly compare the overlap or an enrichment estimate (e.g. model estimate). If &lt;em&gt;A&lt;/em&gt; and &lt;em&gt;B&lt;/em&gt; have different size distribution or just total number of regions, these estimates may not be directly comparable. If they both overlap significantly with &lt;em&gt;C&lt;/em&gt;, the previous test (control regions + logistic regression) should test them significant. Even the P-value might be affected by the difference in size/number between the two sets. But how should we compared them ? Which interpretable metric could we use to compare enrichment of two different sets or regions ?&lt;/p&gt;
&lt;p&gt;A practical example would be two catalogs of CNVs, say from two different methods, that we want to compare to a functional annotation. If one catalogs has more CNVs, or has larger CNVs, how can we say which one overlaps better with the functional annotation ?&lt;/p&gt;
&lt;p&gt;I simulate this scenario and compare a few metrics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The fold-change in overlap proportion: proportion overlapping / proportion overlapping in control regions.&lt;/li&gt;
&lt;li&gt;The diff-change in overlap proportion: proportion overlapping - proportion overlapping in control regions.&lt;/li&gt;
&lt;li&gt;The logistic regression estimate which are log odds ratio.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Well, the main question was how should I simulate this. I ended up simulating two sets with similar odds ratio so we already know which metric will work better… One of the value of simulation is to force us to define the question. Or at least think about it. In this example, forcing two different sets to have similar odds ratio seemed more natural than trying to double the proportion for example. The odds ratio seems more fair to me and might avoid the situation where we are more likely to observe a large effect size just because the regions are rarer/smaller.&lt;/p&gt;
&lt;p&gt;Using a set of functional regions, I will try to compare a set of small CNVs and large CNVs. We expect more of the large CNVs to overlap the functional regions by chance.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fun.r = randRegions(rep(10, 30000))
cnv.sm = randRegions(rep(1000, 1000))
cnv.lg = randRegions(rep(10000, 1000))
mean(overlapsAny(cnv.sm, fun.r))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.112&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(overlapsAny(cnv.lg, fun.r))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.688&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;testLR &amp;lt;- function(reg.r, feat.r) {
    cont.r = randRegions(width(reg.r))
    df.sm = rbind(data.frame(region = TRUE, ol = overlapsAny(reg.r, 
        feat.r)), data.frame(region = FALSE, ol = overlapsAny(cont.r, 
        feat.r)))
    rbind(data.frame(term = &amp;quot;fold-change&amp;quot;, estimate = mean(overlapsAny(reg.r, 
        feat.r))/mean(overlapsAny(cont.r, feat.r)), 
        p.value = NA), data.frame(term = &amp;quot;diff-change&amp;quot;, 
        estimate = mean(overlapsAny(reg.r, feat.r)) - 
            mean(overlapsAny(cont.r, feat.r)), p.value = NA), 
        glm(ol ~ region, data = df.sm, family = binomial()) %&amp;gt;% 
            tidy %&amp;gt;% select(term, estimate, p.value))
}

metrics.df = rbind(testLR(cnv.sm, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.sm&amp;quot;), 
    testLR(cnv.lg, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.lg&amp;quot;))
metrics.df %&amp;gt;% filter(term != &amp;quot;(Intercept)&amp;quot;) %&amp;gt;% select(region, 
    term, estimate) %&amp;gt;% kable&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;region&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.sm&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fold-change&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0566038&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.sm&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;diff-change&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0060000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.sm&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0617938&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.lg&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;fold-change&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9745042&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.lg&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;diff-change&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0180000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;cnv.lg&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regionTRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0852498&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div id=&#34;no-association&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;No association&lt;/h3&gt;
&lt;p&gt;If the CNVs are not enriched in the functional regions, how do the three metrics compare ?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;null.df = lapply(1:1000, function(ii) {
    cnv.sm = randRegions(rep(1000, 1000))
    cnv.lg = randRegions(rep(10000, 1000))
    rbind(testLR(cnv.sm, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.sm&amp;quot;, 
        rep = ii), testLR(cnv.lg, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.lg&amp;quot;, 
        rep = ii))
})
null.df = do.call(rbind, null.df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;null.df %&amp;gt;% filter(term == &amp;quot;regionTRUE&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 0) + ggtitle(&amp;quot;log odds ratio&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvnoassocgraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;null.df %&amp;gt;% filter(term == &amp;quot;fold-change&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 1) + ggtitle(&amp;quot;fold-change&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvnoassocgraph-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;null.df %&amp;gt;% filter(term == &amp;quot;diff-change&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 0) + ggtitle(&amp;quot;diff-change&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvnoassocgraph-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The three metrics are centered in 0 but the variance of the fold-change metric is much higher for the small CNVs.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;association&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Association&lt;/h3&gt;
&lt;p&gt;If the odds of overlapping the functional regions are doubled.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;asso.df = lapply(1:1000, function(ii) {
    cnv.sm = randRegions(rep(1000, 1000))
    cnv.lg = randRegions(rep(10000, 1000))
    cnv.sm = c(cnv.sm[overlapsAny(cnv.sm, fun.r)], 
        randRegions(rep(1000, 1000)))
    cnv.lg = c(cnv.lg[overlapsAny(cnv.lg, fun.r)], 
        randRegions(rep(10000, 1000)))
    rbind(testLR(cnv.sm, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.sm&amp;quot;, 
        rep = ii), testLR(cnv.lg, fun.r) %&amp;gt;% mutate(region = &amp;quot;cnv.lg&amp;quot;, 
        rep = ii))
})
asso.df = do.call(rbind, asso.df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;asso.df %&amp;gt;% filter(term == &amp;quot;regionTRUE&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 0) + ggtitle(&amp;quot;log odds ratio&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvassocgraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;asso.df %&amp;gt;% filter(term == &amp;quot;fold-change&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 1) + ggtitle(&amp;quot;fold-change&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvassocgraph-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;asso.df %&amp;gt;% filter(term == &amp;quot;diff-change&amp;quot;) %&amp;gt;% ggplot(aes(x = estimate, 
    colour = region)) + geom_density() + theme_bw() + 
    geom_vline(xintercept = 0) + ggtitle(&amp;quot;diff-change&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-09-05-GenomicRegionEnrichment_files/figure-html/cnvassocgraph-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As expected by construction, only the logistic regression estimate are similar. If we used the fold-change metric it would look like the small CNVs are more enriched; with the diff-change metric the large CNVs would.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Conservation to annotate large(r) regions</title>
          <link>/2017/02/25/conservation-to-annotate-larger-regions/</link>
          <pubDate>Sat, 25 Feb 2017 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2017/02/25/conservation-to-annotate-larger-regions/</guid>
          <description>


&lt;p&gt;Conservation can be used to annotate single nucleotide changes or short variants. This information helps assessing the functional impact of short variation.&lt;/p&gt;
&lt;p&gt;What if we have larger variants, for example deletions larger than 50 bp, or larger than 1 kbp. Can we use conservation metrics? In this case the question is often not &lt;em&gt;“Is the region conserved?”&lt;/em&gt; but rather &lt;em&gt;“Is there any conserved elements in the region?”&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;One approach would be to overlap the variants/deletions with known (ultra-)conserved regions. Otherwise we could work with bp-level conservation estimates. That’s what I quickly explore below.&lt;/p&gt;
&lt;div id=&#34;genomic-annotation-and-conservation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Genomic annotation and conservation&lt;/h2&gt;
&lt;p&gt;I’ll have a look at regions &lt;strong&gt;overlapping&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Insulator region: CTCF binding sites (GM12878 narrow peaks by the Broad)&lt;/li&gt;
&lt;li&gt;Open chromatin regions: DNase sites (GM12878 narrow peaks by the Broad for Encode)&lt;/li&gt;
&lt;li&gt;Protein-coding exons.&lt;/li&gt;
&lt;li&gt;Other “exons” (e.g. lncRNA, miRNA, pseudogenes, … but not protein-coding)&lt;/li&gt;
&lt;li&gt;Other, i.e. none of the above&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PhastCons gives a conservation score for each base pair. As a measure across a region I try to use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the average&lt;/li&gt;
&lt;li&gt;the 80th percentile&lt;/li&gt;
&lt;li&gt;the maximum average in short windows (e.g. 10 bp, 30 bp or 100 bp)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The quantile and sliding-window approaches should mitigate the effect of surrounding background noise.&lt;/p&gt;
&lt;div id=&#34;kbp-regions&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1 Kbp regions&lt;/h3&gt;
&lt;p&gt;First fragmenting the genome into 1 kbp regions, I select bins from the different annotation profiles.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-4-2.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-4-3.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-4-4.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-4-5.png&#34; width=&#34;1440&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The sliding-window approach gives the best results where we can really see different distributions for the different types of regions. Using the average across the region, the conservation distributions are similar, likely because the studied region is larger than the conserved element so there is a majority of background conservation scores.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;kbp-regions-1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;50 Kbp regions&lt;/h3&gt;
&lt;p&gt;Same for larger regions.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-5-2.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-5-3.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-5-4.png&#34; width=&#34;1440&#34; /&gt;&lt;img src=&#34;./post/2017-02-25-RegionConservation_files/figure-html/unnamed-chunk-5-5.png&#34; width=&#34;1440&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;Using the average conservation might be good for short regions (e.g. 10s-100s bp) but is not useful for large regions. We can do a bit better by using the 80th percentile of the scores, focusing on the long tail of scores in the region. A better approach yet seems to be using the maximum score across sliding windows. For 1 kbp regions, we could differentiate functional classes using windows of size 100 bp.&lt;/p&gt;
&lt;p&gt;This kind of metric work only work for regions that are not too large. As the 50 kbp experiment shows, when the input regions get too big, it’s difficult to see much differences because all regions have some conserved sequence somewhere.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Segmental duplication exploration</title>
          <link>/2016/10/20/segmental-duplication-exploration/</link>
          <pubDate>Thu, 20 Oct 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/10/20/segmental-duplication-exploration/</guid>
          <description>


&lt;div id=&#34;segmental-duplications-sd&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Segmental Duplications (SD)&lt;/h2&gt;
&lt;p&gt;I downloaded the segmental duplication annotation for hg19 from &lt;a href=&#34;http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/genomicSuperDups.txt.gz&#34;&gt;UCSC&lt;/a&gt;. There are 51599 annotated SD. They are defined as regions larger than 1 Kbp with at least 90% similarity with another region in the genome.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;segmental-duplication-regions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Segmental duplication regions&lt;/h2&gt;
&lt;p&gt;Many SD are nested of located next to each other. I merge overlapping SDs (or located at &amp;lt;10 bp) to create &lt;em&gt;SD regions&lt;/em&gt;, i.e. longer stretch of the genome overlapping SDs.&lt;/p&gt;
&lt;p&gt;There are 7620 SD regions, that account for 166.1 Mbp of the genome.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;size-distribution&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Size distribution&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/size-1.png&#34; width=&#34;768&#34; /&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/size-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;similarity&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Similarity&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/sim-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;chromosome-distribution&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Chromosome distribution&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/chr-1.png&#34; width=&#34;768&#34; /&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/chr-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;A few chromosomes are more enriched in SD. Some have long stretches of SD, e.g. chr 9 or chr Y. These peaks are mostly created with very recent/similar SDs.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;distance-to-the-other-segment&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Distance to the other segment&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;otherSeg&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;segdup&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;segdup.prop&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;different chr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32740&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.635&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;same chr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18859&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.365&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-10-20-SegDupExploration_files/figure-html/dist-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For the majority of SDs, the similar region is in a different chromosome. For the others the majority are far from each other.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;gene-content&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Gene content&lt;/h2&gt;
&lt;p&gt;I downloaded Gencode v19 at &lt;a href=&#34;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&#34;&gt;&lt;a href=&#34;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&#34; class=&#34;uri&#34;&gt;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&lt;/a&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Around a thousand protein-coding genes are completely within SD regions.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene_type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gene&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3968&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;958&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;lincRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;641&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;miRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;301&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;antisense&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;181&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;179&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;misc_RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;rRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;processed_transcript&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_intronic&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snoRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_D_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;polymorphic_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_overlapping&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div id=&#34;gene-families&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Gene families&lt;/h3&gt;
&lt;p&gt;A naive way of looking for gene families is to cluster the gene names. I also remove any trailing numbers in the gene name.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;example&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PRAMEF&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;USP17L&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ZNF&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GOLGA8I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NBPF&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CT47B&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;POTEF&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;OR2T&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;gene-ontology&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Gene Ontology&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Description&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GeneRatio&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qvalue&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0050907&#34; class=&#34;uri&#34;&gt;GO:0050907&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;detection of chemical stimulus involved in sensory perception&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;57/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0009593&#34; class=&#34;uri&#34;&gt;GO:0009593&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;detection of chemical stimulus&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;58/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0007606&#34; class=&#34;uri&#34;&gt;GO:0007606&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;sensory perception of chemical stimulus&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;59/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0007608&#34; class=&#34;uri&#34;&gt;GO:0007608&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;sensory perception of smell&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;53/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0050911&#34; class=&#34;uri&#34;&gt;GO:0050911&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;detection of chemical stimulus involved in sensory perception of smell&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;51/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0050906&#34; class=&#34;uri&#34;&gt;GO:0050906&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;detection of stimulus involved in sensory perception&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;57/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042742&#34; class=&#34;uri&#34;&gt;GO:0042742&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;defense response to bacterium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;23/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002887&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0098542&#34; class=&#34;uri&#34;&gt;GO:0098542&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;defense response to other organism&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;35/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002887&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0071346&#34; class=&#34;uri&#34;&gt;GO:0071346&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cellular response to interferon-gamma&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;17/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002992&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006805&#34; class=&#34;uri&#34;&gt;GO:0006805&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;xenobiotic metabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002992&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0071466&#34; class=&#34;uri&#34;&gt;GO:0071466&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cellular response to xenobiotic stimulus&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004487&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0033141&#34; class=&#34;uri&#34;&gt;GO:0033141&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;positive regulation of peptidyl-serine phosphorylation of STAT protein&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004487&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0002323&#34; class=&#34;uri&#34;&gt;GO:0002323&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;natural killer cell activation involved in immune response&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005222&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0033139&#34; class=&#34;uri&#34;&gt;GO:0033139&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regulation of peptidyl-serine phosphorylation of STAT protein&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005486&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0009410&#34; class=&#34;uri&#34;&gt;GO:0009410&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;response to xenobiotic stimulus&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0007752&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0034341&#34; class=&#34;uri&#34;&gt;GO:0034341&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;response to interferon-gamma&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;17/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0012694&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006749&#34; class=&#34;uri&#34;&gt;GO:0006749&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;glutathione metabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;10/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0014056&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042501&#34; class=&#34;uri&#34;&gt;GO:0042501&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;serine phosphorylation of STAT protein&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0019334&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0016579&#34; class=&#34;uri&#34;&gt;GO:0016579&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein deubiquitination&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0035460&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0060337&#34; class=&#34;uri&#34;&gt;GO:0060337&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;type I interferon signaling pathway&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0040381&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0071357&#34; class=&#34;uri&#34;&gt;GO:0071357&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cellular response to type I interferon&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0040381&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006342&#34; class=&#34;uri&#34;&gt;GO:0006342&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chromatin silencing&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0046589&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0034340&#34; class=&#34;uri&#34;&gt;GO:0034340&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;response to type I interferon&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0058697&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0030101&#34; class=&#34;uri&#34;&gt;GO:0030101&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;natural killer cell activation&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;10/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0090640&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0070646&#34; class=&#34;uri&#34;&gt;GO:0070646&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein modification by small protein removal&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0114298&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0009812&#34; class=&#34;uri&#34;&gt;GO:0009812&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;flavonoid metabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0138310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0033559&#34; class=&#34;uri&#34;&gt;GO:0033559&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;unsaturated fatty acid metabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0138310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0000042&#34; class=&#34;uri&#34;&gt;GO:0000042&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein targeting to Golgi&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0138310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0019373&#34; class=&#34;uri&#34;&gt;GO:0019373&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;epoxygenase P450 pathway&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0138310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0045814&#34; class=&#34;uri&#34;&gt;GO:0045814&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;negative regulation of gene expression, epigenetic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0138310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0060338&#34; class=&#34;uri&#34;&gt;GO:0060338&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regulation of type I interferon-mediated signaling pathway&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0139433&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006690&#34; class=&#34;uri&#34;&gt;GO:0006690&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;icosanoid metabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0144589&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0009813&#34; class=&#34;uri&#34;&gt;GO:0009813&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;flavonoid biosynthetic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0165692&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006959&#34; class=&#34;uri&#34;&gt;GO:0006959&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;humoral immune response&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;15/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0202359&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0002228&#34; class=&#34;uri&#34;&gt;GO:0002228&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;natural killer cell mediated immunity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0226821&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006334&#34; class=&#34;uri&#34;&gt;GO:0006334&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;nucleosome assembly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0227629&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0006968&#34; class=&#34;uri&#34;&gt;GO:0006968&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cellular defense response&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0232698&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0052696&#34; class=&#34;uri&#34;&gt;GO:0052696&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;flavonoid glucuronidation&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0232698&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0072600&#34; class=&#34;uri&#34;&gt;GO:0072600&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;establishment of protein localization to Golgi&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0232698&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0043330&#34; class=&#34;uri&#34;&gt;GO:0043330&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;response to exogenous dsRNA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0234523&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0001906&#34; class=&#34;uri&#34;&gt;GO:0001906&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell killing&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0249099&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0001580&#34; class=&#34;uri&#34;&gt;GO:0001580&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;detection of chemical stimulus involved in sensory perception of bitter taste&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0322850&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0052695&#34; class=&#34;uri&#34;&gt;GO:0052695&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cellular glucuronidation&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0331023&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042737&#34; class=&#34;uri&#34;&gt;GO:0042737&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;drug catabolic process&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0378567&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0000301&#34; class=&#34;uri&#34;&gt;GO:0000301&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;retrograde transport, vesicle recycling within Golgi&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0389140&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0031497&#34; class=&#34;uri&#34;&gt;GO:0031497&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chromatin assembly&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/509&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0483266&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Description&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GeneRatio&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qvalue&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0004984&#34; class=&#34;uri&#34;&gt;GO:0004984&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;olfactory receptor activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;51/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0016712&#34; class=&#34;uri&#34;&gt;GO:0016712&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oxidoreductase activity, acting on paired donors, with incorporation or reduction of molecular oxygen, reduced flavin or flavoprotein as one donor, and incorporation of one atom of oxygen&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000499&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0005132&#34; class=&#34;uri&#34;&gt;GO:0005132&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;type I interferon receptor binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000499&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0008391&#34; class=&#34;uri&#34;&gt;GO:0008391&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;arachidonic acid monooxygenase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002238&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0008392&#34; class=&#34;uri&#34;&gt;GO:0008392&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;arachidonic acid epoxygenase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002238&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0036459&#34; class=&#34;uri&#34;&gt;GO:0036459&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;thiol-dependent ubiquitinyl hydrolase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002238&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0101005&#34; class=&#34;uri&#34;&gt;GO:0101005&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ubiquitinyl hydrolase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002238&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0008395&#34; class=&#34;uri&#34;&gt;GO:0008395&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;steroid hydroxylase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002715&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0019825&#34; class=&#34;uri&#34;&gt;GO:0019825&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oxygen binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004195&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0019783&#34; class=&#34;uri&#34;&gt;GO:0019783&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ubiquitin-like protein-specific protease activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005119&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0003823&#34; class=&#34;uri&#34;&gt;GO:0003823&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;antigen binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0007524&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0004497&#34; class=&#34;uri&#34;&gt;GO:0004497&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;monooxygenase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0008659&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0070330&#34; class=&#34;uri&#34;&gt;GO:0070330&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;aromatase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0009112&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0020037&#34; class=&#34;uri&#34;&gt;GO:0020037&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;heme binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0029793&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0048020&#34; class=&#34;uri&#34;&gt;GO:0048020&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CCR chemokine receptor binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0030635&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0019864&#34; class=&#34;uri&#34;&gt;GO:0019864&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IgG binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0038146&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0046906&#34; class=&#34;uri&#34;&gt;GO:0046906&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;tetrapyrrole binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0050261&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042605&#34; class=&#34;uri&#34;&gt;GO:0042605&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;peptide antigen binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0078319&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0005506&#34; class=&#34;uri&#34;&gt;GO:0005506&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;iron ion binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;13/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176137&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0004364&#34; class=&#34;uri&#34;&gt;GO:0004364&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;glutathione transferase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0236924&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0005125&#34; class=&#34;uri&#34;&gt;GO:0005125&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cytokine activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0236924&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0008234&#34; class=&#34;uri&#34;&gt;GO:0008234&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cysteine-type peptidase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0236924&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042379&#34; class=&#34;uri&#34;&gt;GO:0042379&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chemokine receptor binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0364788&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0015020&#34; class=&#34;uri&#34;&gt;GO:0015020&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;glucuronosyltransferase activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0364788&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0016705&#34; class=&#34;uri&#34;&gt;GO:0016705&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;oxidoreductase activity, acting on paired donors, with incorporation or reduction of molecular oxygen&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;12/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0364788&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0019865&#34; class=&#34;uri&#34;&gt;GO:0019865&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;immunoglobulin binding&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0422110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0008009&#34; class=&#34;uri&#34;&gt;GO:0008009&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;chemokine activity&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/488&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0435900&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Description&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GeneRatio&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qvalue&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0045095&#34; class=&#34;uri&#34;&gt;GO:0045095&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;keratin filament&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;16/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000242&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0005882&#34; class=&#34;uri&#34;&gt;GO:0005882&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;intermediate filament&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0042923&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0042611&#34; class=&#34;uri&#34;&gt;GO:0042611&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MHC protein complex&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0057256&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0071556&#34; class=&#34;uri&#34;&gt;GO:0071556&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;integral component of lumenal side of endoplasmic reticulum membrane&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0074647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0098553&#34; class=&#34;uri&#34;&gt;GO:0098553&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;lumenal side of endoplasmic reticulum membrane&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0074647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0045111&#34; class=&#34;uri&#34;&gt;GO:0045111&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;intermediate filament cytoskeleton&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171090&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0000786&#34; class=&#34;uri&#34;&gt;GO:0000786&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;nucleosome&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0178803&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0044815&#34; class=&#34;uri&#34;&gt;GO:0044815&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA packaging complex&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0258667&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0012507&#34; class=&#34;uri&#34;&gt;GO:0012507&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ER to Golgi transport vesicle membrane&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0434286&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;GO:0072562&#34; class=&#34;uri&#34;&gt;GO:0072562&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;blood microparticle&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;11/589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0438412&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Summary epigenetic mark tracks</title>
          <link>/2016/09/06/summary-epigenetic-mark-tracks/</link>
          <pubDate>Tue, 06 Sep 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/09/06/summary-epigenetic-mark-tracks/</guid>
          <description>


&lt;p&gt;To assess the potential impact of variants (SNV, SVs) we might want to use some of the public epigentic datasets. The amount and heterogeneity of this data is a bit overwhelming. I would like to get a summary of which regions of the genome are the most functionally important.&lt;/p&gt;
&lt;p&gt;The plan is to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;get annotated &lt;strong&gt;peaks&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;for the 6 &lt;strong&gt;typical histone marks&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;in &lt;strong&gt;5-6 tissues&lt;/strong&gt;, merging sub-tissues (e.g. brain subregions)&lt;/li&gt;
&lt;li&gt;keep regions &lt;strong&gt;supported by enough replicates&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Eventually, I could also annotate the regions that are tissue-specific or shared across tissues.&lt;/p&gt;
&lt;p&gt;The R-markdown source code is in the website’s &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/blob/gh-pages/_source/2016-09-06-epigeneticTracks.Rmd&#34;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;annotationhub&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;AnnotationHub&lt;/h2&gt;
&lt;p&gt;I’ll use the &lt;a href=&#34;http://bioconductor.org/packages/release/bioc/html/AnnotationHub.html&#34;&gt;AnnotationHub&lt;/a&gt; package, which links Encode and EpigenomeRoadmap data (and more) directly in R.&lt;/p&gt;
&lt;p&gt;I search for &lt;em&gt;narrowPeak&lt;/em&gt; in &lt;em&gt;hg19&lt;/em&gt; from H3K27ac, H3K27me3, H3K36me3, H3K4me1, H3K4me3 or H3K9me3, in brain, blood, liver, muscle, lung, kidney, skin or heart. I also look for DNase peaks. Let’s see if I can find what I want.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-09-06-epigeneticTracks_files/figure-html/ahgraph-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Most tissues have more than 3 tracks for each histone mark. I’ll just exclude liver and knidney that don’t. DNase is a bit more rare but there is at least one track per tissue. In total, it represents 360 different tracks, that I want to merge into one track per mark/tissue.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;download-and-merge-tracks&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Download and merge tracks&lt;/h2&gt;
&lt;p&gt;For each mark/tissue, I download the available tracks, overlap the peaks into sub-peaks (&lt;em&gt;disjoin&lt;/em&gt;) and keep the pieces supported by more than half the tracks. Finally, these recurrent sub-peaks are stitched (&lt;em&gt;reduce&lt;/em&gt;) if closer than 500 bp.&lt;/p&gt;
&lt;p&gt;Afterwards, the regions for each mark is annotated with the number of tissues with overlapping regions.&lt;/p&gt;
&lt;p&gt;The results were uploaded there: &lt;a href=&#34;https://dl.dropboxusercontent.com/s/8c412u1ug2lwrc2/epiTracks.RData?dl=0&#34;&gt;&lt;a href=&#34;https://dl.dropboxusercontent.com/s/8c412u1ug2lwrc2/epiTracks.RData?dl=0&#34; class=&#34;uri&#34;&gt;https://dl.dropboxusercontent.com/s/8c412u1ug2lwrc2/epiTracks.RData?dl=0&lt;/a&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;overview&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-09-06-epigeneticTracks_files/figure-html/overview-1.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;./post/2016-09-06-epigeneticTracks_files/figure-html/overview-2.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;./post/2016-09-06-epigeneticTracks_files/figure-html/overview-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;limitations&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Limitations&lt;/h2&gt;
&lt;p&gt;I searched all tracks with keywords &lt;em&gt;&lt;span class=&#34;math&#34;&gt;\(tissue*, *\)&lt;/span&gt;mark&lt;/em&gt; (and &lt;em&gt;narrowPeak&lt;/em&gt;, &lt;em&gt;hg19&lt;/em&gt;). I’m &lt;strong&gt;not completely sure that the different tracks come from different replicates.&lt;/strong&gt; I think I avoided the “bioinformatics” replicates by taking only the &lt;em&gt;narrowPeaks&lt;/em&gt;. And when there are different sub-tissues (e.g. for brain), I decided to keep only regions supported by half the tracks, but then I &lt;strong&gt;might miss the specific a sub-tissue regions&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;I also made &lt;strong&gt;some arbitrary choices&lt;/strong&gt;. For example, in for a particular mark/tissue, I stitch together regions that are at 500 bp or less. The main motivation is to reduce the amount of data. Also, I’m interested in large variants (SVs), so this resolution is fine.&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Exploring basic annotations of the Human genome</title>
          <link>/2016/06/04/exploring-basic-annotations-of-the-human-genome/</link>
          <pubDate>Sat, 04 Jun 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/06/04/exploring-basic-annotations-of-the-human-genome/</guid>
          <description>


&lt;div id=&#34;quick-look-at-the-annotations&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Quick look at the annotations&lt;/h1&gt;
&lt;div id=&#34;genes&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Genes&lt;/h2&gt;
&lt;p&gt;In Gencode V19 and focusing on autosomes/X/Y, there are 57783 “genes” of different types:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20,332&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,931&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;lincRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,114&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;antisense&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,276&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;miRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,055&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;misc_RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,034&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,916&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snoRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,457&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_intronic&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;742&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;rRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;processed_transcript&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;515&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_overlapping&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;202&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;187&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;polymorphic_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_D_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;3prime_overlapping_ncrna&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_J_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_J_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_D_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;exons&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Exons&lt;/h2&gt;
&lt;p&gt;In Gencode V19 and focusing on autosomes/X/Y, there are 1196256 “exons” from different types of genes:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,070,764&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39,909&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;lincRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33,455&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;antisense&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26,981&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;processed_transcript&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10,846&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;miRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,055&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;misc_RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,034&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,916&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;polymorphic_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,750&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_intronic&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,619&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snoRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,457&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sense_overlapping&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;834&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;rRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;298&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;284&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;193&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;3prime_overlapping_ncrna&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_V_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_D_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_C_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_J_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_C_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_J_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;IG_J_pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TR_D_gene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I focus on exons from protein-coding genes because it’s what we think about most of the time.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mappability&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mappability&lt;/h2&gt;
&lt;p&gt;The mappability track was produced from the UCSC track. The raw file contains, for each base in the genome, an estimation of how likely a read is correctly mapped to this position. Using a sliding-window approach, I computed the average mappability in regions of size 1 Kbp.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-10-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For later use I also define regions of low-mappability as regions with an average mappability below 0.75, which represents 14% of the genome.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;centromere-telomeres-and-gaps&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Centromere, telomeres and gaps&lt;/h2&gt;
&lt;p&gt;I group different elements in this class:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean.size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;telomere&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;232&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;clone&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;207&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;contig&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98.9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;centromere&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,000.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;heterochromatin&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6,039.8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;short_arm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,432.2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;simple-repeats&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simple repeats&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;sequence&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;T&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35,301&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34,898&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23,317&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19,739&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,727&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,311&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11,429&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9,722&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAAT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6,875&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,345&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In total there are 962714 annotated simple repeats.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;repeatmasker-annotation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;RepeatMasker annotation&lt;/h2&gt;
&lt;p&gt;There are different classes of repeats in RepeatMasker annotation:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;repClass&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,793,723&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,498,690&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;717,656&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;461,751&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Simple_repeat&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;417,913&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Low_complexity&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;371,543&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9,566&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Unknown&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,036&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;snRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4,386&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Other&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,733&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,236&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;tRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,002&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DNA?&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,881&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;rRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,769&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;srpRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,481&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;scRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,340&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;729&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINE?&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;425&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LTR?&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;122&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Unknown?&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LINE?&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I extract DNA satellites. They are grouped in different families:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;repName&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;repFamily&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BSR/Beta&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,984&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(GAATG)n&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,362&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ALR/Alpha&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,301&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(CATTC)n&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,096&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SST1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;612&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SATR1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;544&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSATII&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;399&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MSR1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;316&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SATR2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;262&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;260&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;D20S16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;254&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;REP522&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;telo&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;244&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSATII&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;190&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TAR1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;telo&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;161&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LSAU&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;129&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CER&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSAT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACRO1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;acro&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;61&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSATX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;centr&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSATI&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SUBTEL_sa&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SAR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Satellite&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I also extract transposable elements.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;repFamily&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;repClass&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Alu&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,194,734&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;L1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;951,780&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MIR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;595,094&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;L2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;466,438&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERVL-MaLR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;347,105&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hAT-Charlie&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;254,646&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERV1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;175,937&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERVL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;160,346&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TcMar-Tigger&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;104,026&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CR1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;61,303&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hAT-Tip100&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30,669&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hAT-Blackjack&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19,755&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RTE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17,874&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TcMar-Mariner&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16,348&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hAT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,573&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gypsy&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10,892&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERVK&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10,868&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TcMar-Tc2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8,156&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Gypsy?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,869&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Other&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Other&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,733&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TcMar?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,424&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hAT?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,050&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,744&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,206&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PiggyBac&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,120&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MuDR&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,992&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TcMar&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,950&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERVL?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,854&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;tRNA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,668&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Deu&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,265&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;962&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RTE-BovB&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;655&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ERV&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LTR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;579&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Dong-R4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;556&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PiggyBac?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;241&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;L1?&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LINE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Merlin&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Moreover they are organized in 909 sub-families.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;genes-1&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Genes&lt;/h1&gt;
&lt;div id=&#34;size&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Size&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The largest annotated genes are&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;chr&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;type.f&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CNTNAP2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,304.637&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PTPRD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,298.477&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;X&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DMD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,241.764&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LSAMP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,194.860&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DLG2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,172.911&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CSMD1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,059.619&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MACROD2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,057.827&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;EYS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,987.242&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LRP1B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,900.278&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PCDH15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,825.171&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The smallest protein-coding annotated genes are&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;chr&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;type.f&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC011308.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.058&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC055736.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.065&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PIH1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.092&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC012360.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.095&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC008914.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.101&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MGC4771&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.104&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CATX-2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;X&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GAGE12B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.116&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC083862.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.119&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AL606500.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.123&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;density&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Density&lt;/h2&gt;
&lt;p&gt;Using non-overlapping windows of 1 Mb the gene density looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-21-2.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-21-3.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mappability-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mappability&lt;/h2&gt;
&lt;p&gt;Here I compute how many genes overlap regions of low-mappability (defined previously).Also how many genes are within those regions, defined as genes with at least 50% of their body overlapping low-mappability regions.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-22-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-22-2.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-22-3.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-22-4.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;centromere-telomeres-and-gaps-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Centromere, telomeres and gaps&lt;/h2&gt;
&lt;p&gt;As a control, random regions of similar sizes are used.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;summary-table&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Summary table&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;type.f&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;nb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min.kb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean.kb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;med.kb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max.kb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;inLowMap&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;olLowMap&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;genePerMb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20,332&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;65.35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,304.64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.31&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.96&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.02&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.58&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.73&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;586.57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.49&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;other&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,417&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.01&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.29&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.71&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,536.21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.43&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;lincRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,114&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.69&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,375.32&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.35&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,934&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.03&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.91&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;miRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,055&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.04&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.19&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.98&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;exons-1&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Exons&lt;/h1&gt;
&lt;div id=&#34;size-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Size&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-27-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-27-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The largest annotated exons are&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;chr&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;name&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRAPPC9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.059&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MCC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.198&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GRIN2B&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.408&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MUC16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.692&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ABI2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.546&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CNKSR3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.148&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;XKR4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.773&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SLC8A1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.359&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AHNAK&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.169&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;KCNJ6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.108&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The smallest protein-coding annotated exons are&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;chr&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;name&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ALK&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ACAD11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PPA2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GALNT10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CYFIP2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;HDDC2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SRRM3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AP002884.3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;YAF2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;em&gt;ToDo: Size per type (first exon, second exon, …)&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;density-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Density&lt;/h2&gt;
&lt;p&gt;Using non-overlapping windows of 1 Mb the gene density looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-30-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;There are, on average, 357.8926476 exons per Mb.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mappability-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mappability&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-31-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;35201 exons overlap low-mappability regions.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;centromere-telomeres-and-gaps-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Centromere, telomeres and gaps&lt;/h2&gt;
&lt;p&gt;As a control, random regions of similar sizes are used.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-34-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;gwas&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;GWAS&lt;/h1&gt;
&lt;/div&gt;
&lt;div id=&#34;mappability-3&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Mappability&lt;/h1&gt;
&lt;div id=&#34;density-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Density&lt;/h2&gt;
&lt;p&gt;Using non-overlapping windows of 1 Mb the density of low-mappability regions looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-35-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-35-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Yellow regions are 1 Mb regions fully annotated as low-mappability.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;segmental-duplications&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Segmental duplications&lt;/h1&gt;
&lt;/div&gt;
&lt;div id=&#34;dna-satellites&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;DNA Satellites&lt;/h1&gt;
&lt;/div&gt;
&lt;div id=&#34;centromeres-telomeres-and-gaps&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Centromeres, telomeres and gaps&lt;/h1&gt;
&lt;/div&gt;
&lt;div id=&#34;simple-repeats-1&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Simple repeats&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-36-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-36-2.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-36-3.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-36-4.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Interestingly, there is much less STR of period 3 than expected. Why ?&lt;/li&gt;
&lt;li&gt;There is also this burst at copy-number 25. Methodological artifact ?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Grouping the repeats according to their motif, we can ask how frequent is each motif.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-37-1.png&#34; width=&#34;960&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-37-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;summary-tables&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Summary tables&lt;/h2&gt;
&lt;p&gt;Most numerous STRs:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;sequence&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;period&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.100&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.400&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.1k&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total.kb&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;period.class&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;T&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35,301&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,098.73&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34,898&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,086.68&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23,317&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,005.36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19,739&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;300&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44.27&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;873.94&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,727&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.87&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;629.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,747&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,140.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11,429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,801&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;377&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,152.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9,722&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;472.84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAAT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6,875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38.98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;268.02&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,345&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;211.48&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Most numerous in term of instances larger than 100 bp:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;sequence&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;period&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.100&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.400&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.1k&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total.kb&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;period.class&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11,429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,801&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;377&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,152.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,747&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,140.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAAG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101.49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;321.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,843&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,217&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;107.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;305.22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TCTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,580&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;749&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114.62&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;181.09&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AGAA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;693&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;125.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;163.97&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GAAA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,166&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;627&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;127.67&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;148.86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,241&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;118.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146.53&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTCC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;552&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.04&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;179.44&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAGG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,734&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;541&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;174.13&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Most numerous in term of instances larger than 400 bp:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;sequence&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;period&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.100&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.400&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.1k&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total.kb&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;period.class&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11,429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,801&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;377&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,152.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,747&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,140.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GCCTCTGCCCGGCCGCCACCCCGTCTGGGAAGTGAGGAGC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;153&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;468.81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.32&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&amp;gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TCCCAGACGGGGTGGCGGCCGGGCAGAGACGCTCCTCACT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;459.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50.98&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&amp;gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ATATATA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;91&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;305.88&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;106.45&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&amp;gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13,727&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.87&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;629.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9,722&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;472.84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19,739&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;300&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44.27&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;873.94&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TATATAT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;286&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;209&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;335.49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.95&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&amp;gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23,317&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,005.36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Set of large and numerous STRs (names annotated in the previous graphs):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;sequence&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;period&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.100&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.400&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n.1k&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total.kb&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;period.class&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12,311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,747&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,140.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11,429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,801&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;377&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,152.69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAAG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101.49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;321.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,843&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,217&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;107.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;305.22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTCC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;552&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.04&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;179.44&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAGG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,734&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;541&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;174.13&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TCTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,580&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;749&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114.62&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;181.09&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TATC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,426&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;195&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83.24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;118.70&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CCTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,404&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.31&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;129.60&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AGAA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;693&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;125.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;163.97&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GAAG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,284&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;410&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;123.36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,241&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;118.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146.53&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GAAA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,166&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;627&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;127.67&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;148.86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ATAG&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,133&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;186&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98.82&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AGGA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,130&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110.35&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AGAT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,009&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;187&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87.76&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TCTA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;945&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80.97&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GGAA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;907&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98.79&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.60&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TCCT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;901&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;278&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.82&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ATCT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;836&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;145&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;91.24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;76.28&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CTTC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;817&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;246&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78.81&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;AAGA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;390&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;127.96&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97.38&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTCT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;748&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;340&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;115.62&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.48&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TAGA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;706&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.19&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67.21&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GATA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;137&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105.61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72.03&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;dna-satellites-1&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;DNA satellites&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-42-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;repName&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean.size&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SUBTEL_sa&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87.74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;126.92&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;D20S16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;149.57&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;233.24&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;LSAU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;267.70&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MSR1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;279.90&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(GAATG)n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;319.12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(CATTC)n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;332.20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSATI&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;442.89&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TAR1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;554.02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SST1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;602.01&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSATII&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;712.02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;REP522&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;712.68&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BSR/Beta&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;720.22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ACRO1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;744.80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSATII&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,044.12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SATR2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,253.72&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SATR1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,696.22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSATX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1,834.30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HSAT4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2,390.72&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GSAT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3,575.97&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SAR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4,775.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ALR/Alpha&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5,723.55&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CER&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7,535.17&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-42-2.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;transposable-elements&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Transposable elements&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-genomeAnnotation_files/figure-html/unnamed-chunk-43-1.png&#34; width=&#34;960&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Gencode exploration</title>
          <link>/2016/06/04/gencode-exploration/</link>
          <pubDate>Sat, 04 Jun 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/06/04/gencode-exploration/</guid>
          <description>


&lt;div id=&#34;gencode-v19&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Gencode v19&lt;/h2&gt;
&lt;p&gt;I downloaded Gencode v19 at &lt;a href=&#34;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&#34;&gt;&lt;a href=&#34;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&#34; class=&#34;uri&#34;&gt;ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz&lt;/a&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;genes&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Genes&lt;/h2&gt;
&lt;div id=&#34;number&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Number&lt;/h3&gt;
&lt;p&gt;Focusing on autosomes/X/Y, there are 57,783 “genes” of different types:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/genetypes-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;I merge the rare types into a &lt;em&gt;other&lt;/em&gt; class and some RNAs.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene_type.f&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20332&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;pseudogene&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13931&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;other&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7417&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;lincRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7114&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5934&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;miRNA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3055&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;size&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Size&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/genesize-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The largest annotated genes span more than 2 Mbp:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;seqnames&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.Mbp&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CNTNAP2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.304638&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PTPRD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.298478&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chrX&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DMD&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.241765&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;LSAMP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.194861&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DLG2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.172912&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The smallest protein-coding annotated genes less than 100 bp:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;seqnames&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_type&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.bp&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC011308.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;59&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC055736.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PIH1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC012360.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;AC008914.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein_coding&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;102&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;density&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Density&lt;/h3&gt;
&lt;p&gt;Using non-overlapping windows of 1 Mb the gene density looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/genedens-1.png&#34; width=&#34;768&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/genedens-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Chr 19, 17 and 11 have more protein-coding genes than the rest.&lt;/li&gt;
&lt;li&gt;Chr Y has more pseudogene compared to other classes.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;exons&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Exons&lt;/h2&gt;
&lt;div id=&#34;number-1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Number&lt;/h3&gt;
&lt;p&gt;Focusing on autosomes/X/Y, there are 1,196,256 “exons” from different types of genes:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/exontype-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For the rest of the analysis, I use only exons from protein-coding genes.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;number-per-gene&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Number per gene&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/exongene-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;mean.nb.exon&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;median.nb.exon&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max.nb.exon&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;52.9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1696&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The gene with the most exons is the &lt;a href=&#34;http://www.genecards.org/cgi-bin/carddisp.pl?gene=TTN&#34;&gt;Titin gene&lt;/a&gt;:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;gene_name&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;exon&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1696&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SYNE1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1377&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NEB&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1225&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CACNA1G&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1139&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CACNA1C&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1098&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;size-1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Size&lt;/h3&gt;
&lt;p&gt;The average exon size is 232 bp.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/exonsize-1.png&#34; width=&#34;768&#34; /&gt;&lt;img src=&#34;./post/2016-06-04-GencodeExploration_files/figure-html/exonsize-2.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The first exon seems to be slightly larger than the others. I used genes with at least 10 exons to be sure it’s not due to large single-exon genes.&lt;/p&gt;
&lt;p&gt;The largest annotated exons are more than 20 Kbp long:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;seqnames&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_name&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.kb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRAPPC9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.06&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MCC&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GRIN2B&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.41&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MUC16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.69&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ABI2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.55&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The smallest are just 1 bp !?&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;seqnames&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;gene_name&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;size.bp&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ALK&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ACAD11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PPA2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;chr5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;GALNT10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Preparing some genomic annotations</title>
          <link>/2016/06/03/preparing-some-genomic-annotations/</link>
          <pubDate>Fri, 03 Jun 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/06/03/preparing-some-genomic-annotations/</guid>
          <description>


&lt;div id=&#34;mappability-track&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mappability track&lt;/h2&gt;
&lt;p&gt;I produced a mappability track from the UCSC track. The &lt;a href=&#34;http://hgdownload.soe.ucsc.edu/gbdb/hg19/bbi/wgEncodeCrgMapabilityAlign100mer.bw&#34;&gt;raw file&lt;/a&gt; contains, for each base in the genome, an estimation of the probability that a read is correctly mapped at this position.&lt;/p&gt;
&lt;p&gt;Using a sliding-window approach, I compute the average mappability in regions of size 1 Kbp. This is a more manageable amount of data and still informative, especially when interested in large regions (e.g. SVs).&lt;/p&gt;
&lt;p&gt;I used a custom Perl script to efficiently parse the bedGraph-transformed original file. See the code on &lt;a href=&#34;https://github.com/jmonlong/Hippocamplus/blob/gh-pages/_source/mappabilityBin.pl&#34;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I uploaded the result there: &lt;a href=&#34;https://dl.dropboxusercontent.com/s/i537zjs65dpw34n/map100mer-1kbp.bed.gz?dl=0&#34;&gt;&lt;a href=&#34;https://dl.dropboxusercontent.com/s/i537zjs65dpw34n/map100mer-1kbp.bed.gz?dl=0&#34; class=&#34;uri&#34;&gt;https://dl.dropboxusercontent.com/s/i537zjs65dpw34n/map100mer-1kbp.bed.gz?dl=0&lt;/a&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We can cut the genome into three mappability classes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;unique&lt;/strong&gt; regions with high mappability estimate (&amp;gt;0.95).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;low-map&lt;/strong&gt; regions with a non-null mappability but lower than 0.95.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;no-map&lt;/strong&gt; regions with mappability 0.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-06-03-annotationPreparation_files/figure-html/summary-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;map.class&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Mb&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;prop&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;unique&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2485.972&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.803&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;low-map&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;375.608&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.121&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;no-map&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;233.228&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.075&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Word Cloud in R</title>
          <link>/2016/02/26/word-cloud-in-r/</link>
          <pubDate>Fri, 26 Feb 2016 00:00:00 UTC</pubDate>
          <author>Jean Monlong</author>
          <guid>/2016/02/26/word-cloud-in-r/</guid>
          <description>


&lt;p&gt;The &lt;a href=&#34;https://cran.r-project.org/web/packages/wordcloud/index.html&#34;&gt;&lt;code&gt;wordcloud&lt;/code&gt; package&lt;/a&gt; is available on CRAN.&lt;/p&gt;
&lt;div id=&#34;fake-words&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Fake words&lt;/h2&gt;
&lt;p&gt;I create fake words to see a bit how the command is working.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(wordcloud)
createWords &amp;lt;- function(w.l = 3) paste(sample(letters, 
    w.l, TRUE), collapse = &amp;quot;&amp;quot;)
words = sapply(1:200, function(e) createWords(runif(1, 
    3, 10)))
freq = c(sample(1:30, 190, T), sample(30:150, 10, T))
freq = freq/sum(freq)
wordcloud(words, freq)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Big words in the center
wordcloud(words, freq, random.order = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Max word number
wordcloud(words, freq, max.words = 50)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Rotation: proportion of 90 degree
wordcloud(words, freq, rot.per = 0.01)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Color the most frequent words
wordcloud(words, freq, colors = c(&amp;quot;black&amp;quot;, &amp;quot;blue&amp;quot;, 
    &amp;quot;red&amp;quot;), random.order = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-5.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Color for each word
wordcloud(words, freq, colors = sample(c(&amp;quot;black&amp;quot;, &amp;quot;blue&amp;quot;, 
    &amp;quot;red&amp;quot;), length(words), TRUE), random.order = FALSE, 
    ordered.colors = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/example-6.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;command-history&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Command history&lt;/h2&gt;
&lt;p&gt;I retrieved the commands from my &lt;code&gt;.bash_history&lt;/code&gt; files (laptop and HPCs) and I want to make a word cloud showing the commands I use the most.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(RColorBrewer)
cmds = read.table(&amp;quot;../../data/bash-commands.tsv.gz&amp;quot;, 
    as.is = TRUE)
colnames(cmds) = c(&amp;quot;cmd&amp;quot;, &amp;quot;machine&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;laptop&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Laptop&lt;/h3&gt;
&lt;p&gt;By default the maximum history size was set to 500 commands so I don’t have the full set of commands, just the last 500. (I increased the limit, see you in 10,000 commands.)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cmds.s = cmds %&amp;gt;% filter(machine == &amp;quot;laptop&amp;quot;, !grepl(&amp;quot;=&amp;quot;, 
    cmd), !grepl(&amp;quot;\\.&amp;quot;, cmd), !grepl(&amp;quot;/&amp;quot;, cmd)) %&amp;gt;% 
    group_by(cmd) %&amp;gt;% summarize(n = n()) %&amp;gt;% mutate(freq = n/sum(n))
wordcloud(cmds.s$cmd, cmds.s$freq, colors = c(&amp;quot;black&amp;quot;, 
    brewer.pal(8, &amp;quot;Set1&amp;quot;)), random.order = FALSE, scale = c(10, 
    1), title = &amp;quot;All&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/cmdlt-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;hpc&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;HPC&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cmds.s = cmds %&amp;gt;% filter(machine != &amp;quot;laptop&amp;quot;, !grepl(&amp;quot;=&amp;quot;, 
    cmd), !grepl(&amp;quot;\\.&amp;quot;, cmd), !grepl(&amp;quot;/&amp;quot;, cmd), !grepl(&amp;quot;\\$&amp;quot;, 
    cmd), !grepl(&amp;quot;\\:&amp;quot;, cmd)) %&amp;gt;% group_by(cmd) %&amp;gt;% 
    summarize(n = n()) %&amp;gt;% mutate(freq = n/sum(n))
wordcloud(cmds.s$cmd, cmds.s$freq, colors = c(&amp;quot;black&amp;quot;, 
    brewer.pal(8, &amp;quot;Set1&amp;quot;)), random.order = FALSE, scale = c(10, 
    1), title = &amp;quot;All&amp;quot;, min.freq = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;./post/2016-02-26-wordcloud_files/figure-html/cmdhpc-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Good see the usual suspects &lt;code&gt;ls&lt;/code&gt; and &lt;code&gt;cd&lt;/code&gt; and their “typo” versions &lt;code&gt;;s&lt;/code&gt;/&lt;code&gt;ks&lt;/code&gt;/&lt;code&gt;ld&lt;/code&gt; and &lt;code&gt;xs&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
        </item>
      
    

  </channel>
</rss>
